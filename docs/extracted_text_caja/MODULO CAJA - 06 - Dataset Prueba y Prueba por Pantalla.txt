1) Datasets de prueba (DEV/QA)
D1 Â· Tiendas
STORE-DIP = â€œLONDOR DiputaciÃ³nâ€
STORE-PRO = â€œLONDOR Provenzaâ€
STORE-ALM = â€œAlmacÃ©nâ€ (solo referencia; no caja diaria)
D2 Â· Usuarios / Roles
USR-ADM-01 = Admin (nombre: â€œAdmin Testâ€)
USR-DEP-01 = Dependienta DiputaciÃ³n (nombre: â€œDep Test Dipâ€)
USR-DEP-02 = Dependienta Provenza (nombre: â€œDep Test Proâ€)
D3 Â· Caja diaria (plantilla por fecha)
Usa estas fechas â€œcontroladasâ€:
DAY-TODAY = hoy (fecha del entorno)
DAY-OLD-16 = hoy - 16 dÃ­as (para liberar custodia legal)
DAY-OLD-10 = hoy - 10 dÃ­as (custodia aÃºn activa)
Cajas a crear
CASHBOX-DIP-TODAY (STORE-DIP): saldo inicial 200.00
CASHBOX-PRO-TODAY (STORE-PRO): saldo inicial 150.00
CASHBOX-DIP-OLD16 (STORE-DIP): saldo inicial 100.00 (histÃ³rica)
CASHBOX-DIP-OLD10 (STORE-DIP): saldo inicial 100.00 (histÃ³rica)
D4 Â· Clientes (incluye fiscales)
CUST-001 â€œAna PÃ©rezâ€
DNI: 00000000A (dummy)
Fiscal OK: SÃ­ (NIF + direcciÃ³n)
CUST-002 â€œMarc LÃ³pezâ€
DNI: 00000000B (dummy)
Fiscal OK: No (incompleto â†’ sirve para test de captura)
CUST-003 â€œLaura GÃ³mezâ€
DNI: 00000000C (dummy)
Fiscal OK: SÃ­
D5 Â· Piezas (referencias de inventario)
ITEM-001 (Disponible, STORE-DIP) â€” â€œAnillo oro 18kâ€
ITEM-002 (Disponible, STORE-DIP) â€” â€œColgante plataâ€
ITEM-003 (Disponible, STORE-PRO) â€” â€œPulsera oroâ€
ITEM-004 (En custodia legal, STORE-DIP) â€” â€œAnillo recompraâ€ (se crea con compra legal DAY-OLD-10)
ITEM-005 (En custodia legal, STORE-DIP) â€” â€œCadena recompraâ€ (se crea con compra legal DAY-OLD-16)
D6 Â· Ventas (eventos origen)
SALE-001 (STORE-DIP, CUST-001, piezas: ITEM-001)
Total: 900.00
Estado: â€œPreparada para cobroâ€
SALE-002 (STORE-DIP, CUST-002, piezas: ITEM-002)
Total: 120.00
Estado: â€œPreparada para cobroâ€
SALE-003 (STORE-PRO, CUST-003, piezas: ITEM-003)
Total: 450.00
Estado: â€œPreparada para cobroâ€
D7 Â· Compras a cliente (oro/piezas) con ficha legal
BUY-001 (STORE-DIP, CUST-001, piezas: ITEM-004, fecha = DAY-OLD-10)
Importe pagado: 300.00
Evidencias: DNI-FOTO-SÃ, PIEZA-FOTO-SÃ
Estado legal: En custodia (NO liberable aÃºn)
BUY-002 (STORE-DIP, CUST-003, piezas: ITEM-005, fecha = DAY-OLD-16)
Importe pagado: 200.00
Evidencias: DNI-FOTO-SÃ, PIEZA-FOTO-SÃ
Estado legal: Lista para liberar
(Si necesitas archivos reales de imagen, se pueden simular como adjuntos â€œIMG-DNI-001.jpgâ€, â€œIMG-ITEM-004-1.jpgâ€, etc.)
D8 Â· EmpeÃ±os (contratos)
PAWN-001 (STORE-DIP, CUST-001, pieza: ITEM-002)
InterÃ©s mensual ejemplo: 50.00
Estado: Activo
D9 Â· FacturaciÃ³n (mÃ³dulo FacturaciÃ³n disponible como servicio)
NumeraciÃ³n inicial para pruebas:
INV-START = F-2026-000100
Estado Verifactu simulado:
â€œOKâ€ / â€œPENDIENTEâ€ (segÃºn entorno)

2) Casos de prueba por pantalla (P-CASH)
Formato: TC-PANTALLA-XXX Â· Dataset Â· Precondiciones Â· Pasos Â· Resultado esperado

ğŸŸ¦ P-CASH-01 Â· Caja del dÃ­a (Resumen operativo)
TC-P01-001 Â· Estado â€œNo abiertaâ€
Dataset: STORE-DIP, USR-DEP-01
Pre: No abrir CASHBOX-DIP-TODAY.
Pasos: Entrar a â€œCaja del dÃ­aâ€.
Esperado: Estado = â€œNo abiertaâ€, alerta â€œCaja no abiertaâ€, CTA a apertura (solo si rol lo permite).
TC-P01-002 Â· Totales por medio de pago
Dataset: CASHBOX-DIP-TODAY + movimientos (ver P-CASH-11 y P-CASH-06)
Pre: Caja abierta y registrar:
Cobro SALE-001 tarjeta 900
Compra BUY-001 efectivo -300
Pasos: Abrir â€œCaja del dÃ­aâ€.
Esperado: Totales correctos por medio, entradas/salidas correctas, total teÃ³rico correcto.
TC-P01-003 Â· Visibilidad por rol
Dataset: USR-DEP-01 vs USR-ADM-01
Pre: Caja abierta con descuadre pendiente de justificar (ver P-CASH-03).
Pasos: Abrir â€œCaja del dÃ­aâ€ con ambos roles.
Esperado: Admin ve alertas/acciones ampliadas; Dependienta ve versiÃ³n restringida.

ğŸŸ¦ P-CASH-02 Â· Apertura de caja
TC-P02-001 Â· Apertura OK
Dataset: CASHBOX-DIP-TODAY
Pre: Caja no abierta. USR-ADM-01.
Pasos: Abrir con saldo inicial 200.
Esperado: Caja â€œAbiertaâ€, registro usuario/fecha/tienda/saldo.
TC-P02-002 Â· Doble apertura denegada
Dataset: CASHBOX-DIP-TODAY
Pre: Caja ya abierta.
Pasos: Intentar abrir otra vez.
Esperado: Deniega con mensaje â€œYa existe caja abiertaâ€.
TC-P02-003 Â· Dependienta sin permiso
Dataset: USR-DEP-01
Pre: Config permisos: Dependienta no puede abrir.
Pasos: Intentar abrir caja.
Esperado: Acceso denegado / botÃ³n oculto.

ğŸŸ¦ P-CASH-03 Â· Cierre y arqueo
TC-P03-001 Â· Cierre cuadrado
Dataset: CASHBOX-DIP-TODAY + movimientos del dÃ­a
Pre: Caja abierta, movimientos registrados.
Pasos: Contar efectivo = teÃ³rico, cerrar.
Esperado: Estado â€œCerrada / Cuadradaâ€.
TC-P03-002 Â· Cierre descuadrado requiere motivo
Dataset: CASHBOX-DIP-TODAY
Pre: TeÃ³rico efectivo 500, contado 480.
Pasos: Cerrar sin motivo â†’ luego con motivo.
Esperado: Bloquea sin motivo; permite con motivo y marca â€œDescuadrada (documentada)â€.
TC-P03-003 Â· Cierre bloquea nuevas operaciones
Dataset: CASHBOX-DIP-TODAY
Pre: Caja cerrada.
Pasos: Intentar registrar compra/venta.
Esperado: Bloqueo: â€œCaja cerradaâ€.

ğŸŸ¦ P-CASH-04 Â· Movimientos (Listado + filtros)
TC-P04-001 Â· Filtro por tienda y fecha
Dataset: CASHBOX-DIP-TODAY, CASHBOX-PRO-TODAY
Pre: Crear al menos 1 movimiento por tienda.
Pasos: Filtrar por tienda DIP y fecha TODAY.
Esperado: Solo movimientos DIP hoy.
TC-P04-002 Â· Filtro por tipo de movimiento
Dataset: Movimientos Venta, Compra, Intereses
Pre: Registrar:
Cobro SALE-001 (Venta)
Pago BUY-001 (Compra)
Cobro intereses PAWN-001 (Intereses)
Pasos: Filtrar por â€œCompra a clienteâ€.
Esperado: Solo pagos de compras.
TC-P04-003 Â· Columna Factura (si existe) y estado Verifactu
Dataset: SALE-001 con factura emitida
Pre: Emitir factura en P-CASH-11.
Pasos: Ver listado.
Esperado: Movimiento muestra FacturaId/nÃºmero + badge Verifactu.

ğŸŸ¦ P-CASH-05 Â· Movimiento (Detalle inmutable)
TC-P05-001 Â· Detalle completo y vÃ­nculos
Dataset: Movimiento de SALE-001
Pre: Cobro realizado.
Pasos: Abrir detalle del movimiento desde P-CASH-04.
Esperado: Muestra MovementId, cajaId, usuario, tienda, origen (SaleId), importe, medio pago, timestamp.
TC-P05-002 Â· Inmutabilidad (sin ediciÃ³n)
Dataset: Cualquier movimiento
Pre: Movimiento existente.
Pasos: Intentar editar importe/medio pago.
Esperado: No existe opciÃ³n de editar o se deniega.
TC-P05-003 Â· Acciones Admin: contra-movimiento / rectificativa
Dataset: Movimiento con factura emitida
Pre: USR-ADM-01.
Pasos: â€œIniciar rectificativaâ€ y â€œCrear contra-movimientoâ€.
Esperado: Dispara flujo permitido sin modificar el original.

ğŸŸ¦ P-CASH-06 Â· Compra a cliente (Pago + ficha legal)
TC-P06-001 Â· Bloqueo por falta de fotos
Dataset: CUST-001, ITEM-004, CASHBOX-DIP-TODAY
Pre: Caja abierta.
Pasos: Completar datos base, adjuntar solo DNI, confirmar.
Esperado: Bloquea: faltan fotos piezas.
TC-P06-002 Â· Compra legal OK crea todo
Dataset: BUY-001 (o crear BUY-NEW)
Pre: Caja abierta, cliente y pieza seleccionados, DNI+fotos OK.
Pasos: Confirmar compra.
Esperado: Se crea:
Movimiento caja (Salida)
Ficha legal
Estado legal â€œEn custodiaâ€
Temporizador 15 dÃ­as
TC-P06-003 Â· Bloqueo si caja no abierta
Dataset: STORE-DIP
Pre: Caja cerrada o no abierta.
Pasos: Intentar confirmar compra.
Esperado: Deniega: requiere caja abierta.

ğŸŸ¦ P-CASH-07 Â· Ficha legal de compra (Consulta)
TC-P07-001 Â· VisualizaciÃ³n de evidencias
Dataset: BUY-001
Pre: Ficha legal existente.
Pasos: Abrir ficha.
Esperado: Muestra DNI + fotos piezas + cliente + importe + tienda + usuario + vÃ­nculos.
TC-P07-002 Â· Registrar incidencia
Dataset: BUY-001
Pre: Admin.
Pasos: Marcar incidencia con motivo.
Esperado: Estado legal pasa a â€œIncidencia/Bloqueadaâ€, queda auditado.
TC-P07-003 Â· EnvÃ­o a autoridad (registro)
Dataset: BUY-001
Pre: Admin.
Pasos: Registrar â€œEnviado a autoridadâ€ (fecha).
Esperado: Log de envÃ­o asociado a la ficha legal.

ğŸŸ¦ P-CASH-08 Â· Bandeja â€œCustodia legalâ€ (15 dÃ­as)
TC-P08-001 Â· Lista y dÃ­as restantes correctos
Dataset: BUY-001 (10 dÃ­as), BUY-002 (16 dÃ­as)
Pre: Ambos casos cargados.
Pasos: Abrir bandeja.
Esperado: BUY-001 = â€œEn custodiaâ€ con dÃ­as restantes; BUY-002 = â€œLista para liberarâ€.
TC-P08-002 Â· LiberaciÃ³n legal explÃ­cita permitida (OLD16)
Dataset: BUY-002
Pre: Admin, sin incidencia.
Pasos: Liberar legalmente.
Esperado: Cambia a â€œLiberadaâ€ + evento auditado; pieza deja custodia.
TC-P08-003 Â· LiberaciÃ³n denegada si no han pasado 15 dÃ­as
Dataset: BUY-001
Pre: Admin.
Pasos: Intentar liberar.
Esperado: Deniega: â€œAÃºn en periodo legalâ€.

ğŸŸ¦ P-CASH-09 Â· EmpeÃ±os
TC-P09-001 Â· Cobro intereses genera entrada
Dataset: PAWN-001, CASHBOX-DIP-TODAY
Pre: Caja abierta.
Pasos: Registrar intereses 50â‚¬ tarjeta.
Esperado: Movimiento â€œCobro intereses empeÃ±oâ€ (Entrada) vinculado a PAWN-001.
TC-P09-002 Â· Medio de pago obligatorio
Dataset: PAWN-001
Pre: Caja abierta.
Pasos: Intentar confirmar sin medio pago.
Esperado: Bloquea: medio obligatorio.

ğŸŸ¦ P-CASH-10 Â· Ajustes y contra-movimientos (Admin)
TC-P10-001 Â· Dependienta denegada
Dataset: USR-DEP-01
Pre: Movimiento existente.
Pasos: Intentar acceder/ejecutar contra-movimiento.
Esperado: Denegado por permisos.
TC-P10-002 Â· Admin crea contra-movimiento con motivo obligatorio
Dataset: Movimiento de SALE-002 (por ejemplo)
Pre: Admin.
Pasos: Contra-movimiento sin motivo â†’ luego con motivo.
Esperado: Bloquea sin motivo; crea nuevo movimiento vinculado al original con motivo auditado.

ğŸŸ¦ P-CASH-11 Â· Factura desde venta (Modal/Step checkout)
TC-P11-001 Â· Venta sin factura
Dataset: SALE-002 (CUST-002 fiscal incompleto pero no pide factura)
Pre: Caja abierta.
Pasos: Cobrar con â€œFactura = NOâ€.
Esperado: Movimiento creado, venta cerrada, sin FacturaId.
TC-P11-002 Â· Venta con factura (captura datos fiscales si faltan)
Dataset: SALE-002 + CUST-002 (fiscal incompleto)
Pre: Caja abierta.
Pasos: â€œFactura = SÃâ€ â†’ el sistema solicita completar datos fiscales â†’ emitir.
Esperado: Factura emitida, nÃºmero asignado, vÃ­nculo 1:1 al movimiento, estado Verifactu visible.
TC-P11-003 Â· DuplicaciÃ³n denegada
Dataset: SALE-001 ya facturada
Pre: Factura emitida una vez.
Pasos: Reintentar â€œEmitir facturaâ€ para el mismo movimiento.
Esperado: Deniega: â€œYa existe factura asociadaâ€.
TC-P11-004 Â· Inmutabilidad: correcciÃ³n por rectificativa
Dataset: Factura de SALE-001
Pre: Admin.
Pasos: Intentar editar factura â†’ luego iniciar rectificativa.
Esperado: No permite ediciÃ³n; permite flujo rectificativa (nuevo documento), sin alterar factura original.
