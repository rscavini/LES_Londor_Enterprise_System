(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function fb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P0={exports:{}},Id={},O0={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yl=Symbol.for("react.element"),pb=Symbol.for("react.portal"),mb=Symbol.for("react.fragment"),gb=Symbol.for("react.strict_mode"),yb=Symbol.for("react.profiler"),vb=Symbol.for("react.provider"),xb=Symbol.for("react.context"),_b=Symbol.for("react.forward_ref"),wb=Symbol.for("react.suspense"),Eb=Symbol.for("react.memo"),Ib=Symbol.for("react.lazy"),ry=Symbol.iterator;function bb(t){return t===null||typeof t!="object"?null:(t=ry&&t[ry]||t["@@iterator"],typeof t=="function"?t:null)}var L0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M0=Object.assign,V0={};function Jo(t,e,n){this.props=t,this.context=e,this.refs=V0,this.updater=n||L0}Jo.prototype.isReactComponent={};Jo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function z0(){}z0.prototype=Jo.prototype;function Mp(t,e,n){this.props=t,this.context=e,this.refs=V0,this.updater=n||L0}var Vp=Mp.prototype=new z0;Vp.constructor=Mp;M0(Vp,Jo.prototype);Vp.isPureReactComponent=!0;var iy=Array.isArray,B0=Object.prototype.hasOwnProperty,zp={current:null},F0={key:!0,ref:!0,__self:!0,__source:!0};function U0(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)B0.call(e,r)&&!F0.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:Yl,type:t,key:s,ref:o,props:i,_owner:zp.current}}function Sb(t,e){return{$$typeof:Yl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Bp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Yl}function Cb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var sy=/\/+/g;function xh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cb(""+t.key):e.toString(36)}function tu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Yl:case pb:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+xh(o,0):r,iy(i)?(n="",t!=null&&(n=t.replace(sy,"$&/")+"/"),tu(i,e,n,"",function(d){return d})):i!=null&&(Bp(i)&&(i=Sb(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(sy,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",iy(t))for(var c=0;c<t.length;c++){s=t[c];var u=r+xh(s,c);o+=tu(s,e,n,u,i)}else if(u=bb(t),typeof u=="function")for(t=u.call(t),c=0;!(s=t.next()).done;)s=s.value,u=r+xh(s,c++),o+=tu(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rc(t,e,n){if(t==null)return t;var r=[],i=0;return tu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Ab(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var In={current:null},nu={transition:null},Tb={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:nu,ReactCurrentOwner:zp};function $0(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:Rc,forEach:function(t,e,n){Rc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rc(t,function(){e++}),e},toArray:function(t){return Rc(t,function(e){return e})||[]},only:function(t){if(!Bp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Se.Component=Jo;Se.Fragment=mb;Se.Profiler=yb;Se.PureComponent=Mp;Se.StrictMode=gb;Se.Suspense=wb;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tb;Se.act=$0;Se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=M0({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=zp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)B0.call(e,u)&&!F0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Yl,type:t.type,key:i,ref:s,props:r,_owner:o}};Se.createContext=function(t){return t={$$typeof:xb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vb,_context:t},t.Consumer=t};Se.createElement=U0;Se.createFactory=function(t){var e=U0.bind(null,t);return e.type=t,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(t){return{$$typeof:_b,render:t}};Se.isValidElement=Bp;Se.lazy=function(t){return{$$typeof:Ib,_payload:{_status:-1,_result:t},_init:Ab}};Se.memo=function(t,e){return{$$typeof:Eb,type:t,compare:e===void 0?null:e}};Se.startTransition=function(t){var e=nu.transition;nu.transition={};try{t()}finally{nu.transition=e}};Se.unstable_act=$0;Se.useCallback=function(t,e){return In.current.useCallback(t,e)};Se.useContext=function(t){return In.current.useContext(t)};Se.useDebugValue=function(){};Se.useDeferredValue=function(t){return In.current.useDeferredValue(t)};Se.useEffect=function(t,e){return In.current.useEffect(t,e)};Se.useId=function(){return In.current.useId()};Se.useImperativeHandle=function(t,e,n){return In.current.useImperativeHandle(t,e,n)};Se.useInsertionEffect=function(t,e){return In.current.useInsertionEffect(t,e)};Se.useLayoutEffect=function(t,e){return In.current.useLayoutEffect(t,e)};Se.useMemo=function(t,e){return In.current.useMemo(t,e)};Se.useReducer=function(t,e,n){return In.current.useReducer(t,e,n)};Se.useRef=function(t){return In.current.useRef(t)};Se.useState=function(t){return In.current.useState(t)};Se.useSyncExternalStore=function(t,e,n){return In.current.useSyncExternalStore(t,e,n)};Se.useTransition=function(){return In.current.useTransition()};Se.version="18.3.1";O0.exports=Se;var R=O0.exports;const Kt=fb(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rb=R,kb=Symbol.for("react.element"),jb=Symbol.for("react.fragment"),Db=Object.prototype.hasOwnProperty,Nb=Rb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pb={key:!0,ref:!0,__self:!0,__source:!0};function W0(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Db.call(e,r)&&!Pb.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:kb,type:t,key:s,ref:o,props:i,_owner:Nb.current}}Id.Fragment=jb;Id.jsx=W0;Id.jsxs=W0;P0.exports=Id;var a=P0.exports,uf={},q0={exports:{}},Wn={},H0={exports:{}},G0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,O){var Q=K.length;K.push(O);e:for(;0<Q;){var xe=Q-1>>>1,ue=K[xe];if(0<i(ue,O))K[xe]=O,K[Q]=ue,Q=xe;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var O=K[0],Q=K.pop();if(Q!==O){K[0]=Q;e:for(var xe=0,ue=K.length,Ze=ue>>>1;xe<Ze;){var $e=2*(xe+1)-1,kt=K[$e],ze=$e+1,it=K[ze];if(0>i(kt,Q))ze<ue&&0>i(it,kt)?(K[xe]=it,K[ze]=Q,xe=ze):(K[xe]=kt,K[$e]=Q,xe=$e);else if(ze<ue&&0>i(it,Q))K[xe]=it,K[ze]=Q,xe=ze;else break e}}return O}function i(K,O){var Q=K.sortIndex-O.sortIndex;return Q!==0?Q:K.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,p=null,g=3,x=!1,C=!1,j=!1,P=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(K){for(var O=n(d);O!==null;){if(O.callback===null)r(d);else if(O.startTime<=K)r(d),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(d)}}function N(K){if(j=!1,I(K),!C)if(n(u)!==null)C=!0,He(M);else{var O=n(d);O!==null&&Ne(N,O.startTime-K)}}function M(K,O){C=!1,j&&(j=!1,b(v),v=-1),x=!0;var Q=g;try{for(I(O),p=n(u);p!==null&&(!(p.expirationTime>O)||K&&!k());){var xe=p.callback;if(typeof xe=="function"){p.callback=null,g=p.priorityLevel;var ue=xe(p.expirationTime<=O);O=t.unstable_now(),typeof ue=="function"?p.callback=ue:p===n(u)&&r(u),I(O)}else r(u);p=n(u)}if(p!==null)var Ze=!0;else{var $e=n(d);$e!==null&&Ne(N,$e.startTime-O),Ze=!1}return Ze}finally{p=null,g=Q,x=!1}}var B=!1,_=null,v=-1,S=5,A=-1;function k(){return!(t.unstable_now()-A<S)}function D(){if(_!==null){var K=t.unstable_now();A=K;var O=!0;try{O=_(!0,K)}finally{O?T():(B=!1,_=null)}}else B=!1}var T;if(typeof y=="function")T=function(){y(D)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Qe=fe.port2;fe.port1.onmessage=D,T=function(){Qe.postMessage(null)}}else T=function(){P(D,0)};function He(K){_=K,B||(B=!0,T())}function Ne(K,O){v=P(function(){K(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){C||x||(C=!0,He(M))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(K){switch(g){case 1:case 2:case 3:var O=3;break;default:O=g}var Q=g;g=O;try{return K()}finally{g=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,O){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Q=g;g=K;try{return O()}finally{g=Q}},t.unstable_scheduleCallback=function(K,O,Q){var xe=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?xe+Q:xe):Q=xe,K){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=Q+ue,K={id:f++,callback:O,priorityLevel:K,startTime:Q,expirationTime:ue,sortIndex:-1},Q>xe?(K.sortIndex=Q,e(d,K),n(u)===null&&K===n(d)&&(j?(b(v),v=-1):j=!0,Ne(N,Q-xe))):(K.sortIndex=ue,e(u,K),C||x||(C=!0,He(M))),K},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(K){var O=g;return function(){var Q=g;g=O;try{return K.apply(this,arguments)}finally{g=Q}}}})(G0);H0.exports=G0;var Ob=H0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb=R,$n=Ob;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K0=new Set,ml={};function Fs(t,e){Lo(t,e),Lo(t+"Capture",e)}function Lo(t,e){for(ml[t]=e,t=0;t<e.length;t++)K0.add(e[t])}var Gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),df=Object.prototype.hasOwnProperty,Mb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,oy={},ay={};function Vb(t){return df.call(ay,t)?!0:df.call(oy,t)?!1:Mb.test(t)?ay[t]=!0:(oy[t]=!0,!1)}function zb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bb(t,e,n,r){if(e===null||typeof e>"u"||zb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jt[t]=new bn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Jt[e]=new bn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jt[t]=new bn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jt[t]=new bn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jt[t]=new bn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jt[t]=new bn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jt[t]=new bn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jt[t]=new bn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jt[t]=new bn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fp=/[\-:]([a-z])/g;function Up(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Fp,Up);Jt[e]=new bn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Fp,Up);Jt[e]=new bn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Fp,Up);Jt[e]=new bn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jt[t]=new bn(t,1,!1,t.toLowerCase(),null,!1,!1)});Jt.xlinkHref=new bn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jt[t]=new bn(t,1,!1,t.toLowerCase(),null,!0,!0)});function $p(t,e,n,r){var i=Jt.hasOwnProperty(e)?Jt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bb(e,n,i,r)&&(n=null),r||i===null?Vb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ni=Lb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kc=Symbol.for("react.element"),so=Symbol.for("react.portal"),oo=Symbol.for("react.fragment"),Wp=Symbol.for("react.strict_mode"),hf=Symbol.for("react.profiler"),Q0=Symbol.for("react.provider"),Y0=Symbol.for("react.context"),qp=Symbol.for("react.forward_ref"),ff=Symbol.for("react.suspense"),pf=Symbol.for("react.suspense_list"),Hp=Symbol.for("react.memo"),yi=Symbol.for("react.lazy"),J0=Symbol.for("react.offscreen"),ly=Symbol.iterator;function Ia(t){return t===null||typeof t!="object"?null:(t=ly&&t[ly]||t["@@iterator"],typeof t=="function"?t:null)}var ut=Object.assign,_h;function Va(t){if(_h===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_h=e&&e[1]||""}return`
`+_h+t}var wh=!1;function Eh(t,e){if(!t||wh)return"";wh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,c=s.length-1;1<=o&&0<=c&&i[o]!==s[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==s[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==s[c]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{wh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Va(t):""}function Fb(t){switch(t.tag){case 5:return Va(t.type);case 16:return Va("Lazy");case 13:return Va("Suspense");case 19:return Va("SuspenseList");case 0:case 2:case 15:return t=Eh(t.type,!1),t;case 11:return t=Eh(t.type.render,!1),t;case 1:return t=Eh(t.type,!0),t;default:return""}}function mf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case oo:return"Fragment";case so:return"Portal";case hf:return"Profiler";case Wp:return"StrictMode";case ff:return"Suspense";case pf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Y0:return(t.displayName||"Context")+".Consumer";case Q0:return(t._context.displayName||"Context")+".Provider";case qp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hp:return e=t.displayName||null,e!==null?e:mf(t.type)||"Memo";case yi:e=t._payload,t=t._init;try{return mf(t(e))}catch{}}return null}function Ub(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mf(e);case 8:return e===Wp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function X0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $b(t){var e=X0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jc(t){t._valueTracker||(t._valueTracker=$b(t))}function Z0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=X0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gf(t,e){var n=e.checked;return ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function cy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Gi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function e_(t,e){e=e.checked,e!=null&&$p(t,"checked",e,!1)}function yf(t,e){e_(t,e);var n=Gi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vf(t,e.type,n):e.hasOwnProperty("defaultValue")&&vf(t,e.type,Gi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function uy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vf(t,e,n){(e!=="number"||Cu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var za=Array.isArray;function wo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Gi(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(za(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Gi(n)}}function t_(t,e){var n=Gi(e.value),r=Gi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function hy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function n_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _f(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?n_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Dc,r_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Dc=Dc||document.createElement("div"),Dc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Dc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wb=["Webkit","ms","Moz","O"];Object.keys(Qa).forEach(function(t){Wb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qa[e]=Qa[t]})});function i_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qa.hasOwnProperty(t)&&Qa[t]?(""+e).trim():e+"px"}function s_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=i_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var qb=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wf(t,e){if(e){if(qb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Ef(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var If=null;function Gp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var bf=null,Eo=null,Io=null;function fy(t){if(t=Zl(t)){if(typeof bf!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Td(e),bf(t.stateNode,t.type,e))}}function o_(t){Eo?Io?Io.push(t):Io=[t]:Eo=t}function a_(){if(Eo){var t=Eo,e=Io;if(Io=Eo=null,fy(t),e)for(t=0;t<e.length;t++)fy(e[t])}}function l_(t,e){return t(e)}function c_(){}var Ih=!1;function u_(t,e,n){if(Ih)return t(e,n);Ih=!0;try{return l_(t,e,n)}finally{Ih=!1,(Eo!==null||Io!==null)&&(c_(),a_())}}function yl(t,e){var n=t.stateNode;if(n===null)return null;var r=Td(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var Sf=!1;if(Gr)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){Sf=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{Sf=!1}function Hb(t,e,n,r,i,s,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var Ya=!1,Au=null,Tu=!1,Cf=null,Gb={onError:function(t){Ya=!0,Au=t}};function Kb(t,e,n,r,i,s,o,c,u){Ya=!1,Au=null,Hb.apply(Gb,arguments)}function Qb(t,e,n,r,i,s,o,c,u){if(Kb.apply(this,arguments),Ya){if(Ya){var d=Au;Ya=!1,Au=null}else throw Error(G(198));Tu||(Tu=!0,Cf=d)}}function Us(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function d_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function py(t){if(Us(t)!==t)throw Error(G(188))}function Yb(t){var e=t.alternate;if(!e){if(e=Us(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return py(i),t;if(s===r)return py(i),e;s=s.sibling}throw Error(G(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function h_(t){return t=Yb(t),t!==null?f_(t):null}function f_(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=f_(t);if(e!==null)return e;t=t.sibling}return null}var p_=$n.unstable_scheduleCallback,my=$n.unstable_cancelCallback,Jb=$n.unstable_shouldYield,Xb=$n.unstable_requestPaint,xt=$n.unstable_now,Zb=$n.unstable_getCurrentPriorityLevel,Kp=$n.unstable_ImmediatePriority,m_=$n.unstable_UserBlockingPriority,Ru=$n.unstable_NormalPriority,eS=$n.unstable_LowPriority,g_=$n.unstable_IdlePriority,bd=null,Tr=null;function tS(t){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(bd,t,void 0,(t.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:iS,nS=Math.log,rS=Math.LN2;function iS(t){return t>>>=0,t===0?32:31-(nS(t)/rS|0)|0}var Nc=64,Pc=4194304;function Ba(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ku(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~i;c!==0?r=Ba(c):(s&=o,s!==0&&(r=Ba(s)))}else o=n&~i,o!==0?r=Ba(o):s!==0&&(r=Ba(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pr(e),i=1<<n,r|=t[n],e&=~i;return r}function sS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oS(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-pr(s),c=1<<o,u=i[o];u===-1?(!(c&n)||c&r)&&(i[o]=sS(c,e)):u<=e&&(t.expiredLanes|=c),s&=~c}}function Af(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function y_(){var t=Nc;return Nc<<=1,!(Nc&4194240)&&(Nc=64),t}function bh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pr(e),t[e]=n}function aS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-pr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Qp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var qe=0;function v_(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var x_,Yp,__,w_,E_,Tf=!1,Oc=[],Di=null,Ni=null,Pi=null,vl=new Map,xl=new Map,wi=[],lS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gy(t,e){switch(t){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":vl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(e.pointerId)}}function Sa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Zl(e),e!==null&&Yp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function cS(t,e,n,r,i){switch(e){case"focusin":return Di=Sa(Di,t,e,n,r,i),!0;case"dragenter":return Ni=Sa(Ni,t,e,n,r,i),!0;case"mouseover":return Pi=Sa(Pi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return vl.set(s,Sa(vl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,xl.set(s,Sa(xl.get(s)||null,t,e,n,r,i)),!0}return!1}function I_(t){var e=ws(t.target);if(e!==null){var n=Us(e);if(n!==null){if(e=n.tag,e===13){if(e=d_(n),e!==null){t.blockedOn=e,E_(t.priority,function(){__(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ru(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);If=r,n.target.dispatchEvent(r),If=null}else return e=Zl(n),e!==null&&Yp(e),t.blockedOn=n,!1;e.shift()}return!0}function yy(t,e,n){ru(t)&&n.delete(e)}function uS(){Tf=!1,Di!==null&&ru(Di)&&(Di=null),Ni!==null&&ru(Ni)&&(Ni=null),Pi!==null&&ru(Pi)&&(Pi=null),vl.forEach(yy),xl.forEach(yy)}function Ca(t,e){t.blockedOn===e&&(t.blockedOn=null,Tf||(Tf=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,uS)))}function _l(t){function e(i){return Ca(i,t)}if(0<Oc.length){Ca(Oc[0],t);for(var n=1;n<Oc.length;n++){var r=Oc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Di!==null&&Ca(Di,t),Ni!==null&&Ca(Ni,t),Pi!==null&&Ca(Pi,t),vl.forEach(e),xl.forEach(e),n=0;n<wi.length;n++)r=wi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wi.length&&(n=wi[0],n.blockedOn===null);)I_(n),n.blockedOn===null&&wi.shift()}var bo=ni.ReactCurrentBatchConfig,ju=!0;function dS(t,e,n,r){var i=qe,s=bo.transition;bo.transition=null;try{qe=1,Jp(t,e,n,r)}finally{qe=i,bo.transition=s}}function hS(t,e,n,r){var i=qe,s=bo.transition;bo.transition=null;try{qe=4,Jp(t,e,n,r)}finally{qe=i,bo.transition=s}}function Jp(t,e,n,r){if(ju){var i=Rf(t,e,n,r);if(i===null)Ph(t,e,r,Du,n),gy(t,r);else if(cS(i,t,e,n,r))r.stopPropagation();else if(gy(t,r),e&4&&-1<lS.indexOf(t)){for(;i!==null;){var s=Zl(i);if(s!==null&&x_(s),s=Rf(t,e,n,r),s===null&&Ph(t,e,r,Du,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ph(t,e,r,null,n)}}var Du=null;function Rf(t,e,n,r){if(Du=null,t=Gp(r),t=ws(t),t!==null)if(e=Us(t),e===null)t=null;else if(n=e.tag,n===13){if(t=d_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Du=t,null}function b_(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zb()){case Kp:return 1;case m_:return 4;case Ru:case eS:return 16;case g_:return 536870912;default:return 16}default:return 16}}var Ti=null,Xp=null,iu=null;function S_(){if(iu)return iu;var t,e=Xp,n=e.length,r,i="value"in Ti?Ti.value:Ti.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return iu=i.slice(t,1<r?1-r:void 0)}function su(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Lc(){return!0}function vy(){return!1}function qn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Lc:vy,this.isPropagationStopped=vy,this}return ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lc)},persist:function(){},isPersistent:Lc}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zp=qn(Xo),Xl=ut({},Xo,{view:0,detail:0}),fS=qn(Xl),Sh,Ch,Aa,Sd=ut({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:em,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Aa&&(Aa&&t.type==="mousemove"?(Sh=t.screenX-Aa.screenX,Ch=t.screenY-Aa.screenY):Ch=Sh=0,Aa=t),Sh)},movementY:function(t){return"movementY"in t?t.movementY:Ch}}),xy=qn(Sd),pS=ut({},Sd,{dataTransfer:0}),mS=qn(pS),gS=ut({},Xl,{relatedTarget:0}),Ah=qn(gS),yS=ut({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),vS=qn(yS),xS=ut({},Xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_S=qn(xS),wS=ut({},Xo,{data:0}),_y=qn(wS),ES={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},IS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bS[t])?!!e[t]:!1}function em(){return SS}var CS=ut({},Xl,{key:function(t){if(t.key){var e=ES[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=su(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?IS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:em,charCode:function(t){return t.type==="keypress"?su(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?su(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),AS=qn(CS),TS=ut({},Sd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wy=qn(TS),RS=ut({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:em}),kS=qn(RS),jS=ut({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),DS=qn(jS),NS=ut({},Sd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),PS=qn(NS),OS=[9,13,27,32],tm=Gr&&"CompositionEvent"in window,Ja=null;Gr&&"documentMode"in document&&(Ja=document.documentMode);var LS=Gr&&"TextEvent"in window&&!Ja,C_=Gr&&(!tm||Ja&&8<Ja&&11>=Ja),Ey=" ",Iy=!1;function A_(t,e){switch(t){case"keyup":return OS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ao=!1;function MS(t,e){switch(t){case"compositionend":return T_(e);case"keypress":return e.which!==32?null:(Iy=!0,Ey);case"textInput":return t=e.data,t===Ey&&Iy?null:t;default:return null}}function VS(t,e){if(ao)return t==="compositionend"||!tm&&A_(t,e)?(t=S_(),iu=Xp=Ti=null,ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return C_&&e.locale!=="ko"?null:e.data;default:return null}}var zS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function by(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zS[t.type]:e==="textarea"}function R_(t,e,n,r){o_(r),e=Nu(e,"onChange"),0<e.length&&(n=new Zp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xa=null,wl=null;function BS(t){B_(t,0)}function Cd(t){var e=uo(t);if(Z0(e))return t}function FS(t,e){if(t==="change")return e}var k_=!1;if(Gr){var Th;if(Gr){var Rh="oninput"in document;if(!Rh){var Sy=document.createElement("div");Sy.setAttribute("oninput","return;"),Rh=typeof Sy.oninput=="function"}Th=Rh}else Th=!1;k_=Th&&(!document.documentMode||9<document.documentMode)}function Cy(){Xa&&(Xa.detachEvent("onpropertychange",j_),wl=Xa=null)}function j_(t){if(t.propertyName==="value"&&Cd(wl)){var e=[];R_(e,wl,t,Gp(t)),u_(BS,e)}}function US(t,e,n){t==="focusin"?(Cy(),Xa=e,wl=n,Xa.attachEvent("onpropertychange",j_)):t==="focusout"&&Cy()}function $S(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Cd(wl)}function WS(t,e){if(t==="click")return Cd(e)}function qS(t,e){if(t==="input"||t==="change")return Cd(e)}function HS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yr=typeof Object.is=="function"?Object.is:HS;function El(t,e){if(yr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!df.call(e,i)||!yr(t[i],e[i]))return!1}return!0}function Ay(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ty(t,e){var n=Ay(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ay(n)}}function D_(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D_(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function N_(){for(var t=window,e=Cu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cu(t.document)}return e}function nm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function GS(t){var e=N_(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&D_(n.ownerDocument.documentElement,n)){if(r!==null&&nm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ty(n,s);var o=Ty(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var KS=Gr&&"documentMode"in document&&11>=document.documentMode,lo=null,kf=null,Za=null,jf=!1;function Ry(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jf||lo==null||lo!==Cu(r)||(r=lo,"selectionStart"in r&&nm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Za&&El(Za,r)||(Za=r,r=Nu(kf,"onSelect"),0<r.length&&(e=new Zp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=lo)))}function Mc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var co={animationend:Mc("Animation","AnimationEnd"),animationiteration:Mc("Animation","AnimationIteration"),animationstart:Mc("Animation","AnimationStart"),transitionend:Mc("Transition","TransitionEnd")},kh={},P_={};Gr&&(P_=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function Ad(t){if(kh[t])return kh[t];if(!co[t])return t;var e=co[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in P_)return kh[t]=e[n];return t}var O_=Ad("animationend"),L_=Ad("animationiteration"),M_=Ad("animationstart"),V_=Ad("transitionend"),z_=new Map,ky="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ns(t,e){z_.set(t,e),Fs(e,[t])}for(var jh=0;jh<ky.length;jh++){var Dh=ky[jh],QS=Dh.toLowerCase(),YS=Dh[0].toUpperCase()+Dh.slice(1);ns(QS,"on"+YS)}ns(O_,"onAnimationEnd");ns(L_,"onAnimationIteration");ns(M_,"onAnimationStart");ns("dblclick","onDoubleClick");ns("focusin","onFocus");ns("focusout","onBlur");ns(V_,"onTransitionEnd");Lo("onMouseEnter",["mouseout","mouseover"]);Lo("onMouseLeave",["mouseout","mouseover"]);Lo("onPointerEnter",["pointerout","pointerover"]);Lo("onPointerLeave",["pointerout","pointerover"]);Fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fa));function jy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Qb(r,e,void 0,t),t.currentTarget=null}function B_(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==s&&i.isPropagationStopped())break e;jy(i,c,d),s=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==s&&i.isPropagationStopped())break e;jy(i,c,d),s=u}}}if(Tu)throw t=Cf,Tu=!1,Cf=null,t}function tt(t,e){var n=e[Lf];n===void 0&&(n=e[Lf]=new Set);var r=t+"__bubble";n.has(r)||(F_(e,t,2,!1),n.add(r))}function Nh(t,e,n){var r=0;e&&(r|=4),F_(n,t,r,e)}var Vc="_reactListening"+Math.random().toString(36).slice(2);function Il(t){if(!t[Vc]){t[Vc]=!0,K0.forEach(function(n){n!=="selectionchange"&&(JS.has(n)||Nh(n,!1,t),Nh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vc]||(e[Vc]=!0,Nh("selectionchange",!1,e))}}function F_(t,e,n,r){switch(b_(e)){case 1:var i=dS;break;case 4:i=hS;break;default:i=Jp}n=i.bind(null,e,n,t),i=void 0,!Sf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ph(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;c!==null;){if(o=ws(c),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}c=c.parentNode}}r=r.return}u_(function(){var d=s,f=Gp(n),p=[];e:{var g=z_.get(t);if(g!==void 0){var x=Zp,C=t;switch(t){case"keypress":if(su(n)===0)break e;case"keydown":case"keyup":x=AS;break;case"focusin":C="focus",x=Ah;break;case"focusout":C="blur",x=Ah;break;case"beforeblur":case"afterblur":x=Ah;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=xy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=mS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=kS;break;case O_:case L_:case M_:x=vS;break;case V_:x=DS;break;case"scroll":x=fS;break;case"wheel":x=PS;break;case"copy":case"cut":case"paste":x=_S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=wy}var j=(e&4)!==0,P=!j&&t==="scroll",b=j?g!==null?g+"Capture":null:g;j=[];for(var y=d,I;y!==null;){I=y;var N=I.stateNode;if(I.tag===5&&N!==null&&(I=N,b!==null&&(N=yl(y,b),N!=null&&j.push(bl(y,N,I)))),P)break;y=y.return}0<j.length&&(g=new x(g,C,null,n,f),p.push({event:g,listeners:j}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==If&&(C=n.relatedTarget||n.fromElement)&&(ws(C)||C[Kr]))break e;if((x||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,x?(C=n.relatedTarget||n.toElement,x=d,C=C?ws(C):null,C!==null&&(P=Us(C),C!==P||C.tag!==5&&C.tag!==6)&&(C=null)):(x=null,C=d),x!==C)){if(j=xy,N="onMouseLeave",b="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(j=wy,N="onPointerLeave",b="onPointerEnter",y="pointer"),P=x==null?g:uo(x),I=C==null?g:uo(C),g=new j(N,y+"leave",x,n,f),g.target=P,g.relatedTarget=I,N=null,ws(f)===d&&(j=new j(b,y+"enter",C,n,f),j.target=I,j.relatedTarget=P,N=j),P=N,x&&C)t:{for(j=x,b=C,y=0,I=j;I;I=Js(I))y++;for(I=0,N=b;N;N=Js(N))I++;for(;0<y-I;)j=Js(j),y--;for(;0<I-y;)b=Js(b),I--;for(;y--;){if(j===b||b!==null&&j===b.alternate)break t;j=Js(j),b=Js(b)}j=null}else j=null;x!==null&&Dy(p,g,x,j,!1),C!==null&&P!==null&&Dy(p,P,C,j,!0)}}e:{if(g=d?uo(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var M=FS;else if(by(g))if(k_)M=qS;else{M=$S;var B=US}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(M=WS);if(M&&(M=M(t,d))){R_(p,M,n,f);break e}B&&B(t,g,d),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&vf(g,"number",g.value)}switch(B=d?uo(d):window,t){case"focusin":(by(B)||B.contentEditable==="true")&&(lo=B,kf=d,Za=null);break;case"focusout":Za=kf=lo=null;break;case"mousedown":jf=!0;break;case"contextmenu":case"mouseup":case"dragend":jf=!1,Ry(p,n,f);break;case"selectionchange":if(KS)break;case"keydown":case"keyup":Ry(p,n,f)}var _;if(tm)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else ao?A_(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(C_&&n.locale!=="ko"&&(ao||v!=="onCompositionStart"?v==="onCompositionEnd"&&ao&&(_=S_()):(Ti=f,Xp="value"in Ti?Ti.value:Ti.textContent,ao=!0)),B=Nu(d,v),0<B.length&&(v=new _y(v,t,null,n,f),p.push({event:v,listeners:B}),_?v.data=_:(_=T_(n),_!==null&&(v.data=_)))),(_=LS?MS(t,n):VS(t,n))&&(d=Nu(d,"onBeforeInput"),0<d.length&&(f=new _y("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=_))}B_(p,e)})}function bl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Nu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=yl(t,n),s!=null&&r.unshift(bl(t,s,i)),s=yl(t,e),s!=null&&r.push(bl(t,s,i))),t=t.return}return r}function Js(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Dy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,i?(u=yl(n,s),u!=null&&o.unshift(bl(n,u,c))):i||(u=yl(n,s),u!=null&&o.push(bl(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var XS=/\r\n?/g,ZS=/\u0000|\uFFFD/g;function Ny(t){return(typeof t=="string"?t:""+t).replace(XS,`
`).replace(ZS,"")}function zc(t,e,n){if(e=Ny(e),Ny(t)!==e&&n)throw Error(G(425))}function Pu(){}var Df=null,Nf=null;function Pf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Of=typeof setTimeout=="function"?setTimeout:void 0,eC=typeof clearTimeout=="function"?clearTimeout:void 0,Py=typeof Promise=="function"?Promise:void 0,tC=typeof queueMicrotask=="function"?queueMicrotask:typeof Py<"u"?function(t){return Py.resolve(null).then(t).catch(nC)}:Of;function nC(t){setTimeout(function(){throw t})}function Oh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),_l(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);_l(e)}function Oi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Oy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zo=Math.random().toString(36).slice(2),Ar="__reactFiber$"+Zo,Sl="__reactProps$"+Zo,Kr="__reactContainer$"+Zo,Lf="__reactEvents$"+Zo,rC="__reactListeners$"+Zo,iC="__reactHandles$"+Zo;function ws(t){var e=t[Ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kr]||n[Ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Oy(t);t!==null;){if(n=t[Ar])return n;t=Oy(t)}return e}t=n,n=t.parentNode}return null}function Zl(t){return t=t[Ar]||t[Kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function uo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Td(t){return t[Sl]||null}var Mf=[],ho=-1;function rs(t){return{current:t}}function rt(t){0>ho||(t.current=Mf[ho],Mf[ho]=null,ho--)}function Xe(t,e){ho++,Mf[ho]=t.current,t.current=e}var Ki={},mn=rs(Ki),Dn=rs(!1),ks=Ki;function Mo(t,e){var n=t.type.contextTypes;if(!n)return Ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Nn(t){return t=t.childContextTypes,t!=null}function Ou(){rt(Dn),rt(mn)}function Ly(t,e,n){if(mn.current!==Ki)throw Error(G(168));Xe(mn,e),Xe(Dn,n)}function U_(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(G(108,Ub(t)||"Unknown",i));return ut({},n,r)}function Lu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ki,ks=mn.current,Xe(mn,t),Xe(Dn,Dn.current),!0}function My(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=U_(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,rt(Dn),rt(mn),Xe(mn,t)):rt(Dn),Xe(Dn,n)}var zr=null,Rd=!1,Lh=!1;function $_(t){zr===null?zr=[t]:zr.push(t)}function sC(t){Rd=!0,$_(t)}function is(){if(!Lh&&zr!==null){Lh=!0;var t=0,e=qe;try{var n=zr;for(qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}zr=null,Rd=!1}catch(i){throw zr!==null&&(zr=zr.slice(t+1)),p_(Kp,is),i}finally{qe=e,Lh=!1}}return null}var fo=[],po=0,Mu=null,Vu=0,Kn=[],Qn=0,js=null,Fr=1,Ur="";function gs(t,e){fo[po++]=Vu,fo[po++]=Mu,Mu=t,Vu=e}function W_(t,e,n){Kn[Qn++]=Fr,Kn[Qn++]=Ur,Kn[Qn++]=js,js=t;var r=Fr;t=Ur;var i=32-pr(r)-1;r&=~(1<<i),n+=1;var s=32-pr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Fr=1<<32-pr(e)+i|n<<i|r,Ur=s+t}else Fr=1<<s|n<<i|r,Ur=t}function rm(t){t.return!==null&&(gs(t,1),W_(t,1,0))}function im(t){for(;t===Mu;)Mu=fo[--po],fo[po]=null,Vu=fo[--po],fo[po]=null;for(;t===js;)js=Kn[--Qn],Kn[Qn]=null,Ur=Kn[--Qn],Kn[Qn]=null,Fr=Kn[--Qn],Kn[Qn]=null}var Un=null,Bn=null,ot=!1,ur=null;function q_(t,e){var n=Jn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Vy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Un=t,Bn=Oi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Un=t,Bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=js!==null?{id:Fr,overflow:Ur}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Un=t,Bn=null,!0):!1;default:return!1}}function Vf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zf(t){if(ot){var e=Bn;if(e){var n=e;if(!Vy(t,e)){if(Vf(t))throw Error(G(418));e=Oi(n.nextSibling);var r=Un;e&&Vy(t,e)?q_(r,n):(t.flags=t.flags&-4097|2,ot=!1,Un=t)}}else{if(Vf(t))throw Error(G(418));t.flags=t.flags&-4097|2,ot=!1,Un=t}}}function zy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Un=t}function Bc(t){if(t!==Un)return!1;if(!ot)return zy(t),ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Pf(t.type,t.memoizedProps)),e&&(e=Bn)){if(Vf(t))throw H_(),Error(G(418));for(;e;)q_(t,e),e=Oi(e.nextSibling)}if(zy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bn=Oi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bn=null}}else Bn=Un?Oi(t.stateNode.nextSibling):null;return!0}function H_(){for(var t=Bn;t;)t=Oi(t.nextSibling)}function Vo(){Bn=Un=null,ot=!1}function sm(t){ur===null?ur=[t]:ur.push(t)}var oC=ni.ReactCurrentBatchConfig;function Ta(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var c=i.refs;o===null?delete c[s]:c[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Fc(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function By(t){var e=t._init;return e(t._payload)}function G_(t){function e(b,y){if(t){var I=b.deletions;I===null?(b.deletions=[y],b.flags|=16):I.push(y)}}function n(b,y){if(!t)return null;for(;y!==null;)e(b,y),y=y.sibling;return null}function r(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function i(b,y){return b=zi(b,y),b.index=0,b.sibling=null,b}function s(b,y,I){return b.index=I,t?(I=b.alternate,I!==null?(I=I.index,I<y?(b.flags|=2,y):I):(b.flags|=2,y)):(b.flags|=1048576,y)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function c(b,y,I,N){return y===null||y.tag!==6?(y=$h(I,b.mode,N),y.return=b,y):(y=i(y,I),y.return=b,y)}function u(b,y,I,N){var M=I.type;return M===oo?f(b,y,I.props.children,N,I.key):y!==null&&(y.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===yi&&By(M)===y.type)?(N=i(y,I.props),N.ref=Ta(b,y,I),N.return=b,N):(N=hu(I.type,I.key,I.props,null,b.mode,N),N.ref=Ta(b,y,I),N.return=b,N)}function d(b,y,I,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==I.containerInfo||y.stateNode.implementation!==I.implementation?(y=Wh(I,b.mode,N),y.return=b,y):(y=i(y,I.children||[]),y.return=b,y)}function f(b,y,I,N,M){return y===null||y.tag!==7?(y=Cs(I,b.mode,N,M),y.return=b,y):(y=i(y,I),y.return=b,y)}function p(b,y,I){if(typeof y=="string"&&y!==""||typeof y=="number")return y=$h(""+y,b.mode,I),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case kc:return I=hu(y.type,y.key,y.props,null,b.mode,I),I.ref=Ta(b,null,y),I.return=b,I;case so:return y=Wh(y,b.mode,I),y.return=b,y;case yi:var N=y._init;return p(b,N(y._payload),I)}if(za(y)||Ia(y))return y=Cs(y,b.mode,I,null),y.return=b,y;Fc(b,y)}return null}function g(b,y,I,N){var M=y!==null?y.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return M!==null?null:c(b,y,""+I,N);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case kc:return I.key===M?u(b,y,I,N):null;case so:return I.key===M?d(b,y,I,N):null;case yi:return M=I._init,g(b,y,M(I._payload),N)}if(za(I)||Ia(I))return M!==null?null:f(b,y,I,N,null);Fc(b,I)}return null}function x(b,y,I,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return b=b.get(I)||null,c(y,b,""+N,M);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case kc:return b=b.get(N.key===null?I:N.key)||null,u(y,b,N,M);case so:return b=b.get(N.key===null?I:N.key)||null,d(y,b,N,M);case yi:var B=N._init;return x(b,y,I,B(N._payload),M)}if(za(N)||Ia(N))return b=b.get(I)||null,f(y,b,N,M,null);Fc(y,N)}return null}function C(b,y,I,N){for(var M=null,B=null,_=y,v=y=0,S=null;_!==null&&v<I.length;v++){_.index>v?(S=_,_=null):S=_.sibling;var A=g(b,_,I[v],N);if(A===null){_===null&&(_=S);break}t&&_&&A.alternate===null&&e(b,_),y=s(A,y,v),B===null?M=A:B.sibling=A,B=A,_=S}if(v===I.length)return n(b,_),ot&&gs(b,v),M;if(_===null){for(;v<I.length;v++)_=p(b,I[v],N),_!==null&&(y=s(_,y,v),B===null?M=_:B.sibling=_,B=_);return ot&&gs(b,v),M}for(_=r(b,_);v<I.length;v++)S=x(_,b,v,I[v],N),S!==null&&(t&&S.alternate!==null&&_.delete(S.key===null?v:S.key),y=s(S,y,v),B===null?M=S:B.sibling=S,B=S);return t&&_.forEach(function(k){return e(b,k)}),ot&&gs(b,v),M}function j(b,y,I,N){var M=Ia(I);if(typeof M!="function")throw Error(G(150));if(I=M.call(I),I==null)throw Error(G(151));for(var B=M=null,_=y,v=y=0,S=null,A=I.next();_!==null&&!A.done;v++,A=I.next()){_.index>v?(S=_,_=null):S=_.sibling;var k=g(b,_,A.value,N);if(k===null){_===null&&(_=S);break}t&&_&&k.alternate===null&&e(b,_),y=s(k,y,v),B===null?M=k:B.sibling=k,B=k,_=S}if(A.done)return n(b,_),ot&&gs(b,v),M;if(_===null){for(;!A.done;v++,A=I.next())A=p(b,A.value,N),A!==null&&(y=s(A,y,v),B===null?M=A:B.sibling=A,B=A);return ot&&gs(b,v),M}for(_=r(b,_);!A.done;v++,A=I.next())A=x(_,b,v,A.value,N),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?v:A.key),y=s(A,y,v),B===null?M=A:B.sibling=A,B=A);return t&&_.forEach(function(D){return e(b,D)}),ot&&gs(b,v),M}function P(b,y,I,N){if(typeof I=="object"&&I!==null&&I.type===oo&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case kc:e:{for(var M=I.key,B=y;B!==null;){if(B.key===M){if(M=I.type,M===oo){if(B.tag===7){n(b,B.sibling),y=i(B,I.props.children),y.return=b,b=y;break e}}else if(B.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===yi&&By(M)===B.type){n(b,B.sibling),y=i(B,I.props),y.ref=Ta(b,B,I),y.return=b,b=y;break e}n(b,B);break}else e(b,B);B=B.sibling}I.type===oo?(y=Cs(I.props.children,b.mode,N,I.key),y.return=b,b=y):(N=hu(I.type,I.key,I.props,null,b.mode,N),N.ref=Ta(b,y,I),N.return=b,b=N)}return o(b);case so:e:{for(B=I.key;y!==null;){if(y.key===B)if(y.tag===4&&y.stateNode.containerInfo===I.containerInfo&&y.stateNode.implementation===I.implementation){n(b,y.sibling),y=i(y,I.children||[]),y.return=b,b=y;break e}else{n(b,y);break}else e(b,y);y=y.sibling}y=Wh(I,b.mode,N),y.return=b,b=y}return o(b);case yi:return B=I._init,P(b,y,B(I._payload),N)}if(za(I))return C(b,y,I,N);if(Ia(I))return j(b,y,I,N);Fc(b,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,y!==null&&y.tag===6?(n(b,y.sibling),y=i(y,I),y.return=b,b=y):(n(b,y),y=$h(I,b.mode,N),y.return=b,b=y),o(b)):n(b,y)}return P}var zo=G_(!0),K_=G_(!1),zu=rs(null),Bu=null,mo=null,om=null;function am(){om=mo=Bu=null}function lm(t){var e=zu.current;rt(zu),t._currentValue=e}function Bf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function So(t,e){Bu=t,om=mo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jn=!0),t.firstContext=null)}function er(t){var e=t._currentValue;if(om!==t)if(t={context:t,memoizedValue:e,next:null},mo===null){if(Bu===null)throw Error(G(308));mo=t,Bu.dependencies={lanes:0,firstContext:t}}else mo=mo.next=t;return e}var Es=null;function cm(t){Es===null?Es=[t]:Es.push(t)}function Q_(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,cm(e)):(n.next=i.next,i.next=n),e.interleaved=n,Qr(t,r)}function Qr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vi=!1;function um(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Li(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Oe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Qr(t,n)}return i=r.interleaved,i===null?(e.next=e,cm(r)):(e.next=i.next,i.next=e),r.interleaved=e,Qr(t,n)}function ou(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qp(t,n)}}function Fy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fu(t,e,n,r){var i=t.updateQueue;vi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?s=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;o=0,f=d=u=null,c=s;do{var g=c.lane,x=c.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var C=t,j=c;switch(g=e,x=n,j.tag){case 1:if(C=j.payload,typeof C=="function"){p=C.call(x,p,g);break e}p=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=j.payload,g=typeof C=="function"?C.call(x,p,g):C,g==null)break e;p=ut({},p,g);break e;case 2:vi=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,g=i.effects,g===null?i.effects=[c]:g.push(c))}else x={eventTime:x,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=x,u=p):f=f.next=x,o|=g;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;g=c,c=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(f===null&&(u=p),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ns|=o,t.lanes=o,t.memoizedState=p}}function Uy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(G(191,i));i.call(r)}}}var ec={},Rr=rs(ec),Cl=rs(ec),Al=rs(ec);function Is(t){if(t===ec)throw Error(G(174));return t}function dm(t,e){switch(Xe(Al,e),Xe(Cl,t),Xe(Rr,ec),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_f(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_f(e,t)}rt(Rr),Xe(Rr,e)}function Bo(){rt(Rr),rt(Cl),rt(Al)}function J_(t){Is(Al.current);var e=Is(Rr.current),n=_f(e,t.type);e!==n&&(Xe(Cl,t),Xe(Rr,n))}function hm(t){Cl.current===t&&(rt(Rr),rt(Cl))}var lt=rs(0);function Uu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mh=[];function fm(){for(var t=0;t<Mh.length;t++)Mh[t]._workInProgressVersionPrimary=null;Mh.length=0}var au=ni.ReactCurrentDispatcher,Vh=ni.ReactCurrentBatchConfig,Ds=0,ct=null,Nt=null,Bt=null,$u=!1,el=!1,Tl=0,aC=0;function an(){throw Error(G(321))}function pm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yr(t[n],e[n]))return!1;return!0}function mm(t,e,n,r,i,s){if(Ds=s,ct=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,au.current=t===null||t.memoizedState===null?dC:hC,t=n(r,i),el){s=0;do{if(el=!1,Tl=0,25<=s)throw Error(G(301));s+=1,Bt=Nt=null,e.updateQueue=null,au.current=fC,t=n(r,i)}while(el)}if(au.current=Wu,e=Nt!==null&&Nt.next!==null,Ds=0,Bt=Nt=ct=null,$u=!1,e)throw Error(G(300));return t}function gm(){var t=Tl!==0;return Tl=0,t}function Sr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?ct.memoizedState=Bt=t:Bt=Bt.next=t,Bt}function tr(){if(Nt===null){var t=ct.alternate;t=t!==null?t.memoizedState:null}else t=Nt.next;var e=Bt===null?ct.memoizedState:Bt.next;if(e!==null)Bt=e,Nt=t;else{if(t===null)throw Error(G(310));Nt=t,t={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Bt===null?ct.memoizedState=Bt=t:Bt=Bt.next=t}return Bt}function Rl(t,e){return typeof e=="function"?e(t):e}function zh(t){var e=tr(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Nt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var c=o=null,u=null,d=s;do{var f=d.lane;if((Ds&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,o=r):u=u.next=p,ct.lanes|=f,Ns|=f}d=d.next}while(d!==null&&d!==s);u===null?o=r:u.next=c,yr(r,e.memoizedState)||(jn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ct.lanes|=s,Ns|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Bh(t){var e=tr(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);yr(s,e.memoizedState)||(jn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function X_(){}function Z_(t,e){var n=ct,r=tr(),i=e(),s=!yr(r.memoizedState,i);if(s&&(r.memoizedState=i,jn=!0),r=r.queue,ym(n1.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Bt!==null&&Bt.memoizedState.tag&1){if(n.flags|=2048,kl(9,t1.bind(null,n,r,i,e),void 0,null),$t===null)throw Error(G(349));Ds&30||e1(n,e,i)}return i}function e1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ct.updateQueue,e===null?(e={lastEffect:null,stores:null},ct.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function t1(t,e,n,r){e.value=n,e.getSnapshot=r,r1(e)&&i1(t)}function n1(t,e,n){return n(function(){r1(e)&&i1(t)})}function r1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yr(t,n)}catch{return!0}}function i1(t){var e=Qr(t,1);e!==null&&mr(e,t,1,-1)}function $y(t){var e=Sr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rl,lastRenderedState:t},e.queue=t,t=t.dispatch=uC.bind(null,ct,t),[e.memoizedState,t]}function kl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ct.updateQueue,e===null?(e={lastEffect:null,stores:null},ct.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function s1(){return tr().memoizedState}function lu(t,e,n,r){var i=Sr();ct.flags|=t,i.memoizedState=kl(1|e,n,void 0,r===void 0?null:r)}function kd(t,e,n,r){var i=tr();r=r===void 0?null:r;var s=void 0;if(Nt!==null){var o=Nt.memoizedState;if(s=o.destroy,r!==null&&pm(r,o.deps)){i.memoizedState=kl(e,n,s,r);return}}ct.flags|=t,i.memoizedState=kl(1|e,n,s,r)}function Wy(t,e){return lu(8390656,8,t,e)}function ym(t,e){return kd(2048,8,t,e)}function o1(t,e){return kd(4,2,t,e)}function a1(t,e){return kd(4,4,t,e)}function l1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function c1(t,e,n){return n=n!=null?n.concat([t]):null,kd(4,4,l1.bind(null,e,t),n)}function vm(){}function u1(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pm(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function d1(t,e){var n=tr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pm(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function h1(t,e,n){return Ds&21?(yr(n,e)||(n=y_(),ct.lanes|=n,Ns|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jn=!0),t.memoizedState=n)}function lC(t,e){var n=qe;qe=n!==0&&4>n?n:4,t(!0);var r=Vh.transition;Vh.transition={};try{t(!1),e()}finally{qe=n,Vh.transition=r}}function f1(){return tr().memoizedState}function cC(t,e,n){var r=Vi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},p1(t))m1(e,n);else if(n=Q_(t,e,n,r),n!==null){var i=_n();mr(n,t,r,i),g1(n,e,r)}}function uC(t,e,n){var r=Vi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(p1(t))m1(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,c=s(o,n);if(i.hasEagerState=!0,i.eagerState=c,yr(c,o)){var u=e.interleaved;u===null?(i.next=i,cm(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=Q_(t,e,i,r),n!==null&&(i=_n(),mr(n,t,r,i),g1(n,e,r))}}function p1(t){var e=t.alternate;return t===ct||e!==null&&e===ct}function m1(t,e){el=$u=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function g1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qp(t,n)}}var Wu={readContext:er,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},dC={readContext:er,useCallback:function(t,e){return Sr().memoizedState=[t,e===void 0?null:e],t},useContext:er,useEffect:Wy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,lu(4194308,4,l1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return lu(4194308,4,t,e)},useInsertionEffect:function(t,e){return lu(4,2,t,e)},useMemo:function(t,e){var n=Sr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Sr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cC.bind(null,ct,t),[r.memoizedState,t]},useRef:function(t){var e=Sr();return t={current:t},e.memoizedState=t},useState:$y,useDebugValue:vm,useDeferredValue:function(t){return Sr().memoizedState=t},useTransition:function(){var t=$y(!1),e=t[0];return t=lC.bind(null,t[1]),Sr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ct,i=Sr();if(ot){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),$t===null)throw Error(G(349));Ds&30||e1(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Wy(n1.bind(null,r,s,t),[t]),r.flags|=2048,kl(9,t1.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Sr(),e=$t.identifierPrefix;if(ot){var n=Ur,r=Fr;n=(r&~(1<<32-pr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Tl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=aC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hC={readContext:er,useCallback:u1,useContext:er,useEffect:ym,useImperativeHandle:c1,useInsertionEffect:o1,useLayoutEffect:a1,useMemo:d1,useReducer:zh,useRef:s1,useState:function(){return zh(Rl)},useDebugValue:vm,useDeferredValue:function(t){var e=tr();return h1(e,Nt.memoizedState,t)},useTransition:function(){var t=zh(Rl)[0],e=tr().memoizedState;return[t,e]},useMutableSource:X_,useSyncExternalStore:Z_,useId:f1,unstable_isNewReconciler:!1},fC={readContext:er,useCallback:u1,useContext:er,useEffect:ym,useImperativeHandle:c1,useInsertionEffect:o1,useLayoutEffect:a1,useMemo:d1,useReducer:Bh,useRef:s1,useState:function(){return Bh(Rl)},useDebugValue:vm,useDeferredValue:function(t){var e=tr();return Nt===null?e.memoizedState=t:h1(e,Nt.memoizedState,t)},useTransition:function(){var t=Bh(Rl)[0],e=tr().memoizedState;return[t,e]},useMutableSource:X_,useSyncExternalStore:Z_,useId:f1,unstable_isNewReconciler:!1};function lr(t,e){if(t&&t.defaultProps){e=ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ff(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var jd={isMounted:function(t){return(t=t._reactInternals)?Us(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=_n(),i=Vi(t),s=qr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Li(t,s,i),e!==null&&(mr(e,t,i,r),ou(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=_n(),i=Vi(t),s=qr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Li(t,s,i),e!==null&&(mr(e,t,i,r),ou(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=_n(),r=Vi(t),i=qr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Li(t,i,r),e!==null&&(mr(e,t,r,n),ou(e,t,r))}};function qy(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!El(n,r)||!El(i,s):!0}function y1(t,e,n){var r=!1,i=Ki,s=e.contextType;return typeof s=="object"&&s!==null?s=er(s):(i=Nn(e)?ks:mn.current,r=e.contextTypes,s=(r=r!=null)?Mo(t,i):Ki),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Hy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&jd.enqueueReplaceState(e,e.state,null)}function Uf(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},um(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=er(s):(s=Nn(e)?ks:mn.current,i.context=Mo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ff(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&jd.enqueueReplaceState(i,i.state,null),Fu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Fo(t,e){try{var n="",r=e;do n+=Fb(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Fh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $f(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var pC=typeof WeakMap=="function"?WeakMap:Map;function v1(t,e,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hu||(Hu=!0,Zf=r),$f(t,e)},n}function x1(t,e,n){n=qr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$f(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$f(t,e),typeof r!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Gy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new pC;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=TC.bind(null,t,e,n),e.then(t,t))}function Ky(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qr(-1,1),e.tag=2,Li(n,e,1))),n.lanes|=1),t)}var mC=ni.ReactCurrentOwner,jn=!1;function xn(t,e,n,r){e.child=t===null?K_(e,null,n,r):zo(e,t.child,n,r)}function Yy(t,e,n,r,i){n=n.render;var s=e.ref;return So(e,i),r=mm(t,e,n,r,s,i),n=gm(),t!==null&&!jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Yr(t,e,i)):(ot&&n&&rm(e),e.flags|=1,xn(t,e,r,i),e.child)}function Jy(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Cm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,_1(t,e,s,r,i)):(t=hu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:El,n(o,r)&&t.ref===e.ref)return Yr(t,e,i)}return e.flags|=1,t=zi(s,r),t.ref=e.ref,t.return=e,e.child=t}function _1(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(El(s,r)&&t.ref===e.ref)if(jn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(jn=!0);else return e.lanes=t.lanes,Yr(t,e,i)}return Wf(t,e,n,r,i)}function w1(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(yo,zn),zn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xe(yo,zn),zn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Xe(yo,zn),zn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Xe(yo,zn),zn|=r;return xn(t,e,i,n),e.child}function E1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wf(t,e,n,r,i){var s=Nn(n)?ks:mn.current;return s=Mo(e,s),So(e,i),n=mm(t,e,n,r,s,i),r=gm(),t!==null&&!jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Yr(t,e,i)):(ot&&r&&rm(e),e.flags|=1,xn(t,e,n,i),e.child)}function Xy(t,e,n,r,i){if(Nn(n)){var s=!0;Lu(e)}else s=!1;if(So(e,i),e.stateNode===null)cu(t,e),y1(e,n,r),Uf(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=er(d):(d=Nn(n)?ks:mn.current,d=Mo(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Hy(e,o,r,d),vi=!1;var g=e.memoizedState;o.state=g,Fu(e,r,o,i),u=e.memoizedState,c!==r||g!==u||Dn.current||vi?(typeof f=="function"&&(Ff(e,n,f,r),u=e.memoizedState),(c=vi||qy(e,n,c,r,g,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Y_(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:lr(e.type,c),o.props=d,p=e.pendingProps,g=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=er(u):(u=Nn(n)?ks:mn.current,u=Mo(e,u));var x=n.getDerivedStateFromProps;(f=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==p||g!==u)&&Hy(e,o,r,u),vi=!1,g=e.memoizedState,o.state=g,Fu(e,r,o,i);var C=e.memoizedState;c!==p||g!==C||Dn.current||vi?(typeof x=="function"&&(Ff(e,n,x,r),C=e.memoizedState),(d=vi||qy(e,n,d,r,g,C,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return qf(t,e,n,r,s,i)}function qf(t,e,n,r,i,s){E1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&My(e,n,!1),Yr(t,e,s);r=e.stateNode,mC.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=zo(e,t.child,null,s),e.child=zo(e,null,c,s)):xn(t,e,c,s),e.memoizedState=r.state,i&&My(e,n,!0),e.child}function I1(t){var e=t.stateNode;e.pendingContext?Ly(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ly(t,e.context,!1),dm(t,e.containerInfo)}function Zy(t,e,n,r,i){return Vo(),sm(i),e.flags|=256,xn(t,e,n,r),e.child}var Hf={dehydrated:null,treeContext:null,retryLane:0};function Gf(t){return{baseLanes:t,cachePool:null,transitions:null}}function b1(t,e,n){var r=e.pendingProps,i=lt.current,s=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xe(lt,i&1),t===null)return zf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Pd(o,r,0,null),t=Cs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gf(n),e.memoizedState=Hf,t):xm(e,o));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return gC(t,e,o,r,c,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,c=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=zi(i,u),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?s=zi(c,s):(s=Cs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Gf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Hf,r}return s=t.child,t=s.sibling,r=zi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function xm(t,e){return e=Pd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Uc(t,e,n,r){return r!==null&&sm(r),zo(e,t.child,null,n),t=xm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gC(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Fh(Error(G(422))),Uc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Pd({mode:"visible",children:r.children},i,0,null),s=Cs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&zo(e,t.child,null,o),e.child.memoizedState=Gf(o),e.memoizedState=Hf,s);if(!(e.mode&1))return Uc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,s=Error(G(419)),r=Fh(s,r,void 0),Uc(t,e,o,r)}if(c=(o&t.childLanes)!==0,jn||c){if(r=$t,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Qr(t,i),mr(r,t,i,-1))}return Sm(),r=Fh(Error(G(421))),Uc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=RC.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bn=Oi(i.nextSibling),Un=e,ot=!0,ur=null,t!==null&&(Kn[Qn++]=Fr,Kn[Qn++]=Ur,Kn[Qn++]=js,Fr=t.id,Ur=t.overflow,js=e),e=xm(e,r.children),e.flags|=4096,e)}function ev(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bf(t.return,e,n)}function Uh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function S1(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(xn(t,e,r.children,n),r=lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ev(t,n,e);else if(t.tag===19)ev(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xe(lt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Uu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Uh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Uu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Uh(e,!0,n,null,s);break;case"together":Uh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ns|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=zi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=zi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function yC(t,e,n){switch(e.tag){case 3:I1(e),Vo();break;case 5:J_(e);break;case 1:Nn(e.type)&&Lu(e);break;case 4:dm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xe(zu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xe(lt,lt.current&1),e.flags|=128,null):n&e.child.childLanes?b1(t,e,n):(Xe(lt,lt.current&1),t=Yr(t,e,n),t!==null?t.sibling:null);Xe(lt,lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return S1(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xe(lt,lt.current),r)break;return null;case 22:case 23:return e.lanes=0,w1(t,e,n)}return Yr(t,e,n)}var C1,Kf,A1,T1;C1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kf=function(){};A1=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Is(Rr.current);var s=null;switch(n){case"input":i=gf(t,i),r=gf(t,r),s=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),s=[];break;case"textarea":i=xf(t,i),r=xf(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Pu)}wf(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var c=i[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ml.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var u=r[d];if(c=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(s=s||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ml.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&tt("scroll",t),s||c===u||(s=[])):(s=s||[]).push(d,u))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};T1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ra(t,e){if(!ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ln(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function vC(t,e,n){var r=e.pendingProps;switch(im(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(e),null;case 1:return Nn(e.type)&&Ou(),ln(e),null;case 3:return r=e.stateNode,Bo(),rt(Dn),rt(mn),fm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Bc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ur!==null&&(np(ur),ur=null))),Kf(t,e),ln(e),null;case 5:hm(e);var i=Is(Al.current);if(n=e.type,t!==null&&e.stateNode!=null)A1(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return ln(e),null}if(t=Is(Rr.current),Bc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ar]=e,r[Sl]=s,t=(e.mode&1)!==0,n){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(i=0;i<Fa.length;i++)tt(Fa[i],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":cy(r,s),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},tt("invalid",r);break;case"textarea":dy(r,s),tt("invalid",r)}wf(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var c=s[o];o==="children"?typeof c=="string"?r.textContent!==c&&(s.suppressHydrationWarning!==!0&&zc(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&zc(r.textContent,c,t),i=["children",""+c]):ml.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&tt("scroll",r)}switch(n){case"input":jc(r),uy(r,s,!0);break;case"textarea":jc(r),hy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Pu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=n_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ar]=e,t[Sl]=r,C1(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ef(n,r),n){case"dialog":tt("cancel",t),tt("close",t),i=r;break;case"iframe":case"object":case"embed":tt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Fa.length;i++)tt(Fa[i],t);i=r;break;case"source":tt("error",t),i=r;break;case"img":case"image":case"link":tt("error",t),tt("load",t),i=r;break;case"details":tt("toggle",t),i=r;break;case"input":cy(t,r),i=gf(t,r),tt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),tt("invalid",t);break;case"textarea":dy(t,r),i=xf(t,r),tt("invalid",t);break;default:i=r}wf(n,i),c=i;for(s in c)if(c.hasOwnProperty(s)){var u=c[s];s==="style"?s_(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&r_(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&gl(t,u):typeof u=="number"&&gl(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ml.hasOwnProperty(s)?u!=null&&s==="onScroll"&&tt("scroll",t):u!=null&&$p(t,s,u,o))}switch(n){case"input":jc(t),uy(t,r,!1);break;case"textarea":jc(t),hy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Gi(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?wo(t,!!r.multiple,s,!1):r.defaultValue!=null&&wo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Pu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ln(e),null;case 6:if(t&&e.stateNode!=null)T1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=Is(Al.current),Is(Rr.current),Bc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ar]=e,(s=r.nodeValue!==n)&&(t=Un,t!==null))switch(t.tag){case 3:zc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&zc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ar]=e,e.stateNode=r}return ln(e),null;case 13:if(rt(lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ot&&Bn!==null&&e.mode&1&&!(e.flags&128))H_(),Vo(),e.flags|=98560,s=!1;else if(s=Bc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(G(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(G(317));s[Ar]=e}else Vo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ln(e),s=!1}else ur!==null&&(np(ur),ur=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||lt.current&1?Lt===0&&(Lt=3):Sm())),e.updateQueue!==null&&(e.flags|=4),ln(e),null);case 4:return Bo(),Kf(t,e),t===null&&Il(e.stateNode.containerInfo),ln(e),null;case 10:return lm(e.type._context),ln(e),null;case 17:return Nn(e.type)&&Ou(),ln(e),null;case 19:if(rt(lt),s=e.memoizedState,s===null)return ln(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ra(s,!1);else{if(Lt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Uu(t),o!==null){for(e.flags|=128,Ra(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xe(lt,lt.current&1|2),e.child}t=t.sibling}s.tail!==null&&xt()>Uo&&(e.flags|=128,r=!0,Ra(s,!1),e.lanes=4194304)}else{if(!r)if(t=Uu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ra(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ot)return ln(e),null}else 2*xt()-s.renderingStartTime>Uo&&n!==1073741824&&(e.flags|=128,r=!0,Ra(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=xt(),e.sibling=null,n=lt.current,Xe(lt,r?n&1|2:n&1),e):(ln(e),null);case 22:case 23:return bm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zn&1073741824&&(ln(e),e.subtreeFlags&6&&(e.flags|=8192)):ln(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function xC(t,e){switch(im(e),e.tag){case 1:return Nn(e.type)&&Ou(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bo(),rt(Dn),rt(mn),fm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return hm(e),null;case 13:if(rt(lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));Vo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(lt),null;case 4:return Bo(),null;case 10:return lm(e.type._context),null;case 22:case 23:return bm(),null;case 24:return null;default:return null}}var $c=!1,dn=!1,_C=typeof WeakSet=="function"?WeakSet:Set,te=null;function go(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pt(t,e,r)}else n.current=null}function Qf(t,e,n){try{n()}catch(r){pt(t,e,r)}}var tv=!1;function wC(t,e){if(Df=ju,t=N_(),nm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,f=0,p=t,g=null;t:for(;;){for(var x;p!==n||i!==0&&p.nodeType!==3||(c=o+i),p!==s||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(x=p.firstChild)!==null;)g=p,p=x;for(;;){if(p===t)break t;if(g===n&&++d===i&&(c=o),g===s&&++f===r&&(u=o),(x=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=x}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nf={focusedElem:t,selectionRange:n},ju=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var j=C.memoizedProps,P=C.memoizedState,b=e.stateNode,y=b.getSnapshotBeforeUpdate(e.elementType===e.type?j:lr(e.type,j),P);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(N){pt(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return C=tv,tv=!1,C}function tl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Qf(e,n,s)}i=i.next}while(i!==r)}}function Dd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function R1(t){var e=t.alternate;e!==null&&(t.alternate=null,R1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ar],delete e[Sl],delete e[Lf],delete e[rC],delete e[iC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function k1(t){return t.tag===5||t.tag===3||t.tag===4}function nv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||k1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Pu));else if(r!==4&&(t=t.child,t!==null))for(Jf(t,e,n),t=t.sibling;t!==null;)Jf(t,e,n),t=t.sibling}function Xf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xf(t,e,n),t=t.sibling;t!==null;)Xf(t,e,n),t=t.sibling}var Ht=null,cr=!1;function fi(t,e,n){for(n=n.child;n!==null;)j1(t,e,n),n=n.sibling}function j1(t,e,n){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(bd,n)}catch{}switch(n.tag){case 5:dn||go(n,e);case 6:var r=Ht,i=cr;Ht=null,fi(t,e,n),Ht=r,cr=i,Ht!==null&&(cr?(t=Ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(cr?(t=Ht,n=n.stateNode,t.nodeType===8?Oh(t.parentNode,n):t.nodeType===1&&Oh(t,n),_l(t)):Oh(Ht,n.stateNode));break;case 4:r=Ht,i=cr,Ht=n.stateNode.containerInfo,cr=!0,fi(t,e,n),Ht=r,cr=i;break;case 0:case 11:case 14:case 15:if(!dn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Qf(n,e,o),i=i.next}while(i!==r)}fi(t,e,n);break;case 1:if(!dn&&(go(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){pt(n,e,c)}fi(t,e,n);break;case 21:fi(t,e,n);break;case 22:n.mode&1?(dn=(r=dn)||n.memoizedState!==null,fi(t,e,n),dn=r):fi(t,e,n);break;default:fi(t,e,n)}}function rv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new _C),e.forEach(function(r){var i=kC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function or(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ht=c.stateNode,cr=!1;break e;case 3:Ht=c.stateNode.containerInfo,cr=!0;break e;case 4:Ht=c.stateNode.containerInfo,cr=!0;break e}c=c.return}if(Ht===null)throw Error(G(160));j1(s,o,i),Ht=null,cr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){pt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)D1(e,t),e=e.sibling}function D1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(or(e,t),br(t),r&4){try{tl(3,t,t.return),Dd(3,t)}catch(j){pt(t,t.return,j)}try{tl(5,t,t.return)}catch(j){pt(t,t.return,j)}}break;case 1:or(e,t),br(t),r&512&&n!==null&&go(n,n.return);break;case 5:if(or(e,t),br(t),r&512&&n!==null&&go(n,n.return),t.flags&32){var i=t.stateNode;try{gl(i,"")}catch(j){pt(t,t.return,j)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&e_(i,s),Ef(c,o);var d=Ef(c,s);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?s_(i,p):f==="dangerouslySetInnerHTML"?r_(i,p):f==="children"?gl(i,p):$p(i,f,p,d)}switch(c){case"input":yf(i,s);break;case"textarea":t_(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?wo(i,!!s.multiple,x,!1):g!==!!s.multiple&&(s.defaultValue!=null?wo(i,!!s.multiple,s.defaultValue,!0):wo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Sl]=s}catch(j){pt(t,t.return,j)}}break;case 6:if(or(e,t),br(t),r&4){if(t.stateNode===null)throw Error(G(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(j){pt(t,t.return,j)}}break;case 3:if(or(e,t),br(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_l(e.containerInfo)}catch(j){pt(t,t.return,j)}break;case 4:or(e,t),br(t);break;case 13:or(e,t),br(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Em=xt())),r&4&&rv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(dn=(d=dn)||f,or(e,t),dn=d):or(e,t),br(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(te=t,f=t.child;f!==null;){for(p=te=f;te!==null;){switch(g=te,x=g.child,g.tag){case 0:case 11:case 14:case 15:tl(4,g,g.return);break;case 1:go(g,g.return);var C=g.stateNode;if(typeof C.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(j){pt(r,n,j)}}break;case 5:go(g,g.return);break;case 22:if(g.memoizedState!==null){sv(p);continue}}x!==null?(x.return=g,te=x):sv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=i_("display",o))}catch(j){pt(t,t.return,j)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(j){pt(t,t.return,j)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:or(e,t),br(t),r&4&&rv(t);break;case 21:break;default:or(e,t),br(t)}}function br(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(k1(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(gl(i,""),r.flags&=-33);var s=nv(t);Xf(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,c=nv(t);Jf(t,c,o);break;default:throw Error(G(161))}}catch(u){pt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EC(t,e,n){te=t,N1(t)}function N1(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var i=te,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||$c;if(!o){var c=i.alternate,u=c!==null&&c.memoizedState!==null||dn;c=$c;var d=dn;if($c=o,(dn=u)&&!d)for(te=i;te!==null;)o=te,u=o.child,o.tag===22&&o.memoizedState!==null?ov(i):u!==null?(u.return=o,te=u):ov(i);for(;s!==null;)te=s,N1(s),s=s.sibling;te=i,$c=c,dn=d}iv(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,te=s):iv(t)}}function iv(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dn||Dd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!dn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:lr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Uy(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Uy(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&_l(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}dn||e.flags&512&&Yf(e)}catch(g){pt(e,e.return,g)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function sv(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function ov(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Dd(4,e)}catch(u){pt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){pt(e,i,u)}}var s=e.return;try{Yf(e)}catch(u){pt(e,s,u)}break;case 5:var o=e.return;try{Yf(e)}catch(u){pt(e,o,u)}}}catch(u){pt(e,e.return,u)}if(e===t){te=null;break}var c=e.sibling;if(c!==null){c.return=e.return,te=c;break}te=e.return}}var IC=Math.ceil,qu=ni.ReactCurrentDispatcher,_m=ni.ReactCurrentOwner,Xn=ni.ReactCurrentBatchConfig,Oe=0,$t=null,bt=null,Yt=0,zn=0,yo=rs(0),Lt=0,jl=null,Ns=0,Nd=0,wm=0,nl=null,Rn=null,Em=0,Uo=1/0,Vr=null,Hu=!1,Zf=null,Mi=null,Wc=!1,Ri=null,Gu=0,rl=0,ep=null,uu=-1,du=0;function _n(){return Oe&6?xt():uu!==-1?uu:uu=xt()}function Vi(t){return t.mode&1?Oe&2&&Yt!==0?Yt&-Yt:oC.transition!==null?(du===0&&(du=y_()),du):(t=qe,t!==0||(t=window.event,t=t===void 0?16:b_(t.type)),t):1}function mr(t,e,n,r){if(50<rl)throw rl=0,ep=null,Error(G(185));Jl(t,n,r),(!(Oe&2)||t!==$t)&&(t===$t&&(!(Oe&2)&&(Nd|=n),Lt===4&&Ei(t,Yt)),Pn(t,r),n===1&&Oe===0&&!(e.mode&1)&&(Uo=xt()+500,Rd&&is()))}function Pn(t,e){var n=t.callbackNode;oS(t,e);var r=ku(t,t===$t?Yt:0);if(r===0)n!==null&&my(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&my(n),e===1)t.tag===0?sC(av.bind(null,t)):$_(av.bind(null,t)),tC(function(){!(Oe&6)&&is()}),n=null;else{switch(v_(r)){case 1:n=Kp;break;case 4:n=m_;break;case 16:n=Ru;break;case 536870912:n=g_;break;default:n=Ru}n=F1(n,P1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function P1(t,e){if(uu=-1,du=0,Oe&6)throw Error(G(327));var n=t.callbackNode;if(Co()&&t.callbackNode!==n)return null;var r=ku(t,t===$t?Yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ku(t,r);else{e=r;var i=Oe;Oe|=2;var s=L1();($t!==t||Yt!==e)&&(Vr=null,Uo=xt()+500,Ss(t,e));do try{CC();break}catch(c){O1(t,c)}while(!0);am(),qu.current=s,Oe=i,bt!==null?e=0:($t=null,Yt=0,e=Lt)}if(e!==0){if(e===2&&(i=Af(t),i!==0&&(r=i,e=tp(t,i))),e===1)throw n=jl,Ss(t,0),Ei(t,r),Pn(t,xt()),n;if(e===6)Ei(t,r);else{if(i=t.current.alternate,!(r&30)&&!bC(i)&&(e=Ku(t,r),e===2&&(s=Af(t),s!==0&&(r=s,e=tp(t,s))),e===1))throw n=jl,Ss(t,0),Ei(t,r),Pn(t,xt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:ys(t,Rn,Vr);break;case 3:if(Ei(t,r),(r&130023424)===r&&(e=Em+500-xt(),10<e)){if(ku(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){_n(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Of(ys.bind(null,t,Rn,Vr),e);break}ys(t,Rn,Vr);break;case 4:if(Ei(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-pr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*IC(r/1960))-r,10<r){t.timeoutHandle=Of(ys.bind(null,t,Rn,Vr),r);break}ys(t,Rn,Vr);break;case 5:ys(t,Rn,Vr);break;default:throw Error(G(329))}}}return Pn(t,xt()),t.callbackNode===n?P1.bind(null,t):null}function tp(t,e){var n=nl;return t.current.memoizedState.isDehydrated&&(Ss(t,e).flags|=256),t=Ku(t,e),t!==2&&(e=Rn,Rn=n,e!==null&&np(e)),t}function np(t){Rn===null?Rn=t:Rn.push.apply(Rn,t)}function bC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!yr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ei(t,e){for(e&=~wm,e&=~Nd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pr(e),r=1<<n;t[n]=-1,e&=~r}}function av(t){if(Oe&6)throw Error(G(327));Co();var e=ku(t,0);if(!(e&1))return Pn(t,xt()),null;var n=Ku(t,e);if(t.tag!==0&&n===2){var r=Af(t);r!==0&&(e=r,n=tp(t,r))}if(n===1)throw n=jl,Ss(t,0),Ei(t,e),Pn(t,xt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ys(t,Rn,Vr),Pn(t,xt()),null}function Im(t,e){var n=Oe;Oe|=1;try{return t(e)}finally{Oe=n,Oe===0&&(Uo=xt()+500,Rd&&is())}}function Ps(t){Ri!==null&&Ri.tag===0&&!(Oe&6)&&Co();var e=Oe;Oe|=1;var n=Xn.transition,r=qe;try{if(Xn.transition=null,qe=1,t)return t()}finally{qe=r,Xn.transition=n,Oe=e,!(Oe&6)&&is()}}function bm(){zn=yo.current,rt(yo)}function Ss(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eC(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(im(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ou();break;case 3:Bo(),rt(Dn),rt(mn),fm();break;case 5:hm(r);break;case 4:Bo();break;case 13:rt(lt);break;case 19:rt(lt);break;case 10:lm(r.type._context);break;case 22:case 23:bm()}n=n.return}if($t=t,bt=t=zi(t.current,null),Yt=zn=e,Lt=0,jl=null,wm=Nd=Ns=0,Rn=nl=null,Es!==null){for(e=0;e<Es.length;e++)if(n=Es[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Es=null}return t}function O1(t,e){do{var n=bt;try{if(am(),au.current=Wu,$u){for(var r=ct.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}$u=!1}if(Ds=0,Bt=Nt=ct=null,el=!1,Tl=0,_m.current=null,n===null||n.return===null){Lt=1,jl=e,bt=null;break}e:{var s=t,o=n.return,c=n,u=e;if(e=Yt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=Ky(o);if(x!==null){x.flags&=-257,Qy(x,o,c,s,e),x.mode&1&&Gy(s,d,e),e=x,u=d;var C=e.updateQueue;if(C===null){var j=new Set;j.add(u),e.updateQueue=j}else C.add(u);break e}else{if(!(e&1)){Gy(s,d,e),Sm();break e}u=Error(G(426))}}else if(ot&&c.mode&1){var P=Ky(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Qy(P,o,c,s,e),sm(Fo(u,c));break e}}s=u=Fo(u,c),Lt!==4&&(Lt=2),nl===null?nl=[s]:nl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=v1(s,u,e);Fy(s,b);break e;case 1:c=u;var y=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Mi===null||!Mi.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var N=x1(s,c,e);Fy(s,N);break e}}s=s.return}while(s!==null)}V1(n)}catch(M){e=M,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function L1(){var t=qu.current;return qu.current=Wu,t===null?Wu:t}function Sm(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),$t===null||!(Ns&268435455)&&!(Nd&268435455)||Ei($t,Yt)}function Ku(t,e){var n=Oe;Oe|=2;var r=L1();($t!==t||Yt!==e)&&(Vr=null,Ss(t,e));do try{SC();break}catch(i){O1(t,i)}while(!0);if(am(),Oe=n,qu.current=r,bt!==null)throw Error(G(261));return $t=null,Yt=0,Lt}function SC(){for(;bt!==null;)M1(bt)}function CC(){for(;bt!==null&&!Jb();)M1(bt)}function M1(t){var e=B1(t.alternate,t,zn);t.memoizedProps=t.pendingProps,e===null?V1(t):bt=e,_m.current=null}function V1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=xC(n,e),n!==null){n.flags&=32767,bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Lt=6,bt=null;return}}else if(n=vC(n,e,zn),n!==null){bt=n;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=t}while(e!==null);Lt===0&&(Lt=5)}function ys(t,e,n){var r=qe,i=Xn.transition;try{Xn.transition=null,qe=1,AC(t,e,n,r)}finally{Xn.transition=i,qe=r}return null}function AC(t,e,n,r){do Co();while(Ri!==null);if(Oe&6)throw Error(G(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(aS(t,s),t===$t&&(bt=$t=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wc||(Wc=!0,F1(Ru,function(){return Co(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Xn.transition,Xn.transition=null;var o=qe;qe=1;var c=Oe;Oe|=4,_m.current=null,wC(t,n),D1(n,t),GS(Nf),ju=!!Df,Nf=Df=null,t.current=n,EC(n),Xb(),Oe=c,qe=o,Xn.transition=s}else t.current=n;if(Wc&&(Wc=!1,Ri=t,Gu=i),s=t.pendingLanes,s===0&&(Mi=null),tS(n.stateNode),Pn(t,xt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hu)throw Hu=!1,t=Zf,Zf=null,t;return Gu&1&&t.tag!==0&&Co(),s=t.pendingLanes,s&1?t===ep?rl++:(rl=0,ep=t):rl=0,is(),null}function Co(){if(Ri!==null){var t=v_(Gu),e=Xn.transition,n=qe;try{if(Xn.transition=null,qe=16>t?16:t,Ri===null)var r=!1;else{if(t=Ri,Ri=null,Gu=0,Oe&6)throw Error(G(331));var i=Oe;for(Oe|=4,te=t.current;te!==null;){var s=te,o=s.child;if(te.flags&16){var c=s.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(te=d;te!==null;){var f=te;switch(f.tag){case 0:case 11:case 15:tl(8,f,s)}var p=f.child;if(p!==null)p.return=f,te=p;else for(;te!==null;){f=te;var g=f.sibling,x=f.return;if(R1(f),f===d){te=null;break}if(g!==null){g.return=x,te=g;break}te=x}}}var C=s.alternate;if(C!==null){var j=C.child;if(j!==null){C.child=null;do{var P=j.sibling;j.sibling=null,j=P}while(j!==null)}}te=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,te=o;else e:for(;te!==null;){if(s=te,s.flags&2048)switch(s.tag){case 0:case 11:case 15:tl(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,te=b;break e}te=s.return}}var y=t.current;for(te=y;te!==null;){o=te;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,te=I;else e:for(o=y;te!==null;){if(c=te,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Dd(9,c)}}catch(M){pt(c,c.return,M)}if(c===o){te=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,te=N;break e}te=c.return}}if(Oe=i,is(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(bd,t)}catch{}r=!0}return r}finally{qe=n,Xn.transition=e}}return!1}function lv(t,e,n){e=Fo(n,e),e=v1(t,e,1),t=Li(t,e,1),e=_n(),t!==null&&(Jl(t,1,e),Pn(t,e))}function pt(t,e,n){if(t.tag===3)lv(t,t,n);else for(;e!==null;){if(e.tag===3){lv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mi===null||!Mi.has(r))){t=Fo(n,t),t=x1(e,t,1),e=Li(e,t,1),t=_n(),e!==null&&(Jl(e,1,t),Pn(e,t));break}}e=e.return}}function TC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=_n(),t.pingedLanes|=t.suspendedLanes&n,$t===t&&(Yt&n)===n&&(Lt===4||Lt===3&&(Yt&130023424)===Yt&&500>xt()-Em?Ss(t,0):wm|=n),Pn(t,e)}function z1(t,e){e===0&&(t.mode&1?(e=Pc,Pc<<=1,!(Pc&130023424)&&(Pc=4194304)):e=1);var n=_n();t=Qr(t,e),t!==null&&(Jl(t,e,n),Pn(t,n))}function RC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),z1(t,n)}function kC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),z1(t,n)}var B1;B1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dn.current)jn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jn=!1,yC(t,e,n);jn=!!(t.flags&131072)}else jn=!1,ot&&e.flags&1048576&&W_(e,Vu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;cu(t,e),t=e.pendingProps;var i=Mo(e,mn.current);So(e,n),i=mm(null,e,r,t,i,n);var s=gm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nn(r)?(s=!0,Lu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,um(e),i.updater=jd,e.stateNode=i,i._reactInternals=e,Uf(e,r,t,n),e=qf(null,e,r,!0,s,n)):(e.tag=0,ot&&s&&rm(e),xn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(cu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=DC(r),t=lr(r,t),i){case 0:e=Wf(null,e,r,t,n);break e;case 1:e=Xy(null,e,r,t,n);break e;case 11:e=Yy(null,e,r,t,n);break e;case 14:e=Jy(null,e,r,lr(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:lr(r,i),Wf(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:lr(r,i),Xy(t,e,r,i,n);case 3:e:{if(I1(e),t===null)throw Error(G(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Y_(t,e),Fu(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Fo(Error(G(423)),e),e=Zy(t,e,r,n,i);break e}else if(r!==i){i=Fo(Error(G(424)),e),e=Zy(t,e,r,n,i);break e}else for(Bn=Oi(e.stateNode.containerInfo.firstChild),Un=e,ot=!0,ur=null,n=K_(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vo(),r===i){e=Yr(t,e,n);break e}xn(t,e,r,n)}e=e.child}return e;case 5:return J_(e),t===null&&zf(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Pf(r,i)?o=null:s!==null&&Pf(r,s)&&(e.flags|=32),E1(t,e),xn(t,e,o,n),e.child;case 6:return t===null&&zf(e),null;case 13:return b1(t,e,n);case 4:return dm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=zo(e,null,r,n):xn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:lr(r,i),Yy(t,e,r,i,n);case 7:return xn(t,e,e.pendingProps,n),e.child;case 8:return xn(t,e,e.pendingProps.children,n),e.child;case 12:return xn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Xe(zu,r._currentValue),r._currentValue=o,s!==null)if(yr(s.value,o)){if(s.children===i.children&&!Dn.current){e=Yr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var c=s.dependencies;if(c!==null){o=s.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=qr(-1,n&-n),u.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Bf(s.return,n,e),c.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(G(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Bf(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}xn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,So(e,n),i=er(i),r=r(i),e.flags|=1,xn(t,e,r,n),e.child;case 14:return r=e.type,i=lr(r,e.pendingProps),i=lr(r.type,i),Jy(t,e,r,i,n);case 15:return _1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:lr(r,i),cu(t,e),e.tag=1,Nn(r)?(t=!0,Lu(e)):t=!1,So(e,n),y1(e,r,i),Uf(e,r,i,n),qf(null,e,r,!0,t,n);case 19:return S1(t,e,n);case 22:return w1(t,e,n)}throw Error(G(156,e.tag))};function F1(t,e){return p_(t,e)}function jC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(t,e,n,r){return new jC(t,e,n,r)}function Cm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DC(t){if(typeof t=="function")return Cm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qp)return 11;if(t===Hp)return 14}return 2}function zi(t,e){var n=t.alternate;return n===null?(n=Jn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function hu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Cm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case oo:return Cs(n.children,i,s,e);case Wp:o=8,i|=8;break;case hf:return t=Jn(12,n,e,i|2),t.elementType=hf,t.lanes=s,t;case ff:return t=Jn(13,n,e,i),t.elementType=ff,t.lanes=s,t;case pf:return t=Jn(19,n,e,i),t.elementType=pf,t.lanes=s,t;case J0:return Pd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Q0:o=10;break e;case Y0:o=9;break e;case qp:o=11;break e;case Hp:o=14;break e;case yi:o=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=Jn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Cs(t,e,n,r){return t=Jn(7,t,r,e),t.lanes=n,t}function Pd(t,e,n,r){return t=Jn(22,t,r,e),t.elementType=J0,t.lanes=n,t.stateNode={isHidden:!1},t}function $h(t,e,n){return t=Jn(6,t,null,e),t.lanes=n,t}function Wh(t,e,n){return e=Jn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function NC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bh(0),this.expirationTimes=bh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Am(t,e,n,r,i,s,o,c,u){return t=new NC(t,e,n,c,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Jn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},um(s),t}function PC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:so,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function U1(t){if(!t)return Ki;t=t._reactInternals;e:{if(Us(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Nn(n))return U_(t,n,e)}return e}function $1(t,e,n,r,i,s,o,c,u){return t=Am(n,r,!0,t,i,s,o,c,u),t.context=U1(null),n=t.current,r=_n(),i=Vi(n),s=qr(r,i),s.callback=e??null,Li(n,s,i),t.current.lanes=i,Jl(t,i,r),Pn(t,r),t}function Od(t,e,n,r){var i=e.current,s=_n(),o=Vi(i);return n=U1(n),e.context===null?e.context=n:e.pendingContext=n,e=qr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Li(i,e,o),t!==null&&(mr(t,i,o,s),ou(t,i,o)),o}function Qu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Tm(t,e){cv(t,e),(t=t.alternate)&&cv(t,e)}function OC(){return null}var W1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Rm(t){this._internalRoot=t}Ld.prototype.render=Rm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Od(t,e,null,null)};Ld.prototype.unmount=Rm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ps(function(){Od(null,t,null,null)}),e[Kr]=null}};function Ld(t){this._internalRoot=t}Ld.prototype.unstable_scheduleHydration=function(t){if(t){var e=w_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wi.length&&e!==0&&e<wi[n].priority;n++);wi.splice(n,0,t),n===0&&I_(t)}};function km(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Md(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function uv(){}function LC(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Qu(o);s.call(d)}}var o=$1(e,r,t,0,null,!1,!1,"",uv);return t._reactRootContainer=o,t[Kr]=o.current,Il(t.nodeType===8?t.parentNode:t),Ps(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var d=Qu(u);c.call(d)}}var u=Am(t,0,!1,null,null,!1,!1,"",uv);return t._reactRootContainer=u,t[Kr]=u.current,Il(t.nodeType===8?t.parentNode:t),Ps(function(){Od(e,u,n,r)}),u}function Vd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var c=i;i=function(){var u=Qu(o);c.call(u)}}Od(e,o,t,i)}else o=LC(n,e,t,i,r);return Qu(o)}x_=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ba(e.pendingLanes);n!==0&&(Qp(e,n|1),Pn(e,xt()),!(Oe&6)&&(Uo=xt()+500,is()))}break;case 13:Ps(function(){var r=Qr(t,1);if(r!==null){var i=_n();mr(r,t,1,i)}}),Tm(t,1)}};Yp=function(t){if(t.tag===13){var e=Qr(t,134217728);if(e!==null){var n=_n();mr(e,t,134217728,n)}Tm(t,134217728)}};__=function(t){if(t.tag===13){var e=Vi(t),n=Qr(t,e);if(n!==null){var r=_n();mr(n,t,e,r)}Tm(t,e)}};w_=function(){return qe};E_=function(t,e){var n=qe;try{return qe=t,e()}finally{qe=n}};bf=function(t,e,n){switch(e){case"input":if(yf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Td(r);if(!i)throw Error(G(90));Z0(r),yf(r,i)}}}break;case"textarea":t_(t,n);break;case"select":e=n.value,e!=null&&wo(t,!!n.multiple,e,!1)}};l_=Im;c_=Ps;var MC={usingClientEntryPoint:!1,Events:[Zl,uo,Td,o_,a_,Im]},ka={findFiberByHostInstance:ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VC={bundleType:ka.bundleType,version:ka.version,rendererPackageName:ka.rendererPackageName,rendererConfig:ka.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=h_(t),t===null?null:t.stateNode},findFiberByHostInstance:ka.findFiberByHostInstance||OC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qc.isDisabled&&qc.supportsFiber)try{bd=qc.inject(VC),Tr=qc}catch{}}Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MC;Wn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!km(e))throw Error(G(200));return PC(t,e,null,n)};Wn.createRoot=function(t,e){if(!km(t))throw Error(G(299));var n=!1,r="",i=W1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Am(t,1,!1,null,null,n,!1,r,i),t[Kr]=e.current,Il(t.nodeType===8?t.parentNode:t),new Rm(e)};Wn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=h_(e),t=t===null?null:t.stateNode,t};Wn.flushSync=function(t){return Ps(t)};Wn.hydrate=function(t,e,n){if(!Md(e))throw Error(G(200));return Vd(null,t,e,!0,n)};Wn.hydrateRoot=function(t,e,n){if(!km(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=W1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=$1(e,null,t,1,n??null,i,!1,s,o),t[Kr]=e.current,Il(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ld(e)};Wn.render=function(t,e,n){if(!Md(e))throw Error(G(200));return Vd(null,t,e,!1,n)};Wn.unmountComponentAtNode=function(t){if(!Md(t))throw Error(G(40));return t._reactRootContainer?(Ps(function(){Vd(null,null,t,!1,function(){t._reactRootContainer=null,t[Kr]=null})}),!0):!1};Wn.unstable_batchedUpdates=Im;Wn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Md(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Vd(t,e,n,!1,r)};Wn.version="18.3.1-next-f1338f8080-20240426";function q1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(q1)}catch(t){console.error(t)}}q1(),q0.exports=Wn;var vo=q0.exports,dv=vo;uf.createRoot=dv.createRoot,uf.hydrateRoot=dv.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ae=(t,e)=>{const n=R.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:c="",children:u,...d},f)=>R.createElement("svg",{ref:f,...zC,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${BC(t)}`,c].join(" "),...d},[...e.map(([p,g])=>R.createElement(p,g)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=ae("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=ae("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=ae("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=ae("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=ae("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=ae("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=ae("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=ae("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=ae("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=ae("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=ae("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=ae("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=ae("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=ae("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=ae("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=ae("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gv=ae("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=ae("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=ae("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=ae("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=ae("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=ae("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=ae("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=ae("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=ae("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),lA=()=>{};var vv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},cA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],c=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},X1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,d=u?t[i+2]:0,f=s>>2,p=(s&3)<<4|c>>4;let g=(c&15)<<2|d>>6,x=d&63;u||(x=64,o||(g=64)),r.push(n[f],n[p],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(J1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],c=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||c==null||d==null||p==null)throw new uA;const g=s<<2|c>>4;if(r.push(g),d!==64){const x=c<<4&240|d>>2;if(r.push(x),p!==64){const C=d<<6&192|p;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dA=function(t){const e=J1(t);return X1.encodeByteArray(e,!0)},Xu=function(t){return dA(t).replace(/\./g,"")},Z1=function(t){try{return X1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=()=>hA().__FIREBASE_DEFAULTS__,pA=()=>{if(typeof process>"u"||typeof vv>"u")return;const t=vv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Z1(t[1]);return e&&JSON.parse(e)},zd=()=>{try{return lA()||fA()||pA()||mA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ew=t=>{var e,n;return(n=(e=zd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},gA=t=>{const e=ew(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},tw=()=>{var t;return(t=zd())==null?void 0:t.config},nw=t=>{var e;return(e=zd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Xu(JSON.stringify(n)),Xu(JSON.stringify(o)),""].join(".")}const il={};function xA(){const t={prod:[],emulator:[]};for(const e of Object.keys(il))il[e]?t.emulator.push(e):t.prod.push(e);return t}function _A(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let xv=!1;function iw(t,e){if(typeof window>"u"||typeof document>"u"||!ea(window.location.host)||il[t]===e||il[t]||xv)return;il[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=xA().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,x){g.setAttribute("width","24"),g.setAttribute("id",x),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{xv=!0,o()},g}function f(g,x){g.setAttribute("id",x),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=_A(r),x=n("text"),C=document.getElementById(x)||document.createElement("span"),j=n("learnmore"),P=document.getElementById(j)||document.createElement("a"),b=n("preprendIcon"),y=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const I=g.element;c(I),f(P,j);const N=d();u(y,b),I.append(y,C,P,N),document.body.appendChild(I)}s?(C.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function EA(){var e;const t=(e=zd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function SA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function CA(){const t=gn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function AA(){return!EA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function TA(){try{return typeof indexedDB=="object"}catch{return!1}}function RA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA="FirebaseError";class ri extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=kA,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tc.prototype.create)}}class tc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?jA(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new ri(i,c,r)}}function jA(t,e){return t.replace(DA,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const DA=/\{\$([^}]+)}/g;function NA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Os(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(_v(s)&&_v(o)){if(!Os(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function _v(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function PA(t,e){const n=new OA(t,e);return n.subscribe.bind(n)}class OA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");LA(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Hh),i.error===void 0&&(i.error=Hh),i.complete===void 0&&(i.complete=Hh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function LA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Hh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(t){return t&&t._delegate?t._delegate:t}class Ls{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new yA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(zA(e))try{this.getOrInitializeService({instanceIdentifier:vs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=vs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vs){return this.instances.has(e)}getOptions(e=vs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=vs){return this.component?this.component.multipleInstances?e:vs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VA(t){return t===vs?void 0:t}function zA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new MA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ae||(Ae={}));const FA={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},UA=Ae.INFO,$A={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},WA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=$A[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nm{constructor(e){this.name=e,this._logLevel=UA,this._logHandler=WA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...e),this._logHandler(this,Ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...e),this._logHandler(this,Ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...e),this._logHandler(this,Ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...e),this._logHandler(this,Ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...e),this._logHandler(this,Ae.ERROR,...e)}}const qA=(t,e)=>e.some(n=>t instanceof n);let wv,Ev;function HA(){return wv||(wv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GA(){return Ev||(Ev=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sw=new WeakMap,ap=new WeakMap,ow=new WeakMap,Gh=new WeakMap,Pm=new WeakMap;function KA(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Bi(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&sw.set(n,t)}).catch(()=>{}),Pm.set(e,t),e}function QA(t){if(ap.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ap.set(t,e)}let lp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ap.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ow.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Bi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function YA(t){lp=t(lp)}function JA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Kh(this),e,...n);return ow.set(r,e.sort?e.sort():[e]),Bi(r)}:GA().includes(t)?function(...e){return t.apply(Kh(this),e),Bi(sw.get(this))}:function(...e){return Bi(t.apply(Kh(this),e))}}function XA(t){return typeof t=="function"?JA(t):(t instanceof IDBTransaction&&QA(t),qA(t,HA())?new Proxy(t,lp):t)}function Bi(t){if(t instanceof IDBRequest)return KA(t);if(Gh.has(t))return Gh.get(t);const e=XA(t);return e!==t&&(Gh.set(t,e),Pm.set(e,t)),e}const Kh=t=>Pm.get(t);function ZA(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),c=Bi(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Bi(o.result),u.oldVersion,u.newVersion,Bi(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const eT=["get","getKey","getAll","getAllKeys","count"],tT=["put","add","delete","clear"],Qh=new Map;function Iv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Qh.get(e))return Qh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=tT.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||eT.includes(n)))return;const s=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),i&&u.done]))[0]};return Qh.set(e,s),s}YA(t=>({...t,get:(e,n,r)=>Iv(e,n)||t.get(e,n,r),has:(e,n)=>!!Iv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(rT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function rT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cp="@firebase/app",bv="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Nm("@firebase/app"),iT="@firebase/app-compat",sT="@firebase/analytics-compat",oT="@firebase/analytics",aT="@firebase/app-check-compat",lT="@firebase/app-check",cT="@firebase/auth",uT="@firebase/auth-compat",dT="@firebase/database",hT="@firebase/data-connect",fT="@firebase/database-compat",pT="@firebase/functions",mT="@firebase/functions-compat",gT="@firebase/installations",yT="@firebase/installations-compat",vT="@firebase/messaging",xT="@firebase/messaging-compat",_T="@firebase/performance",wT="@firebase/performance-compat",ET="@firebase/remote-config",IT="@firebase/remote-config-compat",bT="@firebase/storage",ST="@firebase/storage-compat",CT="@firebase/firestore",AT="@firebase/ai",TT="@firebase/firestore-compat",RT="firebase",kT="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="[DEFAULT]",jT={[cp]:"fire-core",[iT]:"fire-core-compat",[oT]:"fire-analytics",[sT]:"fire-analytics-compat",[lT]:"fire-app-check",[aT]:"fire-app-check-compat",[cT]:"fire-auth",[uT]:"fire-auth-compat",[dT]:"fire-rtdb",[hT]:"fire-data-connect",[fT]:"fire-rtdb-compat",[pT]:"fire-fn",[mT]:"fire-fn-compat",[gT]:"fire-iid",[yT]:"fire-iid-compat",[vT]:"fire-fcm",[xT]:"fire-fcm-compat",[_T]:"fire-perf",[wT]:"fire-perf-compat",[ET]:"fire-rc",[IT]:"fire-rc-compat",[bT]:"fire-gcs",[ST]:"fire-gcs-compat",[CT]:"fire-fst",[TT]:"fire-fst-compat",[AT]:"fire-vertex","fire-js":"fire-js",[RT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu=new Map,DT=new Map,dp=new Map;function Sv(t,e){try{t.container.addComponent(e)}catch(n){Jr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $o(t){const e=t.name;if(dp.has(e))return Jr.debug(`There were multiple attempts to register component ${e}.`),!1;dp.set(e,t);for(const n of Zu.values())Sv(n,t);for(const n of DT.values())Sv(n,t);return!0}function Om(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fi=new tc("app","Firebase",NT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ls("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=kT;function aw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:up,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Fi.create("bad-app-name",{appName:String(i)});if(n||(n=tw()),!n)throw Fi.create("no-options");const s=Zu.get(i);if(s){if(Os(n,s.options)&&Os(r,s.config))return s;throw Fi.create("duplicate-app",{appName:i})}const o=new BA(i);for(const u of dp.values())o.addComponent(u);const c=new PT(n,r,o);return Zu.set(i,c),c}function lw(t=up){const e=Zu.get(t);if(!e&&t===up&&tw())return aw();if(!e)throw Fi.create("no-app",{appName:t});return e}function Ui(t,e,n){let r=jT[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jr.warn(o.join(" "));return}$o(new Ls(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="firebase-heartbeat-database",LT=1,Ol="firebase-heartbeat-store";let Yh=null;function cw(){return Yh||(Yh=ZA(OT,LT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ol)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fi.create("idb-open",{originalErrorMessage:t.message})})),Yh}async function MT(t){try{const n=(await cw()).transaction(Ol),r=await n.objectStore(Ol).get(uw(t));return await n.done,r}catch(e){if(e instanceof ri)Jr.warn(e.message);else{const n=Fi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jr.warn(n.message)}}}async function Cv(t,e){try{const r=(await cw()).transaction(Ol,"readwrite");await r.objectStore(Ol).put(e,uw(t)),await r.done}catch(n){if(n instanceof ri)Jr.warn(n.message);else{const r=Fi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jr.warn(r.message)}}}function uw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=1024,zT=30;class BT{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new UT(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Av();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>zT){const o=$T(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Jr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Av(),{heartbeatsToSend:r,unsentEntries:i}=FT(this._heartbeatsCache.heartbeats),s=Xu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Jr.warn(n),""}}}function Av(){return new Date().toISOString().substring(0,10)}function FT(t,e=VT){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Tv(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Tv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class UT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return TA()?RA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await MT(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Tv(t){return Xu(JSON.stringify({version:2,heartbeats:t})).length}function $T(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t){$o(new Ls("platform-logger",e=>new nT(e),"PRIVATE")),$o(new Ls("heartbeat",e=>new BT(e),"PRIVATE")),Ui(cp,bv,t),Ui(cp,bv,"esm2020"),Ui("fire-js","")}WT("");var qT="firebase",HT="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ui(qT,HT,"app");var Rv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $i,dw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,v){function S(){}S.prototype=v.prototype,_.F=v.prototype,_.prototype=new S,_.prototype.constructor=_,_.D=function(A,k,D){for(var T=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)T[fe-2]=arguments[fe];return v.prototype[k].apply(A,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(_,v,S){S||(S=0);const A=Array(16);if(typeof v=="string")for(var k=0;k<16;++k)A[k]=v.charCodeAt(S++)|v.charCodeAt(S++)<<8|v.charCodeAt(S++)<<16|v.charCodeAt(S++)<<24;else for(k=0;k<16;++k)A[k]=v[S++]|v[S++]<<8|v[S++]<<16|v[S++]<<24;v=_.g[0],S=_.g[1],k=_.g[2];let D=_.g[3],T;T=v+(D^S&(k^D))+A[0]+3614090360&4294967295,v=S+(T<<7&4294967295|T>>>25),T=D+(k^v&(S^k))+A[1]+3905402710&4294967295,D=v+(T<<12&4294967295|T>>>20),T=k+(S^D&(v^S))+A[2]+606105819&4294967295,k=D+(T<<17&4294967295|T>>>15),T=S+(v^k&(D^v))+A[3]+3250441966&4294967295,S=k+(T<<22&4294967295|T>>>10),T=v+(D^S&(k^D))+A[4]+4118548399&4294967295,v=S+(T<<7&4294967295|T>>>25),T=D+(k^v&(S^k))+A[5]+1200080426&4294967295,D=v+(T<<12&4294967295|T>>>20),T=k+(S^D&(v^S))+A[6]+2821735955&4294967295,k=D+(T<<17&4294967295|T>>>15),T=S+(v^k&(D^v))+A[7]+4249261313&4294967295,S=k+(T<<22&4294967295|T>>>10),T=v+(D^S&(k^D))+A[8]+1770035416&4294967295,v=S+(T<<7&4294967295|T>>>25),T=D+(k^v&(S^k))+A[9]+2336552879&4294967295,D=v+(T<<12&4294967295|T>>>20),T=k+(S^D&(v^S))+A[10]+4294925233&4294967295,k=D+(T<<17&4294967295|T>>>15),T=S+(v^k&(D^v))+A[11]+2304563134&4294967295,S=k+(T<<22&4294967295|T>>>10),T=v+(D^S&(k^D))+A[12]+1804603682&4294967295,v=S+(T<<7&4294967295|T>>>25),T=D+(k^v&(S^k))+A[13]+4254626195&4294967295,D=v+(T<<12&4294967295|T>>>20),T=k+(S^D&(v^S))+A[14]+2792965006&4294967295,k=D+(T<<17&4294967295|T>>>15),T=S+(v^k&(D^v))+A[15]+1236535329&4294967295,S=k+(T<<22&4294967295|T>>>10),T=v+(k^D&(S^k))+A[1]+4129170786&4294967295,v=S+(T<<5&4294967295|T>>>27),T=D+(S^k&(v^S))+A[6]+3225465664&4294967295,D=v+(T<<9&4294967295|T>>>23),T=k+(v^S&(D^v))+A[11]+643717713&4294967295,k=D+(T<<14&4294967295|T>>>18),T=S+(D^v&(k^D))+A[0]+3921069994&4294967295,S=k+(T<<20&4294967295|T>>>12),T=v+(k^D&(S^k))+A[5]+3593408605&4294967295,v=S+(T<<5&4294967295|T>>>27),T=D+(S^k&(v^S))+A[10]+38016083&4294967295,D=v+(T<<9&4294967295|T>>>23),T=k+(v^S&(D^v))+A[15]+3634488961&4294967295,k=D+(T<<14&4294967295|T>>>18),T=S+(D^v&(k^D))+A[4]+3889429448&4294967295,S=k+(T<<20&4294967295|T>>>12),T=v+(k^D&(S^k))+A[9]+568446438&4294967295,v=S+(T<<5&4294967295|T>>>27),T=D+(S^k&(v^S))+A[14]+3275163606&4294967295,D=v+(T<<9&4294967295|T>>>23),T=k+(v^S&(D^v))+A[3]+4107603335&4294967295,k=D+(T<<14&4294967295|T>>>18),T=S+(D^v&(k^D))+A[8]+1163531501&4294967295,S=k+(T<<20&4294967295|T>>>12),T=v+(k^D&(S^k))+A[13]+2850285829&4294967295,v=S+(T<<5&4294967295|T>>>27),T=D+(S^k&(v^S))+A[2]+4243563512&4294967295,D=v+(T<<9&4294967295|T>>>23),T=k+(v^S&(D^v))+A[7]+1735328473&4294967295,k=D+(T<<14&4294967295|T>>>18),T=S+(D^v&(k^D))+A[12]+2368359562&4294967295,S=k+(T<<20&4294967295|T>>>12),T=v+(S^k^D)+A[5]+4294588738&4294967295,v=S+(T<<4&4294967295|T>>>28),T=D+(v^S^k)+A[8]+2272392833&4294967295,D=v+(T<<11&4294967295|T>>>21),T=k+(D^v^S)+A[11]+1839030562&4294967295,k=D+(T<<16&4294967295|T>>>16),T=S+(k^D^v)+A[14]+4259657740&4294967295,S=k+(T<<23&4294967295|T>>>9),T=v+(S^k^D)+A[1]+2763975236&4294967295,v=S+(T<<4&4294967295|T>>>28),T=D+(v^S^k)+A[4]+1272893353&4294967295,D=v+(T<<11&4294967295|T>>>21),T=k+(D^v^S)+A[7]+4139469664&4294967295,k=D+(T<<16&4294967295|T>>>16),T=S+(k^D^v)+A[10]+3200236656&4294967295,S=k+(T<<23&4294967295|T>>>9),T=v+(S^k^D)+A[13]+681279174&4294967295,v=S+(T<<4&4294967295|T>>>28),T=D+(v^S^k)+A[0]+3936430074&4294967295,D=v+(T<<11&4294967295|T>>>21),T=k+(D^v^S)+A[3]+3572445317&4294967295,k=D+(T<<16&4294967295|T>>>16),T=S+(k^D^v)+A[6]+76029189&4294967295,S=k+(T<<23&4294967295|T>>>9),T=v+(S^k^D)+A[9]+3654602809&4294967295,v=S+(T<<4&4294967295|T>>>28),T=D+(v^S^k)+A[12]+3873151461&4294967295,D=v+(T<<11&4294967295|T>>>21),T=k+(D^v^S)+A[15]+530742520&4294967295,k=D+(T<<16&4294967295|T>>>16),T=S+(k^D^v)+A[2]+3299628645&4294967295,S=k+(T<<23&4294967295|T>>>9),T=v+(k^(S|~D))+A[0]+4096336452&4294967295,v=S+(T<<6&4294967295|T>>>26),T=D+(S^(v|~k))+A[7]+1126891415&4294967295,D=v+(T<<10&4294967295|T>>>22),T=k+(v^(D|~S))+A[14]+2878612391&4294967295,k=D+(T<<15&4294967295|T>>>17),T=S+(D^(k|~v))+A[5]+4237533241&4294967295,S=k+(T<<21&4294967295|T>>>11),T=v+(k^(S|~D))+A[12]+1700485571&4294967295,v=S+(T<<6&4294967295|T>>>26),T=D+(S^(v|~k))+A[3]+2399980690&4294967295,D=v+(T<<10&4294967295|T>>>22),T=k+(v^(D|~S))+A[10]+4293915773&4294967295,k=D+(T<<15&4294967295|T>>>17),T=S+(D^(k|~v))+A[1]+2240044497&4294967295,S=k+(T<<21&4294967295|T>>>11),T=v+(k^(S|~D))+A[8]+1873313359&4294967295,v=S+(T<<6&4294967295|T>>>26),T=D+(S^(v|~k))+A[15]+4264355552&4294967295,D=v+(T<<10&4294967295|T>>>22),T=k+(v^(D|~S))+A[6]+2734768916&4294967295,k=D+(T<<15&4294967295|T>>>17),T=S+(D^(k|~v))+A[13]+1309151649&4294967295,S=k+(T<<21&4294967295|T>>>11),T=v+(k^(S|~D))+A[4]+4149444226&4294967295,v=S+(T<<6&4294967295|T>>>26),T=D+(S^(v|~k))+A[11]+3174756917&4294967295,D=v+(T<<10&4294967295|T>>>22),T=k+(v^(D|~S))+A[2]+718787259&4294967295,k=D+(T<<15&4294967295|T>>>17),T=S+(D^(k|~v))+A[9]+3951481745&4294967295,_.g[0]=_.g[0]+v&4294967295,_.g[1]=_.g[1]+(k+(T<<21&4294967295|T>>>11))&4294967295,_.g[2]=_.g[2]+k&4294967295,_.g[3]=_.g[3]+D&4294967295}r.prototype.v=function(_,v){v===void 0&&(v=_.length);const S=v-this.blockSize,A=this.C;let k=this.h,D=0;for(;D<v;){if(k==0)for(;D<=S;)i(this,_,D),D+=this.blockSize;if(typeof _=="string"){for(;D<v;)if(A[k++]=_.charCodeAt(D++),k==this.blockSize){i(this,A),k=0;break}}else for(;D<v;)if(A[k++]=_[D++],k==this.blockSize){i(this,A),k=0;break}}this.h=k,this.o+=v},r.prototype.A=function(){var _=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);_[0]=128;for(var v=1;v<_.length-8;++v)_[v]=0;v=this.o*8;for(var S=_.length-8;S<_.length;++S)_[S]=v&255,v/=256;for(this.v(_),_=Array(16),v=0,S=0;S<4;++S)for(let A=0;A<32;A+=8)_[v++]=this.g[S]>>>A&255;return _};function s(_,v){var S=c;return Object.prototype.hasOwnProperty.call(S,_)?S[_]:S[_]=v(_)}function o(_,v){this.h=v;const S=[];let A=!0;for(let k=_.length-1;k>=0;k--){const D=_[k]|0;A&&D==v||(S[k]=D,A=!1)}this.g=S}var c={};function u(_){return-128<=_&&_<128?s(_,function(v){return new o([v|0],v<0?-1:0)}):new o([_|0],_<0?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return p;if(_<0)return P(d(-_));const v=[];let S=1;for(let A=0;_>=S;A++)v[A]=_/S|0,S*=4294967296;return new o(v,0)}function f(_,v){if(_.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(_.charAt(0)=="-")return P(f(_.substring(1),v));if(_.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(v,8));let A=p;for(let D=0;D<_.length;D+=8){var k=Math.min(8,_.length-D);const T=parseInt(_.substring(D,D+k),v);k<8?(k=d(Math.pow(v,k)),A=A.j(k).add(d(T))):(A=A.j(S),A=A.add(d(T)))}return A}var p=u(0),g=u(1),x=u(16777216);t=o.prototype,t.m=function(){if(j(this))return-P(this).m();let _=0,v=1;for(let S=0;S<this.g.length;S++){const A=this.i(S);_+=(A>=0?A:4294967296+A)*v,v*=4294967296}return _},t.toString=function(_){if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(C(this))return"0";if(j(this))return"-"+P(this).toString(_);const v=d(Math.pow(_,6));var S=this;let A="";for(;;){const k=N(S,v).g;S=b(S,k.j(v));let D=((S.g.length>0?S.g[0]:S.h)>>>0).toString(_);if(S=k,C(S))return D+A;for(;D.length<6;)D="0"+D;A=D+A}},t.i=function(_){return _<0?0:_<this.g.length?this.g[_]:this.h};function C(_){if(_.h!=0)return!1;for(let v=0;v<_.g.length;v++)if(_.g[v]!=0)return!1;return!0}function j(_){return _.h==-1}t.l=function(_){return _=b(this,_),j(_)?-1:C(_)?0:1};function P(_){const v=_.g.length,S=[];for(let A=0;A<v;A++)S[A]=~_.g[A];return new o(S,~_.h).add(g)}t.abs=function(){return j(this)?P(this):this},t.add=function(_){const v=Math.max(this.g.length,_.g.length),S=[];let A=0;for(let k=0;k<=v;k++){let D=A+(this.i(k)&65535)+(_.i(k)&65535),T=(D>>>16)+(this.i(k)>>>16)+(_.i(k)>>>16);A=T>>>16,D&=65535,T&=65535,S[k]=T<<16|D}return new o(S,S[S.length-1]&-2147483648?-1:0)};function b(_,v){return _.add(P(v))}t.j=function(_){if(C(this)||C(_))return p;if(j(this))return j(_)?P(this).j(P(_)):P(P(this).j(_));if(j(_))return P(this.j(P(_)));if(this.l(x)<0&&_.l(x)<0)return d(this.m()*_.m());const v=this.g.length+_.g.length,S=[];for(var A=0;A<2*v;A++)S[A]=0;for(A=0;A<this.g.length;A++)for(let k=0;k<_.g.length;k++){const D=this.i(A)>>>16,T=this.i(A)&65535,fe=_.i(k)>>>16,Qe=_.i(k)&65535;S[2*A+2*k]+=T*Qe,y(S,2*A+2*k),S[2*A+2*k+1]+=D*Qe,y(S,2*A+2*k+1),S[2*A+2*k+1]+=T*fe,y(S,2*A+2*k+1),S[2*A+2*k+2]+=D*fe,y(S,2*A+2*k+2)}for(_=0;_<v;_++)S[_]=S[2*_+1]<<16|S[2*_];for(_=v;_<2*v;_++)S[_]=0;return new o(S,0)};function y(_,v){for(;(_[v]&65535)!=_[v];)_[v+1]+=_[v]>>>16,_[v]&=65535,v++}function I(_,v){this.g=_,this.h=v}function N(_,v){if(C(v))throw Error("division by zero");if(C(_))return new I(p,p);if(j(_))return v=N(P(_),v),new I(P(v.g),P(v.h));if(j(v))return v=N(_,P(v)),new I(P(v.g),v.h);if(_.g.length>30){if(j(_)||j(v))throw Error("slowDivide_ only works with positive integers.");for(var S=g,A=v;A.l(_)<=0;)S=M(S),A=M(A);var k=B(S,1),D=B(A,1);for(A=B(A,2),S=B(S,2);!C(A);){var T=D.add(A);T.l(_)<=0&&(k=k.add(S),D=T),A=B(A,1),S=B(S,1)}return v=b(_,k.j(v)),new I(k,v)}for(k=p;_.l(v)>=0;){for(S=Math.max(1,Math.floor(_.m()/v.m())),A=Math.ceil(Math.log(S)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),D=d(S),T=D.j(v);j(T)||T.l(_)>0;)S-=A,D=d(S),T=D.j(v);C(D)&&(D=g),k=k.add(D),_=b(_,T)}return new I(k,_)}t.B=function(_){return N(this,_).h},t.and=function(_){const v=Math.max(this.g.length,_.g.length),S=[];for(let A=0;A<v;A++)S[A]=this.i(A)&_.i(A);return new o(S,this.h&_.h)},t.or=function(_){const v=Math.max(this.g.length,_.g.length),S=[];for(let A=0;A<v;A++)S[A]=this.i(A)|_.i(A);return new o(S,this.h|_.h)},t.xor=function(_){const v=Math.max(this.g.length,_.g.length),S=[];for(let A=0;A<v;A++)S[A]=this.i(A)^_.i(A);return new o(S,this.h^_.h)};function M(_){const v=_.g.length+1,S=[];for(let A=0;A<v;A++)S[A]=_.i(A)<<1|_.i(A-1)>>>31;return new o(S,_.h)}function B(_,v){const S=v>>5;v%=32;const A=_.g.length-S,k=[];for(let D=0;D<A;D++)k[D]=v>0?_.i(D+S)>>>v|_.i(D+S+1)<<32-v:_.i(D+S);return new o(k,_.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,dw=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,$i=o}).apply(typeof Rv<"u"?Rv:typeof self<"u"?self:typeof window<"u"?window:{});var Hc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hw,Wa,fw,fu,hp,pw,mw,gw;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hc=="object"&&Hc];for(var h=0;h<l.length;++h){var m=l[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function i(l,h){if(h)e:{var m=r;l=l.split(".");for(var E=0;E<l.length-1;E++){var L=l[E];if(!(L in m))break e;m=m[L]}l=l[l.length-1],E=m[l],h=h(E),h!=E&&h!=null&&e(m,l,{configurable:!0,writable:!0,value:h})}}i("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(l){return l||function(h){var m=[],E;for(E in h)Object.prototype.hasOwnProperty.call(h,E)&&m.push([E,h[E]]);return m}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function c(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function u(l,h,m){return l.call.apply(l.bind,arguments)}function d(l,h,m){return d=u,d.apply(null,arguments)}function f(l,h){var m=Array.prototype.slice.call(arguments,1);return function(){var E=m.slice();return E.push.apply(E,arguments),l.apply(this,E)}}function p(l,h){function m(){}m.prototype=h.prototype,l.Z=h.prototype,l.prototype=new m,l.prototype.constructor=l,l.Ob=function(E,L,z){for(var J=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)J[Ee-2]=arguments[Ee];return h.prototype[L].apply(E,J)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function x(l){const h=l.length;if(h>0){const m=Array(h);for(let E=0;E<h;E++)m[E]=l[E];return m}return[]}function C(l,h){for(let E=1;E<arguments.length;E++){const L=arguments[E];var m=typeof L;if(m=m!="object"?m:L?Array.isArray(L)?"array":m:"null",m=="array"||m=="object"&&typeof L.length=="number"){m=l.length||0;const z=L.length||0;l.length=m+z;for(let J=0;J<z;J++)l[m+J]=L[J]}else l.push(L)}}class j{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return this.h>0?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function P(l){o.setTimeout(()=>{throw l},0)}function b(){var l=_;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class y{constructor(){this.h=this.g=null}add(h,m){const E=I.get();E.set(h,m),this.h?this.h.next=E:this.g=E,this.h=E}}var I=new j(()=>new N,l=>l.reset());class N{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let M,B=!1,_=new y,v=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(S)}};function S(){for(var l;l=b();){try{l.h.call(l.g)}catch(m){P(m)}var h=I;h.j(l),h.h<100&&(h.h++,l.next=h.g,h.g=l)}B=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};o.addEventListener("test",m,h),o.removeEventListener("test",m,h)}catch{}return l}();function T(l){return/^[\s\xa0]*$/.test(l)}function fe(l,h){k.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,h)}p(fe,k),fe.prototype.init=function(l,h){const m=this.type=l.type,E=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget,h||(m=="mouseover"?h=l.fromElement:m=="mouseout"&&(h=l.toElement)),this.relatedTarget=h,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&fe.Z.h.call(this)},fe.prototype.h=function(){fe.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Qe="closure_listenable_"+(Math.random()*1e6|0),He=0;function Ne(l,h,m,E,L){this.listener=l,this.proxy=null,this.src=h,this.type=m,this.capture=!!E,this.ha=L,this.key=++He,this.da=this.fa=!1}function K(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function O(l,h,m){for(const E in l)h.call(m,l[E],E,l)}function Q(l,h){for(const m in l)h.call(void 0,l[m],m,l)}function xe(l){const h={};for(const m in l)h[m]=l[m];return h}const ue="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ze(l,h){let m,E;for(let L=1;L<arguments.length;L++){E=arguments[L];for(m in E)l[m]=E[m];for(let z=0;z<ue.length;z++)m=ue[z],Object.prototype.hasOwnProperty.call(E,m)&&(l[m]=E[m])}}function $e(l){this.src=l,this.g={},this.h=0}$e.prototype.add=function(l,h,m,E,L){const z=l.toString();l=this.g[z],l||(l=this.g[z]=[],this.h++);const J=ze(l,h,E,L);return J>-1?(h=l[J],m||(h.fa=!1)):(h=new Ne(h,this.src,z,!!E,L),h.fa=m,l.push(h)),h};function kt(l,h){const m=h.type;if(m in l.g){var E=l.g[m],L=Array.prototype.indexOf.call(E,h,void 0),z;(z=L>=0)&&Array.prototype.splice.call(E,L,1),z&&(K(h),l.g[m].length==0&&(delete l.g[m],l.h--))}}function ze(l,h,m,E){for(let L=0;L<l.length;++L){const z=l[L];if(!z.da&&z.listener==h&&z.capture==!!m&&z.ha==E)return L}return-1}var it="closure_lm_"+(Math.random()*1e6|0),Le={};function st(l,h,m,E,L){if(Array.isArray(h)){for(let z=0;z<h.length;z++)st(l,h[z],m,E,L);return null}return m=re(m),l&&l[Qe]?l.J(h,m,c(E)?!!E.capture:!1,L):H(l,h,m,!1,E,L)}function H(l,h,m,E,L,z){if(!h)throw Error("Invalid event type");const J=c(L)?!!L.capture:!!L;let Ee=we(l);if(Ee||(l[it]=Ee=new $e(l)),m=Ee.add(h,m,E,J,z),m.proxy)return m;if(E=Ie(),m.proxy=E,E.src=l,E.listener=m,l.addEventListener)D||(L=J),L===void 0&&(L=!1),l.addEventListener(h.toString(),E,L);else if(l.attachEvent)l.attachEvent(We(h.toString()),E);else if(l.addListener&&l.removeListener)l.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Ie(){function l(m){return h.call(l.src,l.listener,m)}const h=Ce;return l}function de(l,h,m,E,L){if(Array.isArray(h))for(var z=0;z<h.length;z++)de(l,h[z],m,E,L);else E=c(E)?!!E.capture:!!E,m=re(m),l&&l[Qe]?(l=l.i,z=String(h).toString(),z in l.g&&(h=l.g[z],m=ze(h,m,E,L),m>-1&&(K(h[m]),Array.prototype.splice.call(h,m,1),h.length==0&&(delete l.g[z],l.h--)))):l&&(l=we(l))&&(h=l.g[h.toString()],l=-1,h&&(l=ze(h,m,E,L)),(m=l>-1?h[l]:null)&&et(m))}function et(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Qe])kt(h.i,l);else{var m=l.type,E=l.proxy;h.removeEventListener?h.removeEventListener(m,E,l.capture):h.detachEvent?h.detachEvent(We(m),E):h.addListener&&h.removeListener&&h.removeListener(E),(m=we(h))?(kt(m,l),m.h==0&&(m.src=null,h[it]=null)):K(l)}}}function We(l){return l in Le?Le[l]:Le[l]="on"+l}function Ce(l,h){if(l.da)l=!0;else{h=new fe(h,this);const m=l.listener,E=l.ha||l.src;l.fa&&et(l),l=m.call(E,h)}return l}function we(l){return l=l[it],l instanceof $e?l:null}var F="__closure_events_fn_"+(Math.random()*1e9>>>0);function re(l){return typeof l=="function"?l:(l[F]||(l[F]=function(h){return l.handleEvent(h)}),l[F])}function ge(){A.call(this),this.i=new $e(this),this.M=this,this.G=null}p(ge,A),ge.prototype[Qe]=!0,ge.prototype.removeEventListener=function(l,h,m,E){de(this,l,h,m,E)};function be(l,h){var m,E=l.G;if(E)for(m=[];E;E=E.G)m.push(E);if(l=l.M,E=h.type||h,typeof h=="string")h=new k(h,l);else if(h instanceof k)h.target=h.target||l;else{var L=h;h=new k(E,l),Ze(h,L)}L=!0;let z,J;if(m)for(J=m.length-1;J>=0;J--)z=h.g=m[J],L=$(z,E,!0,h)&&L;if(z=h.g=l,L=$(z,E,!0,h)&&L,L=$(z,E,!1,h)&&L,m)for(J=0;J<m.length;J++)z=h.g=m[J],L=$(z,E,!1,h)&&L}ge.prototype.N=function(){if(ge.Z.N.call(this),this.i){var l=this.i;for(const h in l.g){const m=l.g[h];for(let E=0;E<m.length;E++)K(m[E]);delete l.g[h],l.h--}}this.G=null},ge.prototype.J=function(l,h,m,E){return this.i.add(String(l),h,!1,m,E)},ge.prototype.K=function(l,h,m,E){return this.i.add(String(l),h,!0,m,E)};function $(l,h,m,E){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();let L=!0;for(let z=0;z<h.length;++z){const J=h[z];if(J&&!J.da&&J.capture==m){const Ee=J.listener,Dt=J.ha||J.src;J.fa&&kt(l.i,J),L=Ee.call(Dt,E)!==!1&&L}}return L&&!E.defaultPrevented}function le(l,h){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(h)>2147483647?-1:o.setTimeout(l,h||0)}function _e(l){l.g=le(()=>{l.g=null,l.i&&(l.i=!1,_e(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class W extends A{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:_e(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oe(l){A.call(this),this.h=l,this.g={}}p(oe,A);var ce=[];function wt(l){O(l.g,function(h,m){this.g.hasOwnProperty(m)&&et(h)},l),l.g={}}oe.prototype.N=function(){oe.Z.N.call(this),wt(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var en=o.JSON.stringify,mt=o.JSON.parse,gt=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function Ve(){}function at(){}var Ln={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ii(){k.call(this,"d")}p(ii,k);function Hn(){k.call(this,"c")}p(Hn,k);var Sn={},si=null;function _r(){return si=si||new ge}Sn.Ia="serverreachability";function qs(l){k.call(this,Sn.Ia,l)}p(qs,k);function rr(l){const h=_r();be(h,new qs(h))}Sn.STAT_EVENT="statevent";function oi(l,h){k.call(this,Sn.STAT_EVENT,l),this.stat=h}p(oi,k);function ke(l){const h=_r();be(h,new oi(h,l))}Sn.Ja="timingevent";function Et(l,h){k.call(this,Sn.Ja,l),this.size=h}p(Et,k);function yt(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},h)}function tn(){this.g=!0}tn.prototype.ua=function(){this.g=!1};function nn(l,h,m,E,L,z){l.info(function(){if(l.g)if(z){var J="",Ee=z.split("&");for(let Ge=0;Ge<Ee.length;Ge++){var Dt=Ee[Ge].split("=");if(Dt.length>1){const Vt=Dt[0];Dt=Dt[1];const Ir=Vt.split("_");J=Ir.length>=2&&Ir[1]=="type"?J+(Vt+"="+Dt+"&"):J+(Vt+"=redacted&")}}}else J=null;else J=z;return"XMLHTTP REQ ("+E+") [attempt "+L+"]: "+h+`
`+m+`
`+J})}function Wt(l,h,m,E,L,z,J){l.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+L+"]: "+h+`
`+m+`
`+z+" "+J})}function jt(l,h,m,E){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+ht(l,m)+(E?" "+E:"")})}function Mn(l,h){l.info(function(){return"TIMEOUT: "+h})}tn.prototype.info=function(){};function ht(l,h){if(!l.g)return h;if(!h)return null;try{const z=JSON.parse(h);if(z){for(l=0;l<z.length;l++)if(Array.isArray(z[l])){var m=z[l];if(!(m.length<2)){var E=m[1];if(Array.isArray(E)&&!(E.length<1)){var L=E[0];if(L!="noop"&&L!="stop"&&L!="close")for(let J=1;J<E.length;J++)E[J]=""}}}}return en(z)}catch{return h}}var yn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},qt;function ir(){}p(ir,Ve),ir.prototype.g=function(){return new XMLHttpRequest},qt=new ir;function vn(l){return encodeURIComponent(String(l))}function Cn(l){var h=1;l=l.split(":");const m=[];for(;h>0&&l.length;)m.push(l.shift()),h--;return l.length&&m.push(l.join(":")),m}function sn(l,h,m,E){this.j=l,this.i=h,this.l=m,this.S=E||1,this.V=new oe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ai}function ai(){this.i=null,this.g="",this.h=!1}var xc={},da={};function sr(l,h,m){l.M=1,l.A=Ks(on(h)),l.u=m,l.R=!0,_c(l,null)}function _c(l,h){l.F=Date.now(),ls(l),l.B=on(l.A);var m=l.B,E=l.S;Array.isArray(E)||(E=[String(E)]),Og(m.i,"t",E),l.C=0,m=l.j.L,l.h=new ai,l.g=Zg(l.j,m?h:null,!l.u),l.P>0&&(l.O=new W(d(l.Y,l,l.g),l.P)),h=l.V,m=l.g,E=l.ba;var L="readystatechange";Array.isArray(L)||(L&&(ce[0]=L.toString()),L=ce);for(let z=0;z<L.length;z++){const J=st(m,L[z],E||h.handleEvent,!1,h.h||h);if(!J)break;h.g[J.key]=J}h=l.J?xe(l.J):{},l.u?(l.v||(l.v="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,h)):(l.v="GET",l.g.ea(l.B,l.v,null,h)),rr(),nn(l.i,l.v,l.B,l.l,l.S,l.u)}sn.prototype.ba=function(l){l=l.target;const h=this.O;h&&ui(l)==3?h.j():this.Y(l)},sn.prototype.Y=function(l){try{if(l==this.g)e:{const Ee=ui(this.g),Dt=this.g.ya(),Ge=this.g.ca();if(!(Ee<3)&&(Ee!=3||this.g&&(this.h.h||this.g.la()||Ug(this.g)))){this.K||Ee!=4||Dt==7||(Dt==8||Ge<=0?rr(3):rr(2)),Hs(this);var h=this.g.ca();this.X=h;var m=ha(this);if(this.o=h==200,Wt(this.i,this.v,this.B,this.l,this.S,Ee,h),this.o){if(this.U&&!this.L){t:{if(this.g){var E,L=this.g;if((E=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(E)){var z=E;break t}}z=null}if(l=z)jt(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gs(this,l);else{this.o=!1,this.m=3,ke(12),Mr(this),cs(this);break e}}if(this.R){l=!0;let Vt;for(;!this.K&&this.C<m.length;)if(Vt=fa(this,m),Vt==da){Ee==4&&(this.m=4,ke(14),l=!1),jt(this.i,this.l,null,"[Incomplete Response]");break}else if(Vt==xc){this.m=4,ke(15),jt(this.i,this.l,m,"[Invalid Chunk]"),l=!1;break}else jt(this.i,this.l,Vt,null),Gs(this,Vt);if(wr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ee!=4||m.length!=0||this.h.h||(this.m=1,ke(16),l=!1),this.o=this.o&&l,!l)jt(this.i,this.l,m,"[Invalid Chunked Response]"),Mr(this),cs(this);else if(m.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+m.length),yh(J),J.P=!0,ke(11))}}else jt(this.i,this.l,m,null),Gs(this,m);Ee==4&&Mr(this),this.o&&!this.K&&(Ee==4?Qg(this.j,this):(this.o=!1,ls(this)))}else db(this.g),h==400&&m.indexOf("Unknown SID")>0?(this.m=3,ke(12)):(this.m=0,ke(13)),Mr(this),cs(this)}}}catch{}finally{}};function ha(l){if(!wr(l))return l.g.la();const h=Ug(l.g);if(h==="")return"";let m="";const E=h.length,L=ui(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Mr(l),cs(l),"";l.h.i=new o.TextDecoder}for(let z=0;z<E;z++)l.h.h=!0,m+=l.h.i.decode(h[z],{stream:!(L&&z==E-1)});return h.length=0,l.h.g+=m,l.C=0,l.h.g}function wr(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function fa(l,h){var m=l.C,E=h.indexOf(`
`,m);return E==-1?da:(m=Number(h.substring(m,E)),isNaN(m)?xc:(E+=1,E+m>h.length?da:(h=h.slice(E,E+m),l.C=E+m,h)))}sn.prototype.cancel=function(){this.K=!0,Mr(this)};function ls(l){l.T=Date.now()+l.H,pa(l,l.H)}function pa(l,h){if(l.D!=null)throw Error("WatchDog timer not null");l.D=yt(d(l.aa,l),h)}function Hs(l){l.D&&(o.clearTimeout(l.D),l.D=null)}sn.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(Mn(this.i,this.B),this.M!=2&&(rr(),ke(17)),Mr(this),this.m=2,cs(this)):pa(this,this.T-l)};function cs(l){l.j.I==0||l.K||Qg(l.j,l)}function Mr(l){Hs(l);var h=l.O;h&&typeof h.dispose=="function"&&h.dispose(),l.O=null,wt(l.V),l.g&&(h=l.g,l.g=null,h.abort(),h.dispose())}function Gs(l,h){try{var m=l.j;if(m.I!=0&&(m.g==l||V(m.h,l))){if(!l.L&&V(m.h,l)&&m.I==3){try{var E=m.Ba.g.parse(h)}catch{E=null}if(Array.isArray(E)&&E.length==3){var L=E;if(L[0]==0){e:if(!m.v){if(m.g)if(m.g.F+3e3<l.F)Cc(m),bc(m);else break e;gh(m),ke(18)}}else m.xa=L[1],0<m.xa-m.K&&L[2]<37500&&m.F&&m.A==0&&!m.C&&(m.C=yt(d(m.Va,m),6e3));w(m.h)<=1&&m.ta&&(m.ta=void 0)}else fs(m,11)}else if((l.L||m.g==l)&&Cc(m),!T(h))for(L=m.Ba.g.parse(h),h=0;h<L.length;h++){let Ge=L[h];const Vt=Ge[0];if(!(Vt<=m.K))if(m.K=Vt,Ge=Ge[1],m.I==2)if(Ge[0]=="c"){m.M=Ge[1],m.ba=Ge[2];const Ir=Ge[3];Ir!=null&&(m.ka=Ir,m.j.info("VER="+m.ka));const ps=Ge[4];ps!=null&&(m.za=ps,m.j.info("SVER="+m.za));const di=Ge[5];di!=null&&typeof di=="number"&&di>0&&(E=1.5*di,m.O=E,m.j.info("backChannelRequestTimeoutMs_="+E)),E=m;const hi=l.g;if(hi){const Tc=hi.g?hi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tc){var z=E.h;z.g||Tc.indexOf("spdy")==-1&&Tc.indexOf("quic")==-1&&Tc.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(Y(z,z.h),z.h=null))}if(E.G){const vh=hi.g?hi.g.getResponseHeader("X-HTTP-Session-Id"):null;vh&&(E.wa=vh,Be(E.J,E.G,vh))}}m.I=3,m.l&&m.l.ra(),m.aa&&(m.T=Date.now()-l.F,m.j.info("Handshake RTT: "+m.T+"ms")),E=m;var J=l;if(E.na=Xg(E,E.L?E.ba:null,E.W),J.L){ne(E.h,J);var Ee=J,Dt=E.O;Dt&&(Ee.H=Dt),Ee.D&&(Hs(Ee),ls(Ee)),E.g=J}else Gg(E);m.i.length>0&&Sc(m)}else Ge[0]!="stop"&&Ge[0]!="close"||fs(m,7);else m.I==3&&(Ge[0]=="stop"||Ge[0]=="close"?Ge[0]=="stop"?fs(m,7):mh(m):Ge[0]!="noop"&&m.l&&m.l.qa(Ge),m.A=0)}}rr(4)}catch{}}var wc=class{constructor(l,h){this.g=l,this.map=h}};function ma(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ga(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function w(l){return l.h?1:l.g?l.g.size:0}function V(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Y(l,h){l.g?l.g.add(h):l.h=h}function ne(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}ma.prototype.cancel=function(){if(this.i=ie(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ie(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const m of l.g.values())h=h.concat(m.G);return h}return x(l.i)}var Me=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function us(l,h){if(l){l=l.split("&");for(let m=0;m<l.length;m++){const E=l[m].indexOf("=");let L,z=null;E>=0?(L=l[m].substring(0,E),z=l[m].substring(E+1)):L=l[m],h(L,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function Pe(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let h;l instanceof Pe?(this.l=l.l,An(this,l.j),this.o=l.o,this.g=l.g,Er(this,l.u),this.h=l.h,li(this,Lg(l.i)),this.m=l.m):l&&(h=String(l).match(Me))?(this.l=!1,An(this,h[1]||"",!0),this.o=ds(h[2]||""),this.g=ds(h[3]||"",!0),Er(this,h[4]),this.h=ds(h[5]||"",!0),li(this,h[6]||"",!0),this.m=ds(h[7]||"")):(this.l=!1,this.i=new va(null,this.l))}Pe.prototype.toString=function(){const l=[];var h=this.j;h&&l.push(ya(h,jg,!0),":");var m=this.g;return(m||h=="file")&&(l.push("//"),(h=this.o)&&l.push(ya(h,jg,!0),"@"),l.push(vn(m).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.u,m!=null&&l.push(":",String(m))),(m=this.h)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(ya(m,m.charAt(0)=="/"?nb:tb,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",ya(m,ib)),l.join("")},Pe.prototype.resolve=function(l){const h=on(this);let m=!!l.j;m?An(h,l.j):m=!!l.o,m?h.o=l.o:m=!!l.g,m?h.g=l.g:m=l.u!=null;var E=l.h;if(m)Er(h,l.u);else if(m=!!l.h){if(E.charAt(0)!="/")if(this.g&&!this.h)E="/"+E;else{var L=h.h.lastIndexOf("/");L!=-1&&(E=h.h.slice(0,L+1)+E)}if(L=E,L==".."||L==".")E="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){E=L.lastIndexOf("/",0)==0,L=L.split("/");const z=[];for(let J=0;J<L.length;){const Ee=L[J++];Ee=="."?E&&J==L.length&&z.push(""):Ee==".."?((z.length>1||z.length==1&&z[0]!="")&&z.pop(),E&&J==L.length&&z.push("")):(z.push(Ee),E=!0)}E=z.join("/")}else E=L}return m?h.h=E:m=l.i.toString()!=="",m?li(h,Lg(l.i)):m=!!l.m,m&&(h.m=l.m),h};function on(l){return new Pe(l)}function An(l,h,m){l.j=m?ds(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Er(l,h){if(h){if(h=Number(h),isNaN(h)||h<0)throw Error("Bad port number "+h);l.u=h}else l.u=null}function li(l,h,m){h instanceof va?(l.i=h,sb(l.i,l.l)):(m||(h=ya(h,rb)),l.i=new va(h,l.l))}function Be(l,h,m){l.i.set(h,m)}function Ks(l){return Be(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ds(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ya(l,h,m){return typeof l=="string"?(l=encodeURI(l).replace(h,eb),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function eb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var jg=/[#\/\?@]/g,tb=/[#\?:]/g,nb=/[#\?]/g,rb=/[#\?@]/g,ib=/#/g;function va(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function hs(l){l.g||(l.g=new Map,l.h=0,l.i&&us(l.i,function(h,m){l.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=va.prototype,t.add=function(l,h){hs(this),this.i=null,l=Qs(this,l);let m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(h),this.h+=1,this};function Dg(l,h){hs(l),h=Qs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Ng(l,h){return hs(l),h=Qs(l,h),l.g.has(h)}t.forEach=function(l,h){hs(this),this.g.forEach(function(m,E){m.forEach(function(L){l.call(h,L,E,this)},this)},this)};function Pg(l,h){hs(l);let m=[];if(typeof h=="string")Ng(l,h)&&(m=m.concat(l.g.get(Qs(l,h))));else for(l=Array.from(l.g.values()),h=0;h<l.length;h++)m=m.concat(l[h]);return m}t.set=function(l,h){return hs(this),this.i=null,l=Qs(this,l),Ng(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=Pg(this,l),l.length>0?String(l[0]):h):h};function Og(l,h,m){Dg(l,h),m.length>0&&(l.i=null,l.g.set(Qs(l,h),x(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(let E=0;E<h.length;E++){var m=h[E];const L=vn(m);m=Pg(this,m);for(let z=0;z<m.length;z++){let J=L;m[z]!==""&&(J+="="+vn(m[z])),l.push(J)}}return this.i=l.join("&")};function Lg(l){const h=new va;return h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),h}function Qs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function sb(l,h){h&&!l.j&&(hs(l),l.i=null,l.g.forEach(function(m,E){const L=E.toLowerCase();E!=L&&(Dg(this,E),Og(this,L,m))},l)),l.j=h}function ob(l,h){const m=new tn;if(o.Image){const E=new Image;E.onload=f(ci,m,"TestLoadImage: loaded",!0,h,E),E.onerror=f(ci,m,"TestLoadImage: error",!1,h,E),E.onabort=f(ci,m,"TestLoadImage: abort",!1,h,E),E.ontimeout=f(ci,m,"TestLoadImage: timeout",!1,h,E),o.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=l}else h(!1)}function ab(l,h){const m=new tn,E=new AbortController,L=setTimeout(()=>{E.abort(),ci(m,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:E.signal}).then(z=>{clearTimeout(L),z.ok?ci(m,"TestPingServer: ok",!0,h):ci(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(L),ci(m,"TestPingServer: error",!1,h)})}function ci(l,h,m,E,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),E(m)}catch{}}function lb(){this.g=new gt}function fh(l){this.i=l.Sb||null,this.h=l.ab||!1}p(fh,Ve),fh.prototype.g=function(){return new Ec(this.i,this.h)};function Ec(l,h){ge.call(this),this.H=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Ec,ge),t=Ec.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=h,this.readyState=1,_a(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const h={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(h.body=l),(this.H||o).fetch(new Request(this.D,h)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,xa(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,_a(this)),this.g&&(this.readyState=3,_a(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Mg(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Mg(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.B.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?xa(this):_a(this),this.readyState==3&&Mg(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,xa(this))},t.Na=function(l){this.g&&(this.response=l,xa(this))},t.ga=function(){this.g&&xa(this)};function xa(l){l.readyState=4,l.l=null,l.j=null,l.B=null,_a(l)}t.setRequestHeader=function(l,h){this.A.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=h.next();return l.join(`\r
`)};function _a(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Ec.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Vg(l){let h="";return O(l,function(m,E){h+=E,h+=":",h+=m,h+=`\r
`}),h}function ph(l,h,m){e:{for(E in m){var E=!1;break e}E=!0}E||(m=Vg(m),typeof l=="string"?m!=null&&vn(m):Be(l,h,m))}function ft(l){ge.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(ft,ge);var cb=/^https?$/i,ub=["POST","PUT"];t=ft.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,h,m,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():qt.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(z){zg(this,z);return}if(l=m||"",m=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var L in E)m.set(L,E[L]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const z of E.keys())m.set(z,E.get(z));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(m.keys()).find(z=>z.toLowerCase()=="content-type"),L=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(ub,h,void 0)>=0)||E||L||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,J]of m)this.g.setRequestHeader(z,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(z){zg(this,z)}};function zg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.o=5,Bg(l),Ic(l)}function Bg(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,be(this,"complete"),be(this,"abort"),Ic(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ic(this,!0)),ft.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Fg(this):this.Xa())},t.Xa=function(){Fg(this)};function Fg(l){if(l.h&&typeof s<"u"){if(l.v&&ui(l)==4)setTimeout(l.Ca.bind(l),0);else if(be(l,"readystatechange"),ui(l)==4){l.h=!1;try{const z=l.ca();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var E;if(E=z===0){let J=String(l.D).match(Me)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),E=!cb.test(J?J.toLowerCase():"")}m=E}if(m)be(l,"complete"),be(l,"success");else{l.o=6;try{var L=ui(l)>2?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.ca()+"]",Bg(l)}}finally{Ic(l)}}}}function Ic(l,h){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const m=l.g;l.g=null,h||be(l,"ready");try{m.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ui(l){return l.g?l.g.readyState:0}t.ca=function(){try{return ui(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),mt(h)}};function Ug(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function db(l){const h={};l=(l.g&&ui(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<l.length;E++){if(T(l[E]))continue;var m=Cn(l[E]);const L=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const z=h[L]||[];h[L]=z,z.push(m)}Q(h,function(E){return E.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wa(l,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||h}function $g(l){this.za=0,this.i=[],this.j=new tn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wa("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wa("baseRetryDelayMs",5e3,l),this.Za=wa("retryDelaySeedMs",1e4,l),this.Ta=wa("forwardChannelMaxRetries",2,l),this.va=wa("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new ma(l&&l.concurrentRequestLimit),this.Ba=new lb,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=$g.prototype,t.ka=8,t.I=1,t.connect=function(l,h,m,E){ke(0),this.W=l,this.H=h||{},m&&E!==void 0&&(this.H.OSID=m,this.H.OAID=E),this.F=this.X,this.J=Xg(this,null,this.W),Sc(this)};function mh(l){if(Wg(l),l.I==3){var h=l.V++,m=on(l.J);if(Be(m,"SID",l.M),Be(m,"RID",h),Be(m,"TYPE","terminate"),Ea(l,m),h=new sn(l,l.j,h),h.M=2,h.A=Ks(on(m)),m=!1,o.navigator&&o.navigator.sendBeacon)try{m=o.navigator.sendBeacon(h.A.toString(),"")}catch{}!m&&o.Image&&(new Image().src=h.A,m=!0),m||(h.g=Zg(h.j,null),h.g.ea(h.A)),h.F=Date.now(),ls(h)}Jg(l)}function bc(l){l.g&&(yh(l),l.g.cancel(),l.g=null)}function Wg(l){bc(l),l.v&&(o.clearTimeout(l.v),l.v=null),Cc(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Sc(l){if(!ga(l.h)&&!l.m){l.m=!0;var h=l.Ea;M||v(),B||(M(),B=!0),_.add(h,l),l.D=0}}function hb(l,h){return w(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=h.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=yt(d(l.Ea,l,h),Yg(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const L=new sn(this,this.j,l);let z=this.o;if(this.U&&(z?(z=xe(z),Ze(z,this.U)):z=this.U),this.u!==null||this.R||(L.J=z,z=null),this.S)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var E=this.i[m];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(h+=E,h>4096){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Hg(this,L,h),m=on(this.J),Be(m,"RID",l),Be(m,"CVER",22),this.G&&Be(m,"X-HTTP-Session-Id",this.G),Ea(this,m),z&&(this.R?h="headers="+vn(Vg(z))+"&"+h:this.u&&ph(m,this.u,z)),Y(this.h,L),this.Ra&&Be(m,"TYPE","init"),this.S?(Be(m,"$req",h),Be(m,"SID","null"),L.U=!0,sr(L,m,null)):sr(L,m,h),this.I=2}}else this.I==3&&(l?qg(this,l):this.i.length==0||ga(this.h)||qg(this))};function qg(l,h){var m;h?m=h.l:m=l.V++;const E=on(l.J);Be(E,"SID",l.M),Be(E,"RID",m),Be(E,"AID",l.K),Ea(l,E),l.u&&l.o&&ph(E,l.u,l.o),m=new sn(l,l.j,m,l.D+1),l.u===null&&(m.J=l.o),h&&(l.i=h.G.concat(l.i)),h=Hg(l,m,1e3),m.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Y(l.h,m),sr(m,E,h)}function Ea(l,h){l.H&&O(l.H,function(m,E){Be(h,E,m)}),l.l&&O({},function(m,E){Be(h,E,m)})}function Hg(l,h,m){m=Math.min(l.i.length,m);const E=l.l?d(l.l.Ka,l.l,l):null;e:{var L=l.i;let Ee=-1;for(;;){const Dt=["count="+m];Ee==-1?m>0?(Ee=L[0].g,Dt.push("ofs="+Ee)):Ee=0:Dt.push("ofs="+Ee);let Ge=!0;for(let Vt=0;Vt<m;Vt++){var z=L[Vt].g;const Ir=L[Vt].map;if(z-=Ee,z<0)Ee=Math.max(0,L[Vt].g-100),Ge=!1;else try{z="req"+z+"_"||"";try{var J=Ir instanceof Map?Ir:Object.entries(Ir);for(const[ps,di]of J){let hi=di;c(di)&&(hi=en(di)),Dt.push(z+ps+"="+encodeURIComponent(hi))}}catch(ps){throw Dt.push(z+"type="+encodeURIComponent("_badmap")),ps}}catch{E&&E(Ir)}}if(Ge){J=Dt.join("&");break e}}J=void 0}return l=l.i.splice(0,m),h.G=l,J}function Gg(l){if(!l.g&&!l.v){l.Y=1;var h=l.Da;M||v(),B||(M(),B=!0),_.add(h,l),l.A=0}}function gh(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=yt(d(l.Da,l),Yg(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Kg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=yt(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ke(10),bc(this),Kg(this))};function yh(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Kg(l){l.g=new sn(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var h=on(l.na);Be(h,"RID","rpc"),Be(h,"SID",l.M),Be(h,"AID",l.K),Be(h,"CI",l.F?"0":"1"),!l.F&&l.ia&&Be(h,"TO",l.ia),Be(h,"TYPE","xmlhttp"),Ea(l,h),l.u&&l.o&&ph(h,l.u,l.o),l.O&&(l.g.H=l.O);var m=l.g;l=l.ba,m.M=1,m.A=Ks(on(h)),m.u=null,m.R=!0,_c(m,l)}t.Va=function(){this.C!=null&&(this.C=null,bc(this),gh(this),ke(19))};function Cc(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Qg(l,h){var m=null;if(l.g==h){Cc(l),yh(l),l.g=null;var E=2}else if(V(l.h,h))m=h.G,ne(l.h,h),E=1;else return;if(l.I!=0){if(h.o)if(E==1){m=h.u?h.u.length:0,h=Date.now()-h.F;var L=l.D;E=_r(),be(E,new Et(E,m)),Sc(l)}else Gg(l);else if(L=h.m,L==3||L==0&&h.X>0||!(E==1&&hb(l,h)||E==2&&gh(l)))switch(m&&m.length>0&&(h=l.h,h.i=h.i.concat(m)),L){case 1:fs(l,5);break;case 4:fs(l,10);break;case 3:fs(l,6);break;default:fs(l,2)}}}function Yg(l,h){let m=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(m*=2),m*h}function fs(l,h){if(l.j.info("Error code "+h),h==2){var m=d(l.bb,l),E=l.Ua;const L=!E;E=new Pe(E||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||An(E,"https"),Ks(E),L?ob(E.toString(),m):ab(E.toString(),m)}else ke(2);l.I=0,l.l&&l.l.pa(h),Jg(l),Wg(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))};function Jg(l){if(l.I=0,l.ja=[],l.l){const h=ie(l.h);(h.length!=0||l.i.length!=0)&&(C(l.ja,h),C(l.ja,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.oa()}}function Xg(l,h,m){var E=m instanceof Pe?on(m):new Pe(m);if(E.g!="")h&&(E.g=h+"."+E.g),Er(E,E.u);else{var L=o.location;E=L.protocol,h=h?h+"."+L.hostname:L.hostname,L=+L.port;const z=new Pe(null);E&&An(z,E),h&&(z.g=h),L&&Er(z,L),m&&(z.h=m),E=z}return m=l.G,h=l.wa,m&&h&&Be(E,m,h),Be(E,"VER",l.ka),Ea(l,E),E}function Zg(l,h,m){if(h&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Aa&&!l.ma?new ft(new fh({ab:m})):new ft(l.ma),h.Fa(l.L),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ey(){}t=ey.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ac(){}Ac.prototype.g=function(l,h){return new Vn(l,h)};function Vn(l,h){ge.call(this),this.g=new $g(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.sa&&(l?l["X-WebChannel-Client-Profile"]=h.sa:l={"X-WebChannel-Client-Profile":h.sa}),this.g.U=l,(l=h&&h.Qb)&&!T(l)&&(this.g.u=l),this.A=h&&h.supportsCrossDomainXhr||!1,this.v=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!T(h)&&(this.g.G=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ys(this)}p(Vn,ge),Vn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){mh(this.g)},Vn.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.v&&(m={},m.__data__=en(l),l=m);h.i.push(new wc(h.Ya++,l)),h.I==3&&Sc(h)},Vn.prototype.N=function(){this.g.l=null,delete this.j,mh(this.g),delete this.g,Vn.Z.N.call(this)};function ty(l){ii.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const m in h){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}p(ty,ii);function ny(){Hn.call(this),this.status=1}p(ny,Hn);function Ys(l){this.g=l}p(Ys,ey),Ys.prototype.ra=function(){be(this.g,"a")},Ys.prototype.qa=function(l){be(this.g,new ty(l))},Ys.prototype.pa=function(l){be(this.g,new ny)},Ys.prototype.oa=function(){be(this.g,"b")},Ac.prototype.createWebChannel=Ac.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,gw=function(){return new Ac},mw=function(){return _r()},pw=Sn,hp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},yn.NO_ERROR=0,yn.TIMEOUT=8,yn.HTTP_ERROR=6,fu=yn,rn.COMPLETE="complete",fw=rn,at.EventType=Ln,Ln.OPEN="a",Ln.CLOSE="b",Ln.ERROR="c",Ln.MESSAGE="d",ge.prototype.listen=ge.prototype.J,Wa=at,ft.prototype.listenOnce=ft.prototype.K,ft.prototype.getLastError=ft.prototype.Ha,ft.prototype.getLastErrorCode=ft.prototype.ya,ft.prototype.getStatus=ft.prototype.ca,ft.prototype.getResponseJson=ft.prototype.La,ft.prototype.getResponseText=ft.prototype.la,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Fa,hw=ft}).apply(typeof Hc<"u"?Hc:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let na="12.8.0";function GT(t){na=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms=new Nm("@firebase/firestore");function to(){return Ms.logLevel}function ee(t,...e){if(Ms.logLevel<=Ae.DEBUG){const n=e.map(Lm);Ms.debug(`Firestore (${na}): ${t}`,...n)}}function Xr(t,...e){if(Ms.logLevel<=Ae.ERROR){const n=e.map(Lm);Ms.error(`Firestore (${na}): ${t}`,...n)}}function Wo(t,...e){if(Ms.logLevel<=Ae.WARN){const n=e.map(Lm);Ms.warn(`Firestore (${na}): ${t}`,...n)}}function Lm(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,yw(t,r,n)}function yw(t,e,n){let r=`FIRESTORE (${na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Xr(r),new Error(r)}function Ue(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||yw(e,i,r)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends ri{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class KT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(un.UNAUTHENTICATED))}shutdown(){}}class QT{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class YT{constructor(e){this.t=e,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ue(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Hr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Hr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Hr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string",31837,{l:r}),new vw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string",2055,{h:e}),new un(e)}}class JT{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=un.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class XT{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new JT(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(un.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZT{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ue(this.o===void 0,3512);const r=s=>{s.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new kv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ue(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new kv(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=e2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function fp(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return Jh(i)===Jh(s)?Te(i,s):Jh(i)?1:-1}return Te(t.length,e.length)}const t2=55296,n2=57343;function Jh(t){const e=t.charCodeAt(0);return e>=t2&&e<=n2}function qo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="__name__";class Cr{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&he(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Cr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Cr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=Cr.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return Te(e.length,n.length)}static compareSegments(e,n){const r=Cr.isNumericId(e),i=Cr.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?Cr.extractNumericId(e).compare(Cr.extractNumericId(n)):fp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $i.fromString(e.substring(4,e.length-2))}}class Je extends Cr{construct(e,n,r){return new Je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Je(n)}static emptyPath(){return new Je([])}}const r2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qt extends Cr{construct(e,n,r){return new Qt(e,n,r)}static isValidIdentifier(e){return r2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===jv}static keyField(){return new Qt([jv])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Z(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Z(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Z(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new Z(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qt(n)}static emptyPath(){return new Qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Je.fromString(e))}static fromName(e){return new se(Je.fromString(e).popFirst(5))}static empty(){return new se(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(t,e,n){if(!n)throw new Z(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function i2(t,e,n,r){if(e===!0&&r===!0)throw new Z(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Dv(t){if(!se.isDocumentKey(t))throw new Z(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nv(t){if(se.isDocumentKey(t))throw new Z(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function _w(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Bd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he(12329,{type:typeof t})}function nr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bd(t);throw new Z(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t,e){const n={typeString:t};return e&&(n.value=e),n}function rc(t,e){if(!_w(t))throw new Z(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Z(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=-62135596800,Ov=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*Ov);return new nt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Pv)throw new Z(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ov}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rc(e,nt._jsonSchema))return new nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nt._jsonSchemaVersion="firestore/timestamp/1.0",nt._jsonSchema={type:Ct("string",nt._jsonSchemaVersion),seconds:Ct("number"),nanoseconds:Ct("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new nt(0,0))}static max(){return new ye(new nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=-1;function s2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ye.fromTimestamp(r===1e9?new nt(n+1,0):new nt(n,r));return new Qi(i,se.empty(),e)}function o2(t){return new Qi(t.readTime,t.key,Ll)}class Qi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Qi(ye.min(),se.empty(),Ll)}static max(){return new Qi(ye.max(),se.empty(),Ll)}}function a2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class c2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ra(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==l2)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let c=0;for(let u=0;u<s;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++c,c===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function u2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ia(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=-1;function Ud(t){return t==null}function ed(t){return t===0&&1/t==-1/0}function d2(t){return typeof t=="number"&&Number.isInteger(t)&&!ed(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="";function h2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Lv(e)),e=f2(t.get(n),e);return Lv(e)}function f2(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case ww:n+="";break;default:n+=s}}return n}function Lv(t){return t+ww+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ss(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ew(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||Gt.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Gt.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gc(this.root,e,this.comparator,!0)}}class Gc{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Gt.RED,this.left=i??Gt.EMPTY,this.right=s??Gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Gt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Gt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw he(43730,{key:this.key,value:this.value});if(this.right.isRed())throw he(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw he(27949);return e+(this.isRed()?0:1)}}Gt.EMPTY=null,Gt.RED=!0,Gt.BLACK=!1;Gt.EMPTY=new class{constructor(){this.size=0}get key(){throw he(57766)}get value(){throw he(16141)}get color(){throw he(16727)}get left(){throw he(29726)}get right(){throw he(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Gt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Vv(this.data.getIterator())}getIteratorFrom(e){return new Vv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Mt(this.comparator);return n.data=e,n}}class Vv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.fields=e,e.sort(Qt.comparator)}static empty(){return new Fn([])}unionWith(e){let n=new Mt(Qt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return qo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Iw("Invalid base64 string: "+s):s}}(e);return new Zt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Zt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const p2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yi(t){if(Ue(!!t,39018),typeof t=="string"){let e=0;const n=p2.exec(t);if(Ue(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(t.seconds),nanos:vt(t.nanos)}}function vt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ji(t){return typeof t=="string"?Zt.fromBase64String(t):Zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="server_timestamp",Sw="__type__",Cw="__previous_value__",Aw="__local_write_time__";function zm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Sw])==null?void 0:r.stringValue)===bw}function $d(t){const e=t.mapValue.fields[Cw];return zm(e)?$d(e):e}function Ml(t){const e=Yi(t.mapValue.fields[Aw].timestampValue);return new nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,n,r,i,s,o,c,u,d,f,p){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f,this.apiKey=p}}const td="(default)";class Vl{constructor(e,n){this.projectId=e,this.database=n||td}static empty(){return new Vl("","")}get isDefaultDatabase(){return this.database===td}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}function g2(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Z(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw="__type__",y2="__max__",Kc={mapValue:{}},Rw="__vector__",nd="value";function Xi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zm(t)?4:x2(t)?9007199254740991:v2(t)?10:11:he(28295,{value:t})}function Or(t,e){if(t===e)return!0;const n=Xi(t);if(n!==Xi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ml(t).isEqual(Ml(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Yi(i.timestampValue),c=Yi(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ji(i.bytesValue).isEqual(Ji(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return vt(i.geoPointValue.latitude)===vt(s.geoPointValue.latitude)&&vt(i.geoPointValue.longitude)===vt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return vt(i.integerValue)===vt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=vt(i.doubleValue),c=vt(s.doubleValue);return o===c?ed(o)===ed(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return qo(t.arrayValue.values||[],e.arrayValue.values||[],Or);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(Mv(o)!==Mv(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Or(o[u],c[u])))return!1;return!0}(t,e);default:return he(52216,{left:t})}}function zl(t,e){return(t.values||[]).find(n=>Or(n,e))!==void 0}function Ho(t,e){if(t===e)return 0;const n=Xi(t),r=Xi(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(s,o){const c=vt(s.integerValue||s.doubleValue),u=vt(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return zv(t.timestampValue,e.timestampValue);case 4:return zv(Ml(t),Ml(e));case 5:return fp(t.stringValue,e.stringValue);case 6:return function(s,o){const c=Ji(s),u=Ji(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const c=s.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=Te(c[d],u[d]);if(f!==0)return f}return Te(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const c=Te(vt(s.latitude),vt(o.latitude));return c!==0?c:Te(vt(s.longitude),vt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bv(t.arrayValue,e.arrayValue);case 10:return function(s,o){var g,x,C,j;const c=s.fields||{},u=o.fields||{},d=(g=c[nd])==null?void 0:g.arrayValue,f=(x=u[nd])==null?void 0:x.arrayValue,p=Te(((C=d==null?void 0:d.values)==null?void 0:C.length)||0,((j=f==null?void 0:f.values)==null?void 0:j.length)||0);return p!==0?p:Bv(d,f)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Kc.mapValue&&o===Kc.mapValue)return 0;if(s===Kc.mapValue)return 1;if(o===Kc.mapValue)return-1;const c=s.fields||{},u=Object.keys(c),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const g=fp(u[p],f[p]);if(g!==0)return g;const x=Ho(c[u[p]],d[f[p]]);if(x!==0)return x}return Te(u.length,f.length)}(t.mapValue,e.mapValue);default:throw he(23264,{he:n})}}function zv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=Yi(t),r=Yi(e),i=Te(n.seconds,r.seconds);return i!==0?i:Te(n.nanos,r.nanos)}function Bv(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Ho(n[i],r[i]);if(s)return s}return Te(n.length,r.length)}function Go(t){return pp(t)}function pp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Yi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ji(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=pp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${pp(n.fields[o])}`;return i+"}"}(t.mapValue):he(61005,{value:t})}function pu(t){switch(Xi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$d(t);return e?16+pu(e):16;case 5:return 2*t.stringValue.length;case 6:return Ji(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+pu(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return ss(r.fields,(s,o)=>{i+=s.length+pu(o)}),i}(t.mapValue);default:throw he(13486,{value:t})}}function Fv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mp(t){return!!t&&"integerValue"in t}function Bm(t){return!!t&&"arrayValue"in t}function Uv(t){return!!t&&"nullValue"in t}function $v(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mu(t){return!!t&&"mapValue"in t}function v2(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Tw])==null?void 0:r.stringValue)===Rw}function sl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ss(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=sl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=sl(t.arrayValue.values[n]);return e}return{...t}}function x2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===y2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.value=e}static empty(){return new kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!mu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=sl(n)}setAll(e){let n=Qt.emptyPath(),r={},i=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=c.popLast()}o?r[c.lastSegment()]=sl(o):i.push(c.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());mu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Or(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];mu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ss(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new kn(sl(this.value))}}function kw(t){const e=[];return ss(t.fields,(n,r)=>{const i=new Qt([n]);if(mu(r)){const s=kw(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,n,r,i,s,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new hn(e,0,ye.min(),ye.min(),ye.min(),kn.empty(),0)}static newFoundDocument(e,n,r,i){return new hn(e,1,n,ye.min(),r,i,0)}static newNoDocument(e,n){return new hn(e,2,n,ye.min(),ye.min(),kn.empty(),0)}static newUnknownDocument(e,n){return new hn(e,3,n,ye.min(),ye.min(),kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n){this.position=e,this.inclusive=n}}function Wv(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=Ho(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function qv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Or(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,n="asc"){this.field=e,this.dir=n}}function _2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{}class St extends jw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new E2(e,n,r):n==="array-contains"?new S2(e,r):n==="in"?new C2(e,r):n==="not-in"?new A2(e,r):n==="array-contains-any"?new T2(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new I2(e,r):new b2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ho(n,this.value)):n!==null&&Xi(this.value)===Xi(n)&&this.matchesComparison(Ho(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vr extends jw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new vr(e,n)}matches(e){return Dw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Dw(t){return t.op==="and"}function Nw(t){return w2(t)&&Dw(t)}function w2(t){for(const e of t.filters)if(e instanceof vr)return!1;return!0}function gp(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+Go(t.value);if(Nw(t))return t.filters.map(e=>gp(e)).join(",");{const e=t.filters.map(n=>gp(n)).join(",");return`${t.op}(${e})`}}function Pw(t,e){return t instanceof St?function(r,i){return i instanceof St&&r.op===i.op&&r.field.isEqual(i.field)&&Or(r.value,i.value)}(t,e):t instanceof vr?function(r,i){return i instanceof vr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,c)=>s&&Pw(o,i.filters[c]),!0):!1}(t,e):void he(19439)}function Ow(t){return t instanceof St?function(n){return`${n.field.canonicalString()} ${n.op} ${Go(n.value)}`}(t):t instanceof vr?function(n){return n.op.toString()+" {"+n.getFilters().map(Ow).join(" ,")+"}"}(t):"Filter"}class E2 extends St{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class I2 extends St{constructor(e,n){super(e,"in",n),this.keys=Lw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class b2 extends St{constructor(e,n){super(e,"not-in",n),this.keys=Lw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Lw(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class S2 extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bm(n)&&zl(n.arrayValue,this.value)}}class C2 extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zl(this.value.arrayValue,n)}}class A2 extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!zl(this.value.arrayValue,n)}}class T2 extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,n=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}}function Hv(t,e=null,n=[],r=[],i=null,s=null,o=null){return new R2(t,e,n,r,i,s,o)}function Fm(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ud(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Go(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Go(r)).join(",")),e.Te=n}return e.Te}function Um(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Pw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qv(t.startAt,e.startAt)&&qv(t.endAt,e.endAt)}function yp(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function k2(t,e,n,r,i,s,o,c){return new ic(t,e,n,r,i,s,o,c)}function $m(t){return new ic(t)}function Gv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function j2(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Mw(t){return t.collectionGroup!==null}function ol(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Mt(Qt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new id(s,r))}),n.has(Qt.keyField().canonicalString())||e.Ie.push(new id(Qt.keyField(),r))}return e.Ie}function kr(t){const e=ve(t);return e.Ee||(e.Ee=D2(e,ol(t))),e.Ee}function D2(t,e){if(t.limitType==="F")return Hv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new id(i.field,s)});const n=t.endAt?new rd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new rd(t.startAt.position,t.startAt.inclusive):null;return Hv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vp(t,e){const n=t.filters.concat([e]);return new ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function xp(t,e,n){return new ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wd(t,e){return Um(kr(t),kr(e))&&t.limitType===e.limitType}function Vw(t){return`${Fm(kr(t))}|lt:${t.limitType}`}function no(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Ow(i)).join(", ")}]`),Ud(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Go(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Go(i)).join(",")),`Target(${r})`}(kr(t))}; limitType=${t.limitType})`}function qd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ol(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,c,u){const d=Wv(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,ol(r),i)||r.endAt&&!function(o,c,u){const d=Wv(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,ol(r),i))}(t,e)}function N2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function zw(t){return(e,n)=>{let r=!1;for(const i of ol(t)){const s=P2(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function P2(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,c){const u=o.data.field(s),d=c.data.field(s);return u!==null&&d!==null?Ho(u,d):he(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ss(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Ew(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2=new dt(se.comparator);function Zr(){return O2}const Bw=new dt(se.comparator);function qa(...t){let e=Bw;for(const n of t)e=e.insert(n.key,n);return e}function Fw(t){let e=Bw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function bs(){return al()}function Uw(){return al()}function al(){return new $s(t=>t.toString(),(t,e)=>t.isEqual(e))}const L2=new dt(se.comparator),M2=new Mt(se.comparator);function Re(...t){let e=M2;for(const n of t)e=e.add(n);return e}const V2=new Mt(Te);function z2(){return V2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ed(e)?"-0":e}}function $w(t){return{integerValue:""+t}}function B2(t,e){return d2(e)?$w(e):Wm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(){this._=void 0}}function F2(t,e,n){return t instanceof Bl?function(i,s){const o={fields:{[Sw]:{stringValue:bw},[Aw]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&zm(s)&&(s=$d(s)),s&&(o.fields[Cw]=s),{mapValue:o}}(n,e):t instanceof Fl?qw(t,e):t instanceof Ul?Hw(t,e):function(i,s){const o=Ww(i,s),c=Kv(o)+Kv(i.Ae);return mp(o)&&mp(i.Ae)?$w(c):Wm(i.serializer,c)}(t,e)}function U2(t,e,n){return t instanceof Fl?qw(t,e):t instanceof Ul?Hw(t,e):n}function Ww(t,e){return t instanceof sd?function(r){return mp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Bl extends Hd{}class Fl extends Hd{constructor(e){super(),this.elements=e}}function qw(t,e){const n=Gw(e);for(const r of t.elements)n.some(i=>Or(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ul extends Hd{constructor(e){super(),this.elements=e}}function Hw(t,e){let n=Gw(e);for(const r of t.elements)n=n.filter(i=>!Or(i,r));return{arrayValue:{values:n}}}class sd extends Hd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Kv(t){return vt(t.integerValue||t.doubleValue)}function Gw(t){return Bm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n){this.field=e,this.transform=n}}function W2(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Fl&&i instanceof Fl||r instanceof Ul&&i instanceof Ul?qo(r.elements,i.elements,Or):r instanceof sd&&i instanceof sd?Or(r.Ae,i.Ae):r instanceof Bl&&i instanceof Bl}(t.transform,e.transform)}class q2{constructor(e,n){this.version=e,this.transformResults=n}}class wn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new wn}static exists(e){return new wn(void 0,e)}static updateTime(e){return new wn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gd{}function Kw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Kd(t.key,wn.none()):new sc(t.key,t.data,wn.none());{const n=t.data,r=kn.empty();let i=new Mt(Qt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new os(t.key,r,new Fn(i.toArray()),wn.none())}}function H2(t,e,n){t instanceof sc?function(i,s,o){const c=i.value.clone(),u=Yv(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof os?function(i,s,o){if(!gu(i.precondition,s))return void s.convertToUnknownDocument(o.version);const c=Yv(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Qw(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ll(t,e,n,r){return t instanceof sc?function(s,o,c,u){if(!gu(s.precondition,o))return c;const d=s.value.clone(),f=Jv(s.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof os?function(s,o,c,u){if(!gu(s.precondition,o))return c;const d=Jv(s.fieldTransforms,u,o),f=o.data;return f.setAll(Qw(s)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,c){return gu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function G2(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Ww(r.transform,i||null);s!=null&&(n===null&&(n=kn.empty()),n.set(r.field,s))}return n||null}function Qv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&qo(r,i,(s,o)=>W2(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sc extends Gd{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class os extends Gd{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Qw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Yv(t,e,n){const r=new Map;Ue(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,U2(o,c,n[i]))}return r}function Jv(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,F2(s,o,e))}return r}class Kd extends Gd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class K2 extends Gd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&H2(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ll(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ll(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Uw();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let c=this.applyToLocalView(o,s.mutatedFields);c=n.has(i.key)?null:c;const u=Kw(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(ye.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Re())}isEqual(e){return this.batchId===e.batchId&&qo(this.mutations,e.mutations,(n,r)=>Qv(n,r))&&qo(this.baseMutations,e.baseMutations,(n,r)=>Qv(n,r))}}class qm{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return L2}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new qm(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,De;function X2(t){switch(t){case U.OK:return he(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return he(15467,{code:t})}}function Yw(t){if(t===void 0)return Xr("GRPC error has no .code"),U.UNKNOWN;switch(t){case It.OK:return U.OK;case It.CANCELLED:return U.CANCELLED;case It.UNKNOWN:return U.UNKNOWN;case It.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case It.INTERNAL:return U.INTERNAL;case It.UNAVAILABLE:return U.UNAVAILABLE;case It.UNAUTHENTICATED:return U.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case It.NOT_FOUND:return U.NOT_FOUND;case It.ALREADY_EXISTS:return U.ALREADY_EXISTS;case It.PERMISSION_DENIED:return U.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case It.ABORTED:return U.ABORTED;case It.OUT_OF_RANGE:return U.OUT_OF_RANGE;case It.UNIMPLEMENTED:return U.UNIMPLEMENTED;case It.DATA_LOSS:return U.DATA_LOSS;default:return he(39323,{code:t})}}(De=It||(It={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR=new $i([4294967295,4294967295],0);function Xv(t){const e=Z2().encode(t),n=new dw;return n.update(e),new Uint8Array(n.digest())}function Zv(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $i([n,r],0),new $i([i,s],0)]}class Hm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ha(`Invalid padding: ${n}`);if(r<0)throw new Ha(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ha(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ha(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=$i.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply($i.fromNumber(r)));return i.compare(eR)===1&&(i=new $i([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Xv(e),[r,i]=Zv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Hm(s,i,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=Xv(e),[r,i]=Zv(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,oc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qd(ye.min(),i,new dt(Te),Zr(),Re())}}class oc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new oc(r,n,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n,r,i){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Jw{constructor(e,n){this.targetId=e,this.Ce=n}}class Xw{constructor(e,n,r=Zt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ex{constructor(){this.ve=0,this.Fe=tx(),this.Me=Zt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Re(),n=Re(),r=Re();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he(38017,{changeType:s})}}),new oc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=tx()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ue(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class tR{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zr(),this.He=Qc(),this.Je=Qc(),this.Ze=new dt(Te)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:he(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,i)=>{this.rt(i)&&n(i)})}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(yp(s))if(r===0){const o=new se(s.path);this.et(n,o,hn.newNoDocument(o,ye.min()))}else Ue(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,c;try{o=Ji(r).toUint8Array()}catch(u){if(u instanceof Iw)return Wo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Hm(o,i,s)}catch(u){return Wo(u instanceof Ha?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(n,s,null),i++)}),i}Tt(e){const n=new Map;this.ze.forEach((s,o)=>{const c=this.ot(o);if(c){if(s.current&&yp(c.target)){const u=new se(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,hn.newNoDocument(u,e))}s.Be&&(n.set(o,s.ke()),s.Ke())}});let r=Re();this.Je.forEach((s,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const i=new Qd(e,n,this.Ze,this.je,r);return this.je=Zr(),this.He=Qc(),this.Je=Qc(),this.Ze=new dt(Te),i}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.qe(n,1):i.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new ex,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Mt(Te),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Mt(Te),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ex),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Qc(){return new dt(se.comparator)}function tx(){return new dt(se.comparator)}const nR={asc:"ASCENDING",desc:"DESCENDING"},rR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iR={and:"AND",or:"OR"};class sR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function _p(t,e){return t.useProto3Json||Ud(e)?e:{value:e}}function od(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oR(t,e){return od(t,e.toTimestamp())}function jr(t){return Ue(!!t,49232),ye.fromTimestamp(function(n){const r=Yi(n);return new nt(r.seconds,r.nanos)}(t))}function Gm(t,e){return wp(t,e).canonicalString()}function wp(t,e){const n=function(i){return new Je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function eE(t){const e=Je.fromString(t);return Ue(sE(e),10190,{key:e.toString()}),e}function Ep(t,e){return Gm(t.databaseId,e.path)}function Xh(t,e){const n=eE(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(nE(n))}function tE(t,e){return Gm(t.databaseId,e)}function aR(t){const e=eE(t);return e.length===4?Je.emptyPath():nE(e)}function Ip(t){return new Je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nE(t){return Ue(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function nx(t,e,n){return{name:Ep(t,e),fields:n.value.mapValue.fields}}function lR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:he(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,f){return d.useProto3Json?(Ue(f===void 0||typeof f=="string",58123),Zt.fromBase64String(f||"")):(Ue(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Zt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const f=d.code===void 0?U.UNKNOWN:Yw(d.code);return new Z(f,d.message||"")}(o);n=new Xw(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Xh(t,r.document.name),s=jr(r.document.updateTime),o=r.document.createTime?jr(r.document.createTime):ye.min(),c=new kn({mapValue:{fields:r.document.fields}}),u=hn.newFoundDocument(i,s,o,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new yu(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Xh(t,r.document),s=r.readTime?jr(r.readTime):ye.min(),o=hn.newNoDocument(i,s),c=r.removedTargetIds||[];n=new yu([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Xh(t,r.document),s=r.removedTargetIds||[];n=new yu([],s,i,null)}else{if(!("filter"in e))return he(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new J2(i,s),c=r.targetId;n=new Jw(c,o)}}return n}function cR(t,e){let n;if(e instanceof sc)n={update:nx(t,e.key,e.value)};else if(e instanceof Kd)n={delete:Ep(t,e.key)};else if(e instanceof os)n={update:nx(t,e.key,e.data),updateMask:vR(e.fieldMask)};else{if(!(e instanceof K2))return he(16599,{dt:e.type});n={verify:Ep(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const c=o.transform;if(c instanceof Bl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Fl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ul)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof sd)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw he(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he(27497)}(t,e.precondition)),n}function uR(t,e){return t&&t.length>0?(Ue(e!==void 0,14353),t.map(n=>function(i,s){let o=i.updateTime?jr(i.updateTime):jr(s);return o.isEqual(ye.min())&&(o=jr(s)),new q2(o,i.transformResults||[])}(n,e))):[]}function dR(t,e){return{documents:[tE(t,e.path)]}}function hR(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=tE(t,i);const s=function(d){if(d.length!==0)return iE(vr.create(d,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(d){if(d.length!==0)return d.map(f=>function(g){return{field:ro(g.field),direction:mR(g.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=_p(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:i}}function fR(t){let e=aR(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ue(r===1,65062);const f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){const g=rE(p);return g instanceof vr&&Nw(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(g=>function(C){return new id(io(C.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(g))}(n.orderBy));let c=null;n.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,Ud(g)?null:g}(n.limit));let u=null;n.startAt&&(u=function(p){const g=!!p.before,x=p.values||[];return new rd(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const g=!p.before,x=p.values||[];return new rd(x,g)}(n.endAt)),k2(e,i,o,s,c,"F",u,d)}function pR(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he(28987,{purpose:i})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function rE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=io(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=io(n.unaryFilter.field);return St.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=io(n.unaryFilter.field);return St.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=io(n.unaryFilter.field);return St.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return he(61313);default:return he(60726)}}(t):t.fieldFilter!==void 0?function(n){return St.create(io(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return he(58110);default:return he(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return vr.create(n.compositeFilter.filters.map(r=>rE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he(1026)}}(n.compositeFilter.op))}(t):he(30097,{filter:t})}function mR(t){return nR[t]}function gR(t){return rR[t]}function yR(t){return iR[t]}function ro(t){return{fieldPath:t.canonicalString()}}function io(t){return Qt.fromServerFormat(t.fieldPath)}function iE(t){return t instanceof St?function(n){if(n.op==="=="){if($v(n.value))return{unaryFilter:{field:ro(n.field),op:"IS_NAN"}};if(Uv(n.value))return{unaryFilter:{field:ro(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($v(n.value))return{unaryFilter:{field:ro(n.field),op:"IS_NOT_NAN"}};if(Uv(n.value))return{unaryFilter:{field:ro(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ro(n.field),op:gR(n.op),value:n.value}}}(t):t instanceof vr?function(n){const r=n.getFilters().map(i=>iE(i));return r.length===1?r[0]:{compositeFilter:{op:yR(n.op),filters:r}}}(t):he(54877,{filter:t})}function vR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function oE(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n,r,i,s=ye.min(),o=ye.min(),c=Zt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ki(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e){this.yt=e}}function _R(t){const e=fR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(){this.Sn=new ER}addToCollectionParentIndex(e,n){return this.Sn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Qi.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Qi.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class ER{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Mt(Je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Mt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aE=41943040;class Tn{static withCacheSize(e){return new Tn(e,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn.DEFAULT_COLLECTION_PERCENTILE=10,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tn.DEFAULT=new Tn(aE,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tn.DISABLED=new Tn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ko(0)}static ar(){return new Ko(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="LruGarbageCollector",IR=1048576;function sx([t,e],[n,r]){const i=Te(t,n);return i===0?Te(e,r):i}class bR{constructor(e){this.Pr=e,this.buffer=new Mt(sx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();sx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class SR{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ee(ix,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ia(n)?ee(ix,"Ignoring IndexedDB error during garbage collection: ",n):await ra(n)}await this.Ar(3e5)})}}class CR{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Fd.ce);const r=new bR(n);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(rx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rx):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,i,s,o,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,c=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),to()<=Ae.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function AR(t,e){return new CR(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(){this.changes=new $s(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ll(r.mutation,i,Fn.empty(),nt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Re()){const i=bs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=qa();return s.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=bs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Re()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,i){let s=Zr();const o=al(),c=function(){return al()}();return n.forEach((u,d)=>{const f=r.get(d.key);i.has(d.key)&&(f===void 0||f.mutation instanceof os)?s=s.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),ll(f.mutation,d,f.mutation.getFieldMask(),nt.now())):o.set(d.key,Fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>c.set(d,new RR(f,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=al();let i=new dt((o,c)=>o-c),s=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||Fn.empty();f=c.applyToLocalView(d,f),r.set(u,f);const p=(i.get(c.batchId)||Re()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,p=Uw();f.forEach(g=>{if(!s.has(g)){const x=Kw(n.get(g),r.get(g));x!==null&&p.set(g,x),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return j2(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Mw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(bs());let c=Ll,u=s;return o.next(d=>q.forEach(d,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(f)?q.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{u=u.insert(f,g)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,u,d,Re())).next(f=>({batchId:c,changes:Fw(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=qa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=qa();return this.indexManager.getCollectionParents(e,s).next(c=>q.forEach(c,u=>{const d=function(p,g){return new ic(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,hn.newInvalidDocument(f)))});let c=qa();return o.forEach((u,d)=>{const f=s.get(u);f!==void 0&&ll(f.mutation,d,Fn.empty(),nt.now()),qd(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return q.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:jr(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(i){return{name:i.name,query:_R(i.bundledQuery),readTime:jr(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.overlays=new dt(se.comparator),this.Lr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=bs();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.bt(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Lr.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=bs(),s=n.length+1,o=new se(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new dt((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=s.get(d.largestBatchId);f===null&&(f=bs(),s=s.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=bs(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=i)););return q.resolve(c)}bt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Y2(n,r));let s=this.Lr.get(n);s===void 0&&(s=Re(),this.Lr.set(n,s)),this.Lr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(){this.kr=new Mt(zt.Kr),this.qr=new Mt(zt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new zt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new zt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new se(new Je([])),r=new zt(n,e),i=new zt(n,e+1),s=[];return this.qr.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new se(new Je([])),r=new zt(n,e),i=new zt(n,e+1);let s=Re();return this.qr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new zt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class zt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return se.comparator(e.key,n.key)||Te(e.Hr,n.Hr)}static Ur(e,n){return Te(e.Hr,n.Hr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Mt(zt.Kr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Q2(s,n,r,i);this.mutationQueue.push(o);for(const c of i)this.Jr=this.Jr.add(new zt(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Xr(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Vm:this.Yn-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new zt(n,0),i=new zt(n,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],o=>{const c=this.Zr(o.Hr);s.push(c)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mt(Te);return n.forEach(i=>{const s=new zt(i,0),o=new zt(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],c=>{r=r.add(c.Hr)})}),q.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new zt(new se(s),0);let c=new Mt(Te);return this.Jr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.Hr)),!0)},o),q.resolve(this.Yr(c))}Yr(e){const n=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ue(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return q.forEach(n.mutations,i=>{const s=new zt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new zt(n,0),i=this.Jr.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.ti=e,this.docs=function(){return new dt(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():hn.newInvalidDocument(n))}getEntries(e,n){let r=Zr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():hn.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Zr();const o=n.path,c=new se(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||a2(o2(f),r)<=0||(i.has(f.key)||qd(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he(9500)}ni(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new LR(this)}getSize(e){return q.resolve(this.size)}}class LR extends TR{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e){this.persistence=e,this.ri=new $s(n=>Fm(n),Um),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.ii=0,this.si=new Km,this.targetCount=0,this.oi=Ko._r()}forEachTarget(e,n){return this.ri.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),q.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Ko(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.lr(n),q.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.ri.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e,n){this._i={},this.overlays={},this.ai=new Fd(0),this.ui=!1,this.ui=!0,this.ci=new NR,this.referenceDelegate=e(this),this.li=new MR(this),this.indexManager=new wR,this.remoteDocumentCache=function(i){return new OR(i)}(r=>this.referenceDelegate.hi(r)),this.serializer=new xR(n),this.Pi=new jR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new DR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new PR(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const i=new VR(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(s=>this.referenceDelegate.Ii(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,n){return q.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class VR extends c2{constructor(e){super(),this.currentSequenceNumber=e}}class Qm{constructor(e){this.persistence=e,this.Ri=new Km,this.Ai=null}static Vi(e){return new Qm(e)}get di(){if(this.Ai)return this.Ai;throw he(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(i=>this.di.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.di.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.di,r=>{const i=se.fromPath(r);return this.mi(e,i).next(s=>{s||n.removeEntry(i,ye.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class ad{constructor(e,n){this.persistence=e,this.fi=new $s(r=>h2(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=AR(this,n)}static Vi(e,n){return new ad(e,n)}Ti(){}Ii(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return q.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(s=>s?q.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(e,o=>this.wr(e,o,n).next(c=>{c||(r++,s.removeEntry(o,ye.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=pu(e.data.value)),n}wr(e,n,r){return q.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.fi.get(n);return q.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=i}static Es(e,n){let r=Re(),i=Re();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ym(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return AA()?8:u2(gn())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.gs(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ps(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new zR;return this.ys(e,n,o).next(c=>{if(s.result=c,this.As)return this.ws(e,n,o,c.size)})}).next(()=>s.result)}ws(e,n,r,i){return r.documentReadCount<this.Vs?(to()<=Ae.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",no(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(to()<=Ae.DEBUG&&ee("QueryEngine","Query:",no(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(to()<=Ae.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",no(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kr(n))):q.resolve())}gs(e,n){if(Gv(n))return q.resolve(null);let r=kr(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=xp(n,null,"F"),r=kr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Re(...s);return this.fs.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.bs(n,c);return this.Ss(n,d,o,u.readTime)?this.gs(e,xp(n,null,"F")):this.Ds(e,d,n,u)}))})))}ps(e,n,r,i){return Gv(n)||i.isEqual(ye.min())?q.resolve(null):this.fs.getDocuments(e,r).next(s=>{const o=this.bs(n,s);return this.Ss(n,o,r,i)?q.resolve(null):(to()<=Ae.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),no(n)),this.Ds(e,o,n,s2(i,Ll)).next(c=>c))})}bs(e,n){let r=new Mt(zw(e));return n.forEach((i,s)=>{qd(e,s)&&(r=r.add(s))}),r}Ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(e,n,r){return to()<=Ae.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",no(n)),this.fs.getDocumentsMatchingQuery(e,n,Qi.min(),r)}Ds(e,n,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm="LocalStore",FR=3e8;class UR{constructor(e,n,r,i){this.persistence=e,this.Cs=n,this.serializer=i,this.vs=new dt(Te),this.Fs=new $s(s=>Fm(s),Um),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kR(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function $R(t,e,n,r){return new UR(t,e,n,r)}async function cE(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],c=[];let u=Re();for(const d of i){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of s){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:c}))})})}function WR(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.xs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const p=d.batch,g=p.keys();let x=q.resolve();return g.forEach(C=>{x=x.next(()=>f.getEntry(u,C)).next(j=>{const P=d.docVersions.get(C);Ue(P!==null,48541),j.version.compareTo(P)<0&&(p.applyToRemoteDocument(j,d),j.isValidDocument()&&(j.setReadTime(d.commitVersion),f.addEntry(j)))})}),x.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Re();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function uE(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function qR(t,e){const n=ve(t),r=e.snapshotVersion;let i=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});i=n.vs;const c=[];e.targetChanges.forEach((f,p)=>{const g=i.get(p);if(!g)return;c.push(n.li.removeMatchingKeys(s,f.removedDocuments,p).next(()=>n.li.addMatchingKeys(s,f.addedDocuments,p)));let x=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?x=x.withResumeToken(Zt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):f.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(f.resumeToken,r)),i=i.insert(p,x),function(j,P,b){return j.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=FR?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,x,f)&&c.push(n.li.updateTargetData(s,x))});let u=Zr(),d=Re();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(HR(s,o,e.documentUpdates).next(f=>{u=f.Bs,d=f.Ls})),!r.isEqual(ye.min())){const f=n.li.getLastRemoteSnapshotVersion(s).next(p=>n.li.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(f)}return q.waitFor(c).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,d)).next(()=>u)}).then(s=>(n.vs=i,s))}function HR(t,e,n){let r=Re(),i=Re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Zr();return n.forEach((c,u)=>{const d=s.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(ye.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ee(Jm,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Bs:o,Ls:i}})}function GR(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Vm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function KR(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.li.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.li.allocateTargetId(r).next(o=>(i=new ki(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function bp(t,e,n){const r=ve(t),i=r.vs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ia(o))throw o;ee(Jm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function ox(t,e,n){const r=ve(t);let i=ye.min(),s=Re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const p=ve(u),g=p.Fs.get(f);return g!==void 0?q.resolve(p.vs.get(g)):p.li.getTargetData(d,f)}(r,o,kr(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,c.targetId).next(u=>{s=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?i:ye.min(),n?s:Re())).next(c=>(QR(r,N2(e),c),{documents:c,ks:s})))}function QR(t,e,n){let r=t.Ms.get(e)||ye.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ms.set(e,r)}class ax{constructor(){this.activeTargetIds=z2()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YR{constructor(){this.vo=new ax,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ax,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx="ConnectivityMonitor";class cx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ee(lx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ee(lx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yc=null;function Sp(){return Yc===null?Yc=function(){return 268435456+Math.round(2147483648*Math.random())}():Yc++,"0x"+Yc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zh="RestConnection",XR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class ZR{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===td?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,n,r,i,s){const o=Sp(),c=this.Qo(e,n.toUriEncodedString());ee(Zh,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(u,i,s);const{host:d}=new URL(c),f=ea(d);return this.zo(e,c,u,r,f).then(p=>(ee(Zh,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Wo(Zh,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p})}jo(e,n,r,i,s,o){return this.Wo(e,n,r,i,s)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Qo(e,n){const r=XR[e];let i=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="WebChannelConnection",ja=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(i){setTimeout(()=>{throw i},0)}})};class To extends ZR{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!To.c_){const e=mw();ja(e,pw.STAT_EVENT,n=>{n.stat===hp.PROXY?ee(cn,"STAT_EVENT: detected buffering proxy"):n.stat===hp.NOPROXY&&ee(cn,"STAT_EVENT: detected no buffering proxy")}),To.c_=!0}}zo(e,n,r,i,s){const o=Sp();return new Promise((c,u)=>{const d=new hw;d.setWithCredentials(!0),d.listenOnce(fw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case fu.NO_ERROR:const p=d.getResponseJson();ee(cn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case fu.TIMEOUT:ee(cn,`RPC '${e}' ${o} timed out`),u(new Z(U.DEADLINE_EXCEEDED,"Request time out"));break;case fu.HTTP_ERROR:const g=d.getStatus();if(ee(cn,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const C=x==null?void 0:x.error;if(C&&C.status&&C.message){const j=function(b){const y=b.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(y)>=0?y:U.UNKNOWN}(C.status);u(new Z(j,C.message))}else u(new Z(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Z(U.UNAVAILABLE,"Connection failed."));break;default:he(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(cn,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(i);ee(cn,`RPC '${e}' ${o} sending request:`,i),d.send(n,"POST",f,r,15)})}T_(e,n,r){const i=Sp(),s=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=s.join("");ee(cn,`Creating RPC '${e}' stream ${i}: ${d}`,c);const f=o.createWebChannel(d,c);this.I_(f);let p=!1,g=!1;const x=new ek({Ho:C=>{g?ee(cn,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(p||(ee(cn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),ee(cn,`RPC '${e}' stream ${i} sending:`,C),f.send(C))},Jo:()=>f.close()});return ja(f,Wa.EventType.OPEN,()=>{g||(ee(cn,`RPC '${e}' stream ${i} transport opened.`),x.i_())}),ja(f,Wa.EventType.CLOSE,()=>{g||(g=!0,ee(cn,`RPC '${e}' stream ${i} transport closed`),x.o_(),this.E_(f))}),ja(f,Wa.EventType.ERROR,C=>{g||(g=!0,Wo(cn,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),x.o_(new Z(U.UNAVAILABLE,"The operation could not be completed")))}),ja(f,Wa.EventType.MESSAGE,C=>{var j;if(!g){const P=C.data[0];Ue(!!P,16349);const b=P,y=(b==null?void 0:b.error)||((j=b[0])==null?void 0:j.error);if(y){ee(cn,`RPC '${e}' stream ${i} received error:`,y);const I=y.status;let N=function(_){const v=It[_];if(v!==void 0)return Yw(v)}(I),M=y.message;N===void 0&&(N=U.INTERNAL,M="Unknown error status: "+I+" with message "+y.message),g=!0,x.o_(new Z(N,M)),f.close()}else ee(cn,`RPC '${e}' stream ${i} received:`,P),x.__(P)}}),To.u_(),setTimeout(()=>{x.s_()},0),x}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return gw()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(t){return new To(t)}function ef(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(t){return new sR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */To.c_=!1;class dE{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="PersistentStream";class hE{constructor(e,n,r,i,s,o,c,u){this.Ci=e,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dE(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(Xr(n.toString()),Xr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===n&&this.G_(r,i)},r=>{e(()=>{const i=new Z(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(ux,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(ee(ux,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nk extends hE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=lR(this.serializer,e),r=function(s){if(!("targetChange"in s))return ye.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?jr(o.readTime):ye.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Ip(this.serializer),n.addTarget=function(s,o){let c;const u=o.target;if(c=yp(u)?{documents:dR(s,u)}:{query:hR(s,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Zw(s,o.resumeToken);const d=_p(s,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(ye.min())>0){c.readTime=od(s,o.snapshotVersion.toTimestamp());const d=_p(s,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=pR(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Ip(this.serializer),n.removeTarget=e,this.K_(n)}}class rk extends hE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return Ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uR(e.writeResults,e.commitTime),r=jr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Ip(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>cR(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{}class sk extends ik{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Z(U.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,wp(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Z(U.UNKNOWN,s.toString())})}jo(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.jo(e,wp(n,r),i,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function ok(t,e,n,r){return new sk(t,e,n,r)}class ak{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs="RemoteStore";class lk{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Ws(this)&&(ee(Vs,"Restarting streams for network reachability change."),await async function(u){const d=ve(u);d.Ea.add(4),await ac(d),d.Va.set("Unknown"),d.Ea.delete(4),await Jd(d)}(this))})}),this.Va=new ak(r,i)}}async function Jd(t){if(Ws(t))for(const e of t.Ra)await e(!0)}async function ac(t){for(const e of t.Ra)await e(!1)}function fE(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),tg(n)?eg(n):sa(n).O_()&&Zm(n,e))}function Xm(t,e){const n=ve(t),r=sa(n);n.Ia.delete(e),r.O_()&&pE(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ws(n)&&n.Va.set("Unknown"))}function Zm(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}sa(t).Z_(e)}function pE(t,e){t.da.$e(e),sa(t).X_(e)}function eg(t){t.da=new tR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),sa(t).start(),t.Va.ua()}function tg(t){return Ws(t)&&!sa(t).x_()&&t.Ia.size>0}function Ws(t){return ve(t).Ea.size===0}function mE(t){t.da=void 0}async function ck(t){t.Va.set("Online")}async function uk(t){t.Ia.forEach((e,n)=>{Zm(t,e)})}async function dk(t,e){mE(t),tg(t)?(t.Va.ha(e),eg(t)):t.Va.set("Unknown")}async function hk(t,e,n){if(t.Va.set("Online"),e instanceof Xw&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.da.removeTarget(c))}(t,e)}catch(r){ee(Vs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ld(t,r)}else if(e instanceof yu?t.da.Xe(e):e instanceof Jw?t.da.st(e):t.da.tt(e),!n.isEqual(ye.min()))try{const r=await uE(t.localStore);n.compareTo(r)>=0&&await function(s,o){const c=s.da.Tt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=s.Ia.get(d);f&&s.Ia.set(d,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const f=s.Ia.get(u);if(!f)return;s.Ia.set(u,f.withResumeToken(Zt.EMPTY_BYTE_STRING,f.snapshotVersion)),pE(s,u);const p=new ki(f.target,u,d,f.sequenceNumber);Zm(s,p)}),s.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ee(Vs,"Failed to raise snapshot:",r),await ld(t,r)}}async function ld(t,e,n){if(!ia(e))throw e;t.Ea.add(1),await ac(t),t.Va.set("Offline"),n||(n=()=>uE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(Vs,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Jd(t)})}function gE(t,e){return e().catch(n=>ld(t,n,e))}async function Xd(t){const e=ve(t),n=Zi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Vm;for(;fk(e);)try{const i=await GR(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,pk(e,i)}catch(i){await ld(e,i)}yE(e)&&vE(e)}function fk(t){return Ws(t)&&t.Ta.length<10}function pk(t,e){t.Ta.push(e);const n=Zi(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function yE(t){return Ws(t)&&!Zi(t).x_()&&t.Ta.length>0}function vE(t){Zi(t).start()}async function mk(t){Zi(t).ra()}async function gk(t){const e=Zi(t);for(const n of t.Ta)e.ea(n.mutations)}async function yk(t,e,n){const r=t.Ta.shift(),i=qm.from(r,e,n);await gE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Xd(t)}async function vk(t,e){e&&Zi(t).Y_&&await async function(r,i){if(function(o){return X2(o)&&o!==U.ABORTED}(i.code)){const s=r.Ta.shift();Zi(r).B_(),await gE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Xd(r)}}(t,e),yE(t)&&vE(t)}async function dx(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ee(Vs,"RemoteStore received new credentials");const r=Ws(n);n.Ea.add(3),await ac(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Jd(n)}async function xk(t,e){const n=ve(t);e?(n.Ea.delete(2),await Jd(n)):e||(n.Ea.add(2),await ac(n),n.Va.set("Unknown"))}function sa(t){return t.ma||(t.ma=function(n,r,i){const s=ve(n);return s.sa(),new nk(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:ck.bind(null,t),Yo:uk.bind(null,t),t_:dk.bind(null,t),J_:hk.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),tg(t)?eg(t):t.Va.set("Unknown")):(await t.ma.stop(),mE(t))})),t.ma}function Zi(t){return t.fa||(t.fa=function(n,r,i){const s=ve(n);return s.sa(),new rk(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:mk.bind(null,t),t_:vk.bind(null,t),ta:gk.bind(null,t),na:yk.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await Xd(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(Vs,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,c=new ng(e,n,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rg(t,e){if(Xr("AsyncQueue",`${e}: ${t}`),ia(t))return new Z(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{static emptySet(e){return new Ro(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=qa(),this.sortedSet=new dt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ro;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(){this.ga=new dt(se.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):he(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Qo{constructor(e,n,r,i,s,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new Qo(e,n,Ro.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class wk{constructor(){this.queries=fx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=ve(n),s=i.queries;i.queries=fx(),s.forEach((o,c)=>{for(const u of c.ba)u.onError(r)})})(this,new Z(U.ABORTED,"Firestore shutting down"))}}function fx(){return new $s(t=>Vw(t),Wd)}async function xE(t,e){const n=ve(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.Da()&&(r=2):(s=new _k,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const c=rg(o,`Initialization of query '${no(e.query)}' failed`);return void e.onError(c)}n.queries.set(i,s),s.ba.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&ig(n)}async function _E(t,e){const n=ve(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.ba.indexOf(e);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=e.Da()?0:1:!s.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ek(t,e){const n=ve(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const c of o.ba)c.Fa(i)&&(r=!0);o.wa=i}}r&&ig(n)}function Ik(t,e,n){const r=ve(t),i=r.queries.get(e);if(i)for(const s of i.ba)s.onError(n);r.queries.delete(e)}function ig(t){t.Ca.forEach(e=>{e.next()})}var Cp,px;(px=Cp||(Cp={})).Ma="default",px.Cache="cache";class wE{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Qo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Cp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.key=e}}class IE{constructor(e){this.key=e}}class bk{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Re(),this.mutatedKeys=Re(),this.eu=zw(e),this.tu=new Ro(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new hx,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const g=i.get(f),x=qd(this.query,p)?p:null,C=!!g&&this.mutatedKeys.has(g.key),j=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let P=!1;g&&x?g.data.isEqual(x.data)?C!==j&&(r.track({type:3,doc:x}),P=!0):this.su(g,x)||(r.track({type:2,doc:x}),P=!0,(u&&this.eu(x,u)>0||d&&this.eu(x,d)<0)&&(c=!0)):!g&&x?(r.track({type:0,doc:x}),P=!0):g&&!x&&(r.track({type:1,doc:g}),P=!0,(u||d)&&(c=!0)),P&&(x?(o=o.add(x),s=j?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Ss:c,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(x,C){const j=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he(20277,{Vt:P})}};return j(x)-j(C)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),i=i??!1;const c=n&&!i?this._u():[],u=this.Ya.size===0&&this.current&&!i?1:0,d=u!==this.Xa;return this.Xa=u,o.length!==0||d?{snapshot:new Qo(this.query,e.tu,s,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Re(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new IE(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new EE(r))}),n}cu(e){this.Za=e.ks,this.Ya=Re();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Qo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const sg="SyncEngine";class Sk{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Ck{constructor(e){this.key=e,this.hu=!1}}class Ak{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new $s(c=>Vw(c),Wd),this.Iu=new Map,this.Eu=new Set,this.Ru=new dt(se.comparator),this.Au=new Map,this.Vu=new Km,this.du={},this.mu=new Map,this.fu=Ko.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Tk(t,e,n=!0){const r=RE(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await bE(r,e,n,!0),i}async function Rk(t,e){const n=RE(t);await bE(n,e,!0,!1)}async function bE(t,e,n,r){const i=await KR(t.localStore,kr(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let c;return r&&(c=await kk(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&fE(t.remoteStore,i),c}async function kk(t,e,n,r,i){t.pu=(p,g,x)=>async function(j,P,b,y){let I=P.view.ru(b);I.Ss&&(I=await ox(j.localStore,P.query,!1).then(({documents:_})=>P.view.ru(_,I)));const N=y&&y.targetChanges.get(P.targetId),M=y&&y.targetMismatches.get(P.targetId)!=null,B=P.view.applyChanges(I,j.isPrimaryClient,N,M);return gx(j,P.targetId,B.au),B.snapshot}(t,p,g,x);const s=await ox(t.localStore,e,!0),o=new bk(e,s.ks),c=o.ru(s.documents),u=oc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=o.applyChanges(c,t.isPrimaryClient,u);gx(t,n,d.au);const f=new Sk(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function jk(t,e,n){const r=ve(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Wd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Xm(r.remoteStore,i.targetId),Ap(r,i.targetId)}).catch(ra)):(Ap(r,i.targetId),await bp(r.localStore,i.targetId,!0))}async function Dk(t,e){const n=ve(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Xm(n.remoteStore,r.targetId))}async function Nk(t,e,n){const r=Bk(t);try{const i=await function(o,c){const u=ve(o),d=nt.now(),f=c.reduce((x,C)=>x.add(C.key),Re());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let C=Zr(),j=Re();return u.xs.getEntries(x,f).next(P=>{C=P,C.forEach((b,y)=>{y.isValidDocument()||(j=j.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,C)).next(P=>{p=P;const b=[];for(const y of c){const I=G2(y,p.get(y.key).overlayedDocument);I!=null&&b.push(new os(y.key,I,kw(I.value.mapValue),wn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,b,c)}).next(P=>{g=P;const b=P.applyToLocalDocumentSet(p,j);return u.documentOverlayCache.saveOverlays(x,P.batchId,b)})}).then(()=>({batchId:g.batchId,changes:Fw(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let d=o.du[o.currentUser.toKey()];d||(d=new dt(Te)),d=d.insert(c,u),o.du[o.currentUser.toKey()]=d}(r,i.batchId,n),await lc(r,i.changes),await Xd(r.remoteStore)}catch(i){const s=rg(i,"Failed to persist write");n.reject(s)}}async function SE(t,e){const n=ve(t);try{const r=await qR(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Au.get(s);o&&(Ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Ue(o.hu,14607):i.removedDocuments.size>0&&(Ue(o.hu,42227),o.hu=!1))}),await lc(n,r,e)}catch(r){await ra(r)}}function mx(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach((s,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=ve(o);u.onlineState=c;let d=!1;u.queries.forEach((f,p)=>{for(const g of p.ba)g.va(c)&&(d=!0)}),d&&ig(u)}(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Pk(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new dt(se.comparator);o=o.insert(s,hn.newNoDocument(s,ye.min()));const c=Re().add(s),u=new Qd(ye.min(),new Map,new dt(Te),o,c);await SE(r,u),r.Ru=r.Ru.remove(s),r.Au.delete(e),og(r)}else await bp(r.localStore,e,!1).then(()=>Ap(r,e,n)).catch(ra)}async function Ok(t,e){const n=ve(t),r=e.batch.batchId;try{const i=await WR(n.localStore,e);AE(n,r,null),CE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await lc(n,i)}catch(i){await ra(i)}}async function Lk(t,e,n){const r=ve(t);try{const i=await function(o,c){const u=ve(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(Ue(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);AE(r,e,n),CE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await lc(r,i)}catch(i){await ra(i)}}function CE(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function AE(t,e,n){const r=ve(t);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function Ap(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||TE(t,r)})}function TE(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Xm(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),og(t))}function gx(t,e,n){for(const r of n)r instanceof EE?(t.Vu.addReference(r.key,e),Mk(t,r)):r instanceof IE?(ee(sg,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||TE(t,r.key)):he(19791,{wu:r})}function Mk(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(ee(sg,"New document in limbo: "+n),t.Eu.add(r),og(t))}function og(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new se(Je.fromString(e)),r=t.fu.next();t.Au.set(r,new Ck(n)),t.Ru=t.Ru.insert(n,r),fE(t.remoteStore,new ki(kr($m(n.path)),r,"TargetPurposeLimboResolution",Fd.ce))}}async function lc(t,e,n){const r=ve(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){i.push(d);const p=Ym.Es(u.targetId,d);s.push(p)}}))}),await Promise.all(o),r.Pu.J_(i),await async function(u,d){const f=ve(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>q.forEach(d,g=>q.forEach(g.Ts,x=>f.persistence.referenceDelegate.addReference(p,g.targetId,x)).next(()=>q.forEach(g.Is,x=>f.persistence.referenceDelegate.removeReference(p,g.targetId,x)))))}catch(p){if(!ia(p))throw p;ee(Jm,"Failed to update sequence numbers: "+p)}for(const p of d){const g=p.targetId;if(!p.fromCache){const x=f.vs.get(g),C=x.snapshotVersion,j=x.withLastLimboFreeSnapshotVersion(C);f.vs=f.vs.insert(g,j)}}}(r.localStore,s))}async function Vk(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ee(sg,"User change. New user:",e.toKey());const r=await cE(n.localStore,e);n.currentUser=e,function(s,o){s.mu.forEach(c=>{c.forEach(u=>{u.reject(new Z(U.CANCELLED,o))})}),s.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await lc(n,r.Ns)}}function zk(t,e){const n=ve(t),r=n.Au.get(e);if(r&&r.hu)return Re().add(r.key);{let i=Re();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const c=n.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function RE(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Pk.bind(null,e),e.Pu.J_=Ek.bind(null,e.eventManager),e.Pu.yu=Ik.bind(null,e.eventManager),e}function Bk(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ok.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lk.bind(null,e),e}class cd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return $R(this.persistence,new BR,e.initialUser,this.serializer)}Cu(e){return new lE(Qm.Vi,this.serializer)}Du(e){return new YR}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cd.provider={build:()=>new cd};class Fk extends cd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ue(this.persistence.referenceDelegate instanceof ad,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new SR(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Tn.withCacheSize(this.cacheSizeBytes):Tn.DEFAULT;return new lE(r=>ad.Vi(r,n),this.serializer)}}class Tp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>mx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Vk.bind(null,this.syncEngine),await xk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wk}()}createDatastore(e){const n=Yd(e.databaseInfo.databaseId),r=tk(e.databaseInfo);return ok(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,c){return new lk(r,i,s,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>mx(this.syncEngine,n,0),function(){return cx.v()?new cx:new JR}())}createSyncEngine(e,n){return function(i,s,o,c,u,d,f){const p=new Ak(i,s,o,c,u,d);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ve(i);ee(Vs,"RemoteStore shutting down."),s.Ea.add(5),await ac(s),s.Aa.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="FirestoreClient";class Uk{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=i,this.user=un.UNAUTHENTICATED,this.clientId=Mm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ee(es,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(es,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=rg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function tf(t,e){t.asyncQueue.verifyOperationInProgress(),ee(es,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await cE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function yx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await $k(t);ee(es,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>dx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>dx(e.remoteStore,i)),t._onlineComponents=e}async function $k(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(es,"Using user provided OfflineComponentProvider");try{await tf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Wo("Error using user provided cache. Falling back to memory cache: "+n),await tf(t,new cd)}}else ee(es,"Using default OfflineComponentProvider"),await tf(t,new Fk(void 0));return t._offlineComponents}async function jE(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(es,"Using user provided OnlineComponentProvider"),await yx(t,t._uninitializedComponentsProvider._online)):(ee(es,"Using default OnlineComponentProvider"),await yx(t,new Tp))),t._onlineComponents}function Wk(t){return jE(t).then(e=>e.syncEngine)}async function DE(t){const e=await jE(t),n=e.eventManager;return n.onListen=Tk.bind(null,e.syncEngine),n.onUnlisten=jk.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Rk.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Dk.bind(null,e.syncEngine),n}function qk(t,e,n={}){const r=new Hr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,c,u,d){const f=new kE({next:g=>{f.Nu(),o.enqueueAndForget(()=>_E(s,p));const x=g.docs.has(c);!x&&g.fromCache?d.reject(new Z(U.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&u&&u.source==="server"?d.reject(new Z(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new wE($m(c.path),f,{includeMetadataChanges:!0,Ka:!0});return xE(s,p)}(await DE(t),t.asyncQueue,e,n,r)),r.promise}function Hk(t,e,n={}){const r=new Hr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,c,u,d){const f=new kE({next:g=>{f.Nu(),o.enqueueAndForget(()=>_E(s,p)),g.fromCache&&u.source==="server"?d.reject(new Z(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),p=new wE(c,f,{includeMetadataChanges:!0,Ka:!0});return xE(s,p)}(await DE(t),t.asyncQueue,e,n,r)),r.promise}function Gk(t,e){const n=new Hr;return t.asyncQueue.enqueueAndForget(async()=>Nk(await Wk(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="ComponentProvider",vx=new Map;function Qk(t,e,n,r,i){return new m2(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,NE(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE="firestore.googleapis.com",xx=!0;class _x{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=PE,this.ssl=xx}else this.host=e.host,this.ssl=e.ssl??xx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<IR)throw new Z(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}i2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=NE(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _x({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _x(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new KT;switch(r.type){case"firstParty":return new XT(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=vx.get(n);r&&(ee(Kk,"Removing Datastore"),vx.delete(n),r.terminate())}(this),Promise.resolve()}}function Yk(t,e,n,r={}){var d;t=nr(t,Zd);const i=ea(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;i&&(rw(`https://${c}`),iw("Firestore",!0)),s.host!==PE&&s.host!==c&&Wo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:c,ssl:i,emulatorOptions:r};if(!Os(u,o)&&(t._setSettings(u),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=un.MOCK_USER;else{f=vA(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Z(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new un(g)}t._authCredentials=new QT(new vw(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oa(this.firestore,e,this._query)}}class _t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}toJSON(){return{type:_t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(rc(n,_t._jsonSchema))return new _t(e,r||null,new se(Je.fromString(n.referencePath)))}}_t._jsonSchemaVersion="firestore/documentReference/1.0",_t._jsonSchema={type:Ct("string",_t._jsonSchemaVersion),referencePath:Ct("string")};class Wi extends oa{constructor(e,n,r){super(e,n,$m(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new se(e))}withConverter(e){return new Wi(this.firestore,e,this._path)}}function Ke(t,e,...n){if(t=Xt(t),xw("collection","path",e),t instanceof Zd){const r=Je.fromString(e,...n);return Nv(r),new Wi(t,null,r)}{if(!(t instanceof _t||t instanceof Wi))throw new Z(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Je.fromString(e,...n));return Nv(r),new Wi(t.firestore,null,r)}}function me(t,e,...n){if(t=Xt(t),arguments.length===1&&(e=Mm.newId()),xw("doc","path",e),t instanceof Zd){const r=Je.fromString(e,...n);return Dv(r),new _t(t,null,new se(r))}{if(!(t instanceof _t||t instanceof Wi))throw new Z(U.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Je.fromString(e,...n));return Dv(r),new _t(t.firestore,t instanceof Wi?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx="AsyncQueue";class Ex{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dE(this,"async_queue_retry"),this._c=()=>{const r=ef();r&&ee(wx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=ef();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=ef();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Hr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ia(e))throw e;ee(wx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Xr("INTERNAL UNHANDLED ERROR: ",Ix(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=ng.createAndSchedule(this,e,n,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&he(47125,{Pc:Ix(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Ix(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class as extends Zd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Ex,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ex(e),this._firestoreClient=void 0,await e}}}function Jk(t,e){const n=typeof t=="object"?t:lw(),r=typeof t=="string"?t:td,i=Om(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=gA("firestore");s&&Yk(i,...s)}return i}function eh(t){if(t._terminated)throw new Z(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Xk(t),t._firestoreClient}function Xk(t){var r,i,s,o;const e=t._freezeSettings(),n=Qk(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(i=t._app)==null?void 0:i.options.apiKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Uk(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yn(Zt.fromBase64String(e))}catch(n){throw new Z(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yn(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rc(e,Yn._jsonSchema))return Yn.fromBase64String(e.bytes)}}Yn._jsonSchemaVersion="firestore/bytes/1.0",Yn._jsonSchema={type:Ct("string",Yn._jsonSchemaVersion),bytes:Ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Dr._jsonSchemaVersion}}static fromJSON(e){if(rc(e,Dr._jsonSchema))return new Dr(e.latitude,e.longitude)}}Dr._jsonSchemaVersion="firestore/geoPoint/1.0",Dr._jsonSchema={type:Ct("string",Dr._jsonSchemaVersion),latitude:Ct("number"),longitude:Ct("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:gr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rc(e,gr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new gr(e.vectorValues);throw new Z(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}gr._jsonSchemaVersion="firestore/vectorValue/1.0",gr._jsonSchema={type:Ct("string",gr._jsonSchemaVersion),vectorValues:Ct("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk=/^__.*__$/;class ej{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new os(e,this.data,this.fieldMask,n,this.fieldTransforms):new sc(e,this.data,n,this.fieldTransforms)}}class OE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new os(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function LE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he(40011,{dataSource:t})}}class ag{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ag({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const n=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return ud(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(LE(this.dataSource)&&Zk.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class tj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Yd(e)}createContext(e,n,r,i=!1){return new ag({dataSource:e,methodName:n,targetDoc:r,path:Qt.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cc(t){const e=t._freezeSettings(),n=Yd(t._databaseId);return new tj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function lg(t,e,n,r,i,s={}){const o=t.createContext(s.merge||s.mergeFields?2:0,e,n,i);ug("Data must be an object, but it was:",o,r);const c=zE(r,o);let u,d;if(s.merge)u=new Fn(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const p of s.mergeFields){const g=Yo(e,p,n);if(!o.contains(g))throw new Z(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);UE(f,g)||f.push(g)}u=new Fn(f),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new ej(new kn(c),u,d)}class rh extends nh{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rh}}class cg extends nh{_toFieldTransform(e){return new $2(e.path,new Bl)}isEqual(e){return e instanceof cg}}function ME(t,e,n,r){const i=t.createContext(1,e,n);ug("Data must be an object, but it was:",i,r);const s=[],o=kn.empty();ss(r,(u,d)=>{const f=FE(e,u,n);d=Xt(d);const p=i.childContextForFieldPath(f);if(d instanceof rh)s.push(f);else{const g=uc(d,p);g!=null&&(s.push(f),o.set(f,g))}});const c=new Fn(s);return new OE(o,c,i.fieldTransforms)}function VE(t,e,n,r,i,s){const o=t.createContext(1,e,n),c=[Yo(e,r,n)],u=[i];if(s.length%2!=0)throw new Z(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(Yo(e,s[g])),u.push(s[g+1]);const d=[],f=kn.empty();for(let g=c.length-1;g>=0;--g)if(!UE(d,c[g])){const x=c[g];let C=u[g];C=Xt(C);const j=o.childContextForFieldPath(x);if(C instanceof rh)d.push(x);else{const P=uc(C,j);P!=null&&(d.push(x),f.set(x,P))}}const p=new Fn(d);return new OE(f,p,o.fieldTransforms)}function nj(t,e,n,r=!1){return uc(n,t.createContext(r?4:3,e))}function uc(t,e){if(BE(t=Xt(t)))return ug("Unsupported field value:",e,t),zE(t,e);if(t instanceof nh)return function(r,i){if(!LE(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const c of r){let u=uc(c,i.childContextForArray(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Xt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return B2(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=nt.fromDate(r);return{timestampValue:od(i.serializer,s)}}if(r instanceof nt){const s=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:od(i.serializer,s)}}if(r instanceof Dr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yn)return{bytesValue:Zw(i.serializer,r._byteString)};if(r instanceof _t){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Gm(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof gr)return function(o,c){const u=o instanceof gr?o.toArray():o;return{mapValue:{fields:{[Tw]:{stringValue:Rw},[nd]:{arrayValue:{values:u.map(f=>{if(typeof f!="number")throw c.createError("VectorValues must only contain numeric values.");return Wm(c.serializer,f)})}}}}}}(r,i);if(oE(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${Bd(r)}`)}(t,e)}function zE(t,e){const n={};return Ew(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ss(t,(r,i)=>{const s=uc(i,e.childContextForField(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function BE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof nt||t instanceof Dr||t instanceof Yn||t instanceof _t||t instanceof nh||t instanceof gr||oE(t))}function ug(t,e,n){if(!BE(n)||!_w(n)){const r=Bd(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Yo(t,e,n){if((e=Xt(e))instanceof th)return e._internalPath;if(typeof e=="string")return FE(t,e);throw ud("Field path arguments must be of type string or ",t,!1,void 0,n)}const rj=new RegExp("[~\\*/\\[\\]]");function FE(t,e,n){if(e.search(rj)>=0)throw ud(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new th(...e.split("."))._internalPath}catch{throw ud(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ud(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new Z(U.INVALID_ARGUMENT,c+t+u)}function UE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{convertValue(e,n="none"){switch(Xi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ss(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var r,i,s;const n=(s=(i=(r=e.fields)==null?void 0:r[nd].arrayValue)==null?void 0:i.values)==null?void 0:s.map(o=>vt(o.doubleValue));return new gr(n)}convertGeoPoint(e){return new Dr(vt(e.latitude),vt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=$d(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ml(e));default:return null}}convertTimestamp(e){const n=Yi(e);return new nt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Je.fromString(e);Ue(sE(r),9688,{name:e});const i=new Vl(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||Xr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E extends ij{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,n)}}function Fe(){return new cg("serverTimestamp")}const bx="@firebase/firestore",Sx="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Yo("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class sj extends WE{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dg{}class aj extends dg{}function At(t,e,...n){let r=[];e instanceof dg&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof hg).length,c=s.filter(u=>u instanceof ih).length;if(o>1||o>0&&c>0)throw new Z(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ih extends aj{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ih(e,n,r)}_apply(e){const n=this._parse(e);return qE(e._query,n),new oa(e.firestore,e.converter,vp(e._query,n))}_parse(e){const n=cc(e.firestore);return function(s,o,c,u,d,f,p){let g;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Z(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Ax(p,f);const C=[];for(const j of p)C.push(Cx(u,s,j));g={arrayValue:{values:C}}}else g=Cx(u,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Ax(p,f),g=nj(c,o,p,f==="in"||f==="not-in");return St.create(d,f,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ye(t,e,n){const r=e,i=Yo("where",t);return ih._create(i,r,n)}class hg extends dg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new hg(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:vr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const c=s.getFlattenedFilters();for(const u of c)qE(o,u),o=vp(o,u)}(e._query,n),new oa(e.firestore,e.converter,vp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Cx(t,e,n){if(typeof(n=Xt(n))=="string"){if(n==="")throw new Z(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mw(e)&&n.indexOf("/")!==-1)throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Je.fromString(n));if(!se.isDocumentKey(r))throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fv(t,new se(r))}if(n instanceof _t)return Fv(t,n._key);throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bd(n)}.`)}function Ax(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qE(t,e){const n=function(i,s){for(const o of i)for(const c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function fg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ga{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rs extends WE{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Yo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Rs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Rs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Rs._jsonSchema={type:Ct("string",Rs._jsonSchemaVersion),bundleSource:Ct("string","DocumentSnapshot"),bundleName:Ct("string"),bundle:Ct("string")};class vu extends Rs{data(e={}){return super.data(e)}}class ko{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ga(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new vu(this._firestore,this._userDataWriter,r.key,r,new Ga(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const u=new vu(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ga(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{const u=new vu(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Ga(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,f=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:lj(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ko._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Mm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ko._jsonSchemaVersion="firestore/querySnapshot/1.0",ko._jsonSchema={type:Ct("string",ko._jsonSchemaVersion),bundleSource:Ct("string","QuerySnapshot"),bundleName:Ct("string"),bundle:Ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=cc(e)}set(e,n,r){this._verifyNotCommitted();const i=nf(e,this._firestore),s=fg(i.converter,n,r),o=lg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,wn.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=nf(e,this._firestore);let o;return o=typeof(n=Xt(n))=="string"||n instanceof th?VE(this._dataReader,"WriteBatch.update",s._key,n,r,i):ME(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,wn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=nf(e,this._firestore);return this._mutations=this._mutations.concat(new Kd(n._key,wn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Z(U.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nf(t,e){if((t=Xt(t)).firestore!==e)throw new Z(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t){t=nr(t,_t);const e=nr(t.firestore,as),n=eh(e);return qk(n,t._key).then(r=>dj(e,t,r))}function Tt(t){t=nr(t,oa);const e=nr(t.firestore,as),n=eh(e),r=new $E(e);return oj(t._query),Hk(n,t._query).then(i=>new ko(e,r,t,i))}function pn(t,e,n){t=nr(t,_t);const r=nr(t.firestore,as),i=fg(t.converter,e,n),s=cc(r);return dc(r,[lg(s,"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,wn.none())])}function Rt(t,e,n,...r){t=nr(t,_t);const i=nr(t.firestore,as),s=cc(i);let o;return o=typeof(e=Xt(e))=="string"||e instanceof th?VE(s,"updateDoc",t._key,e,n,r):ME(s,"updateDoc",t._key,e),dc(i,[o.toMutation(t._key,wn.exists(!0))])}function uj(t){return dc(nr(t.firestore,as),[new Kd(t._key,wn.none())])}function xo(t,e){const n=nr(t.firestore,as),r=me(t),i=fg(t.converter,e),s=cc(t.firestore);return dc(n,[lg(s,"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,wn.exists(!1))]).then(()=>r)}function dc(t,e){const n=eh(t);return Gk(n,e)}function dj(t,e,n){const r=n.docs.get(e._key),i=new $E(t);return new Rs(t,i,e._key,r,new Ga(n.hasPendingWrites,n.fromCache),e.converter)}function dd(t){return t=nr(t,as),eh(t),new cj(t,e=>dc(t,e))}(function(e,n=!0){GT(ta),$o(new Ls("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),c=new as(new YT(r.getProvider("auth-internal")),new ZT(o,r.getProvider("app-check-internal")),g2(o,i),o);return s={useFetchStreams:n,...s},c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),Ui(bx,Sx,e),Ui(bx,Sx,"esm2020")})();function HE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hj=HE,GE=new tc("auth","Firebase",HE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=new Nm("@firebase/auth");function fj(t,...e){hd.logLevel<=Ae.WARN&&hd.warn(`Auth (${ta}): ${t}`,...e)}function xu(t,...e){hd.logLevel<=Ae.ERROR&&hd.error(`Auth (${ta}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(t,...e){throw pg(t,...e)}function Nr(t,...e){return pg(t,...e)}function KE(t,e,n){const r={...hj(),[e]:n};return new tc("auth","Firebase",r).create(e,{appName:t.name})}function qi(t){return KE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pg(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return GE.create(t,...e)}function pe(t,e,...n){if(!t)throw pg(e,...n)}function $r(t){const e="INTERNAL ASSERTION FAILED: "+t;throw xu(e),new Error(e)}function ti(t,e){t||$r(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function pj(){return Tx()==="http:"||Tx()==="https:"}function Tx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pj()||bA()||"connection"in navigator)?navigator.onLine:!0}function gj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,n){this.shortDelay=e,this.longDelay=n,ti(n>e,"Short delay should be less than long delay!"),this.isMobile=wA()||SA()}get(){return mj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mg(t,e){ti(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$r("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$r("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$r("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xj=new hc(3e4,6e4);function sh(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function aa(t,e,n,r,i={}){return YE(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const c=nc({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...s};return IA()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ea(t.emulatorConfig.host)&&(d.credentials="include"),QE.fetch()(await XE(t,t.config.apiHost,n,c),d)})}async function YE(t,e,n){t._canInitEmulator=!1;const r={...yj,...e};try{const i=new _j(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Jc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const c=s.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jc(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Jc(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Jc(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw KE(t,f,d);ei(t,f)}}catch(i){if(i instanceof ri)throw i;ei(t,"network-request-failed",{message:String(i)})}}async function JE(t,e,n,r,i={}){const s=await aa(t,e,n,r,i);return"mfaPendingCredential"in s&&ei(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function XE(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?mg(t.config,i):`${t.config.apiScheme}://${i}`;return vj.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class _j{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Nr(this.auth,"network-request-failed")),xj.get())})}}function Jc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Nr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wj(t,e){return aa(t,"POST","/v1/accounts:delete",e)}async function fd(t,e){return aa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ej(t,e=!1){const n=Xt(t),r=await n.getIdToken(e),i=gg(r);pe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:cl(rf(i.auth_time)),issuedAtTime:cl(rf(i.iat)),expirationTime:cl(rf(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function rf(t){return Number(t)*1e3}function gg(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return xu("JWT malformed, contained fewer than 3 sections"),null;try{const i=Z1(n);return i?JSON.parse(i):(xu("Failed to decode base64 JWT payload"),null)}catch(i){return xu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Rx(t){const e=gg(t);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $l(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ri&&Ij(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Ij({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=cl(this.lastLoginAt),this.creationTime=cl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(t){var p;const e=t.auth,n=await t.getIdToken(),r=await $l(t,fd(e,{idToken:n}));pe(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=(p=i.providerUserInfo)!=null&&p.length?ZE(i.providerUserInfo):[],o=Cj(t.providerData,s),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new kp(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function Sj(t){const e=Xt(t);await pd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Cj(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function ZE(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(t,e){const n=await YE(t,{},async()=>{const r=nc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await XE(t,i,"/v1/token",`key=${s}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&ea(t.emulatorConfig.host)&&(u.credentials="include"),QE.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Tj(t,e){return aa(t,"POST","/v2/accounts:revokeToken",sh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Rx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const n=Rx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Aj(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new jo;return r&&(pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(pe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(pe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t,e){pe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class hr{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new bj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new kp(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await $l(this,this.stsTokenManager.getToken(this.auth,e));return pe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ej(this,e)}reload(){return Sj(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new hr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await pd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dr(this.auth.app))return Promise.reject(qi(this.auth));const e=await this.getIdToken();return await $l(this,wj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:x,providerData:C,stsTokenManager:j}=n;pe(p&&j,e,"internal-error");const P=jo.fromJSON(this.name,j);pe(typeof p=="string",e,"internal-error"),pi(r,e.name),pi(i,e.name),pe(typeof g=="boolean",e,"internal-error"),pe(typeof x=="boolean",e,"internal-error"),pi(s,e.name),pi(o,e.name),pi(c,e.name),pi(u,e.name),pi(d,e.name),pi(f,e.name);const b=new hr({uid:p,auth:e,email:i,emailVerified:g,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:P,createdAt:d,lastLoginAt:f});return C&&Array.isArray(C)&&(b.providerData=C.map(y=>({...y}))),u&&(b._redirectEventId=u),b}static async _fromIdTokenResponse(e,n,r=!1){const i=new jo;i.updateFromServerResponse(n);const s=new hr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await pd(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];pe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?ZE(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),c=new jo;c.updateFromIdToken(r);const u=new hr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new kp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=new Map;function Wr(t){ti(t instanceof Function,"Expected a class definition");let e=kx.get(t);return e?(ti(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}eI.type="NONE";const jx=eI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(t,e,n){return`firebase:${t}:${e}:${n}`}class Do{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=_u(this.userKey,i.apiKey,s),this.fullPersistenceKey=_u("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await fd(this.auth,{idToken:e}).catch(()=>{});return n?hr._fromGetAccountInfoResponse(this.auth,n,e):null}return hr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Do(Wr(jx),e,r);const i=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=i[0]||Wr(jx);const o=_u(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(o);if(f){let p;if(typeof f=="string"){const g=await fd(e,{idToken:f}).catch(()=>{});if(!g)break;p=await hr._fromGetAccountInfoResponse(e,g,f)}else p=hr._fromJSON(e,f);d!==s&&(c=p),s=d;break}}catch{}const u=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Do(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new Do(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oI(e))return"Blackberry";if(aI(e))return"Webos";if(nI(e))return"Safari";if((e.includes("chrome/")||rI(e))&&!e.includes("edge/"))return"Chrome";if(sI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function tI(t=gn()){return/firefox\//i.test(t)}function nI(t=gn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rI(t=gn()){return/crios\//i.test(t)}function iI(t=gn()){return/iemobile/i.test(t)}function sI(t=gn()){return/android/i.test(t)}function oI(t=gn()){return/blackberry/i.test(t)}function aI(t=gn()){return/webos/i.test(t)}function yg(t=gn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Rj(t=gn()){var e;return yg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function kj(){return CA()&&document.documentMode===10}function lI(t=gn()){return yg(t)||sI(t)||aI(t)||oI(t)||/windows phone/i.test(t)||iI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t,e=[]){let n;switch(t){case"Browser":n=Dx(gn());break;case"Worker":n=`${Dx(gn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ta}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,c)=>{try{const u=e(s);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(t,e={}){return aa(t,"GET","/v2/passwordPolicy",sh(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=6;class Pj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Nj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Nx(this),this.idTokenSubscription=new Nx(this),this.beforeStateQueue=new jj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wr(n)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Do.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await fd(this,{idToken:e}),r=await hr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(dr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,c=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await pd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dr(this.app))return Promise.reject(qi(this));const n=e?Xt(e):null;return n&&pe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dr(this.app)?Promise.reject(qi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dr(this.app)?Promise.reject(qi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Dj(this),n=new Pj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Tj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wr(e)||this._popupRedirectResolver;pe(n,this,"argument-error"),this.redirectPersistenceManager=await Do.create(this,[Wr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&fj(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function oh(t){return Xt(t)}class Nx{constructor(e){this.auth=e,this.observer=null,this.addObserver=PA(n=>this.observer=n)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Lj(t){vg=t}function Mj(t){return vg.loadJS(t)}function Vj(){return vg.gapiScript}function zj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t,e){const n=Om(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Os(s,e??{}))return i;ei(i,"already-initialized")}return n.initialize({options:e})}function Fj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Uj(t,e,n){const r=oh(t);pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=uI(e),{host:o,port:c}=$j(e),u=c===null?"":`:${c}`,d={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){pe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),pe(Os(d,r.config.emulator)&&Os(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,ea(o)?(rw(`${s}//${o}${u}`),iw("Auth",!0)):Wj()}function uI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $j(t){const e=uI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Px(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Px(o)}}}function Px(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Wj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $r("not implemented")}_getIdTokenResponse(e){return $r("not implemented")}_linkToIdToken(e,n){return $r("not implemented")}_getReauthenticationResolver(e){return $r("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t,e){return JE(t,"POST","/v1/accounts:signInWithIdp",sh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj="http://localhost";class zs extends dI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ei("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new zs(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return No(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,No(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,No(e,n)}buildRequest(){const e={requestUri:qj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=nc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc extends hI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends fc{constructor(){super("facebook.com")}static credential(e){return zs._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ii.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends fc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return zs._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return bi.credential(n,r)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends fc{constructor(){super("github.com")}static credential(e){return zs._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.GITHUB_SIGN_IN_METHOD="github.com";Si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends fc{constructor(){super("twitter.com")}static credential(e,n){return zs._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ci.credential(n,r)}catch{return null}}}Ci.TWITTER_SIGN_IN_METHOD="twitter.com";Ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hj(t,e){return JE(t,"POST","/v1/accounts:signUp",sh(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await hr._fromIdTokenResponse(e,r,i),o=Ox(r);return new ts({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Ox(r);return new ts({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Ox(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gj(t){var i;if(dr(t.app))return Promise.reject(qi(t));const e=oh(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new ts({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await Hj(e,{returnSecureToken:!0}),r=await ts._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md extends ri{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,md.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new md(e,n,r,i)}}function fI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?md._fromErrorAndOperation(t,s,e,r):s})}async function Kj(t,e,n=!1){const r=await $l(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ts._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(t,e,n=!1){const{auth:r}=t;if(dr(r.app))return Promise.reject(qi(r));const i="reauthenticate";try{const s=await $l(t,fI(r,i,e,t),n);pe(s.idToken,r,"internal-error");const o=gg(s.idToken);pe(o,r,"internal-error");const{sub:c}=o;return pe(t.uid===c,r,"user-mismatch"),ts._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ei(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yj(t,e,n=!1){if(dr(t.app))return Promise.reject(qi(t));const r="signIn",i=await fI(t,r,e),s=await ts._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function Jj(t,e,n,r){return Xt(t).onIdTokenChanged(e,n,r)}function Xj(t,e,n){return Xt(t).beforeAuthStateChanged(e,n)}const gd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(gd,"1"),this.storage.removeItem(gd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj=1e3,eD=10;class mI extends pI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);kj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,eD):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Zj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}mI.type="LOCAL";const tD=mI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI extends pI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}gI.type="SESSION";const yI=gI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new ah(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(o).map(async d=>d(n.origin,s)),u=await nD(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ah.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{const d=xg("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function iD(t){Pr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vI(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function sD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function aD(){return vI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="firebaseLocalStorageDb",lD=1,yd="firebaseLocalStorage",_I="fbase_key";class pc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function lh(t,e){return t.transaction([yd],e?"readwrite":"readonly").objectStore(yd)}function cD(){const t=indexedDB.deleteDatabase(xI);return new pc(t).toPromise()}function jp(){const t=indexedDB.open(xI,lD);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(yd,{keyPath:_I})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(yd)?e(r):(r.close(),await cD(),e(await jp()))})})}async function Lx(t,e,n){const r=lh(t,!0).put({[_I]:e,value:n});return new pc(r).toPromise()}async function uD(t,e){const n=lh(t,!1).get(e),r=await new pc(n).toPromise();return r===void 0?null:r.value}function Mx(t,e){const n=lh(t,!0).delete(e);return new pc(n).toPromise()}const dD=800,hD=3;class wI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>hD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ah._getInstance(aD()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await sD(),!this.activeServiceWorker)return;this.sender=new rD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jp();return await Lx(e,gd,"1"),await Mx(e,gd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Lx(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>uD(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=lh(i,!1).getAll();return new pc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wI.type="LOCAL";const fD=wI;new hc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(t,e){return e?Wr(e):(pe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g extends dI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return No(e,this._buildIdpRequest())}_linkToIdToken(e,n){return No(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return No(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function mD(t){return Yj(t.auth,new _g(t),t.bypassAuthState)}function gD(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),Qj(n,new _g(t),t.bypassAuthState)}async function yD(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),Kj(n,new _g(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mD;case"linkViaPopup":case"linkViaRedirect":return yD;case"reauthViaPopup":case"reauthViaRedirect":return gD;default:ei(this.auth,"internal-error")}}resolve(e){ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new hc(2e3,1e4);class _o extends EI{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,_o.currentPopupAction&&_o.currentPopupAction.cancel(),_o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){ti(this.filter.length===1,"Popup operations only handle one event");const e=xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vD.get())};e()}}_o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="pendingRedirect",wu=new Map;class _D extends EI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=wu.get(this.auth._key());if(!e){try{const r=await wD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}wu.set(this.auth._key(),e)}return this.bypassAuthState||wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wD(t,e){const n=bD(e),r=ID(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function ED(t,e){wu.set(t._key(),e)}function ID(t){return Wr(t._redirectPersistence)}function bD(t){return _u(xD,t.config.apiKey,t.name)}async function SD(t,e,n=!1){if(dr(t.app))return Promise.reject(qi(t));const r=oh(t),i=pD(r,e),o=await new _D(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD=10*60*1e3;class AD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TD(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!II(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Nr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=CD&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vx(e))}saveEventToCache(e){this.cachedEventUids.add(Vx(e)),this.lastProcessedEventTime=Date.now()}}function Vx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function II({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return II(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RD(t,e={}){return aa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jD=/^https?/;async function DD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await RD(t);for(const n of e)try{if(ND(n))return}catch{}ei(t,"unauthorized-domain")}function ND(t){const e=Rp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!jD.test(n))return!1;if(kD.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new hc(3e4,6e4);function zx(){const t=Pr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function OD(t){return new Promise((e,n)=>{var i,s,o;function r(){zx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zx(),n(Nr(t,"network-request-failed"))},timeout:PD.get()})}if((s=(i=Pr().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=Pr().gapi)!=null&&o.load)r();else{const c=zj("iframefcb");return Pr()[c]=()=>{gapi.load?r():n(Nr(t,"network-request-failed"))},Mj(`${Vj()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw Eu=null,e})}let Eu=null;function LD(t){return Eu=Eu||OD(t),Eu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=new hc(5e3,15e3),VD="__/auth/iframe",zD="emulator/auth/iframe",BD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},FD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function UD(t){const e=t.config;pe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?mg(e,zD):`https://${t.config.authDomain}/${VD}`,r={apiKey:e.apiKey,appName:t.name,v:ta},i=FD.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${nc(r).slice(1)}`}async function $D(t){const e=await LD(t),n=Pr().gapi;return pe(n,t,"internal-error"),e.open({where:document.body,url:UD(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BD,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Nr(t,"network-request-failed"),c=Pr().setTimeout(()=>{s(o)},MD.get());function u(){Pr().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qD=500,HD=600,GD="_blank",KD="http://localhost";class Bx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function QD(t,e,n,r=qD,i=HD){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...WD,width:r.toString(),height:i.toString(),top:s,left:o},d=gn().toLowerCase();n&&(c=rI(d)?GD:n),tI(d)&&(e=e||KD,u.scrollbars="yes");const f=Object.entries(u).reduce((g,[x,C])=>`${g}${x}=${C},`,"");if(Rj(d)&&c!=="_self")return YD(e||"",c),new Bx(null);const p=window.open(e||"",c,f);pe(p,t,"popup-blocked");try{p.focus()}catch{}return new Bx(p)}function YD(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD="__/auth/handler",XD="emulator/auth/handler",ZD=encodeURIComponent("fac");async function Fx(t,e,n,r,i,s){pe(t.config.authDomain,t,"auth-domain-config-required"),pe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ta,eventId:i};if(e instanceof hI){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",NA(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof fc){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${ZD}=${encodeURIComponent(u)}`:"";return`${eN(t)}?${nc(c).slice(1)}${d}`}function eN({config:t}){return t.emulator?mg(t,XD):`https://${t.authDomain}/${JD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="webStorageSupport";class tN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yI,this._completeRedirectFn=SD,this._overrideRedirectResult=ED}async _openPopup(e,n,r,i){var o;ti((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await Fx(e,n,r,Rp(),i);return QD(e,s,xg())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Fx(e,n,r,Rp(),i);return iD(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ti(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await $D(e),r=new AD(e);return n.register("authEvent",i=>(pe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(sf,{type:sf},i=>{var o;const s=(o=i==null?void 0:i[0])==null?void 0:o[sf];s!==void 0&&n(!!s),ei(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=DD(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return lI()||nI()||yg()}}const nN=tN;var Ux="@firebase/auth",$x="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sN(t){$o(new Ls("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cI(t)},d=new Oj(r,i,s,u);return Fj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),$o(new Ls("auth-internal",e=>{const n=oh(e.getProvider("auth").getImmediate());return(r=>new rN(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ui(Ux,$x,iN(t)),Ui(Ux,$x,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN=5*60,aN=nw("authIdTokenMaxAge")||oN;let Wx=null;const lN=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>aN)return;const i=n==null?void 0:n.token;Wx!==i&&(Wx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function cN(t=lw()){const e=Om(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Bj(t,{popupRedirectResolver:nN,persistence:[fD,tD,yI]}),r=nw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=lN(s.toString());Xj(n,o,()=>o(n.currentUser)),Jj(n,c=>o(c))}}const i=ew("auth");return i&&Uj(n,`http://${i}`),n}function uN(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Lj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Nr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",uN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sN("Browser");const dN={apiKey:"AIzaSyAgJyk3_wGde1-QM4nuuvAo3pnhqJs7Zts",authDomain:"les-londor-enterprise-system.firebaseapp.com",projectId:"les-londor-enterprise-system",storageBucket:"les-londor-enterprise-system.firebasestorage.app",messagingSenderId:"505326457231",appId:"1:505326457231:web:e17e3f024828bec6f0bbfa"},bI=aw(dN),X=Jk(bI),hN=cN(bI);Gj(hN).then(()=>{console.log("Conexin annima establecida con Firebase")}).catch(t=>{console.error("Error al establecer conexin annima:",t)});const Xc="domains",Da="domain_values",qx=[{id:"dom_origen",code:"ORIGEN",name:"Origen de la Pieza",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_legal",code:"ESTADO_LEGAL",name:"Estado Legal",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_material",code:"MATERIAL",name:"Material Principal",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_ley",code:"LEY_QUILATAJE",name:"Ley / Quilataje",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_color_metal",code:"COLOR_METAL",name:"Color del Metal",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_tipo_piedra",code:"TIPO_PIEDRA",name:"Tipo de Piedra",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_color_piedra",code:"COLOR_PIEDRA",name:"Color de la Piedra",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_pureza",code:"PUREZA",name:"Pureza",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_forma_piedra",code:"FORMA_PIEDRA",name:"Forma de la Piedra",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_acabado",code:"ACABADO",name:"Acabado",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_engaste",code:"TIPO_ENGASTE",name:"Tipo de Engaste",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_tecnica",code:"TECNICA_ESPECIAL",name:"Tcnica Especial",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_personalizacion",code:"TIPO_PERSONALIZACION",name:"Tipo de Personalizacin",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_publico",code:"PUBLICO_OBJETIVO",name:"Pblico Objetivo",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_uso",code:"USO",name:"Uso",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_estado_ope",code:"ESTADO_OPERATIVO",name:"Estado Operativo",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_ubicacion",code:"UBICACION",name:"Ubicacin Actual",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_iva",code:"IVA",name:"IVA Aplicable",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_tipo_conjunto",code:"TIPO_CONJUNTO",name:"Tipo de Conjunto",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_motivo",code:"MOTIVO_ESPECIAL",name:"Motivo Especial",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_linea",code:"COMMERCIAL_LINE",name:"Lnea Comercial",type:"CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_coleccion",code:"COLLECTION",name:"Coleccin",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_perfil_cli",code:"CUSTOMER_PROFILE",name:"Perfil de Cliente",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_simbol",code:"SYMBOLOGY",name:"Simbologa",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dom_ocasion",code:"OCCASION",name:"Ocasin / Motivo",type:"SEMI_CLOSED",isActive:!0,createdAt:new Date,createdBy:"system"}],fN=[{id:"dv_og_new",domainId:"dom_origen",value:"Nueva",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_og_re",domainId:"dom_origen",value:"Recompra",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_mat_oro",domainId:"dom_material",value:"Oro",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_mat_plata",domainId:"dom_material",value:"Plata",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_ley_18k",domainId:"dom_ley",value:"18k",sortOrder:3,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_col_ama",domainId:"dom_color_metal",value:"Amarillo",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_col_bla",domainId:"dom_color_metal",value:"Blanco",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_line_nup",domainId:"dom_linea",value:"Nupcial",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_line_juv",domainId:"dom_linea",value:"Juvenil",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_line_alt",domainId:"dom_linea",value:"Alta Joyera",sortOrder:3,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_line_dai",domainId:"dom_linea",value:"Daily Wear",sortOrder:4,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_sim_amo",domainId:"dom_simbol",value:"Amor",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_sim_inf",domainId:"dom_simbol",value:"Infinito",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_sim_pro",domainId:"dom_simbol",value:"Proteccin",sortOrder:3,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_occ_com",domainId:"dom_ocasion",value:"Compromiso",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_occ_ani",domainId:"dom_ocasion",value:"Aniversario",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_occ_gra",domainId:"dom_ocasion",value:"Graduacin",sortOrder:3,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_occ_qui",domainId:"dom_ocasion",value:"15 Aos",sortOrder:4,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_pro_rom",domainId:"dom_perfil_cli",value:"Romntico",sortOrder:1,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_pro_min",domainId:"dom_perfil_cli",value:"Minimalista",sortOrder:2,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_pro_cla",domainId:"dom_perfil_cli",value:"Clsico",sortOrder:3,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"dv_pro_tre",domainId:"dom_perfil_cli",value:"Trendsetter",sortOrder:4,source:"NORMATIVE",isActive:!0,createdAt:new Date,createdBy:"system"}],Ft={getDomains:async()=>{const t=At(Ke(X,Xc),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){for(const n of qx)await pn(me(X,Xc,n.id),{...n,createdAt:Fe()});return qx}return e.docs.map(n=>({...n.data(),id:n.id}))},getValuesByDomain:async t=>{const e=At(Ke(X,Da),Ye("domainId","==",t),Ye("isActive","==",!0)),n=await Tt(e);if(n.empty){const i=fN.filter(s=>s.domainId===t);for(const s of i)await pn(me(X,Da,s.id),{...s,createdAt:Fe()});return i}return n.docs.map(i=>({...i.data(),id:i.id})).sort((i,s)=>(i.sortOrder||0)-(s.sortOrder||0))},createDomain:async t=>{const e=`dom_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return await pn(me(X,Xc,e),n),{...n,id:e,createdAt:new Date}},addValue:async t=>{const e=`val_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return await pn(me(X,Da,e),n),{...n,id:e,createdAt:new Date}},updateDomain:async(t,e)=>{const n=me(X,Xc,t);await Rt(n,e);const r=await En(n);if(r.exists())return{...r.data(),id:r.id}},updateValue:async(t,e)=>{const n=me(X,Da,t);await Rt(n,e);const r=await En(n);if(r.exists())return{...r.data(),id:r.id}},deleteValueLogic:async t=>{const e=me(X,Da,t);try{return await Rt(e,{isActive:!1}),!0}catch{return!1}}},Na="attributes",Hx=[{id:"attr_mat_pri",name:"Material Principal",description:"Metal base de la pieza",dataType:"LIST",domainId:"dom_material",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_ley",name:"Ley / Quilataje",description:"Pureza del metal precioso",dataType:"LIST",domainId:"dom_ley",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_col_met",name:"Color del Metal",description:"Tonalidad del metal",dataType:"LIST",domainId:"dom_color_metal",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_pes_ex",name:"Peso Exacto",description:"Peso real en gramos",dataType:"NUMBER",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_tip_pie",name:"Tipo de Piedra",description:"Gema o piedra principal",dataType:"LIST",domainId:"dom_tipo_piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_col_pie",name:"Color de la Piedra",description:"Tonalidad de la gema",dataType:"LIST",domainId:"dom_color_piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_pureza",name:"Pureza",description:"Grado de pureza de la piedra",dataType:"LIST",domainId:"dom_pureza",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_for_pie",name:"Forma de la Piedra",description:"Corte o talla de la gema",dataType:"LIST",domainId:"dom_forma_piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_acabado",name:"Acabado",description:"Tratamiento superficial del metal",dataType:"LIST",domainId:"dom_acabado",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_engaste",name:"Tipo de Engaste",description:"Mtodo de sujecin de piedras",dataType:"LIST",domainId:"dom_engaste",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_origen",name:"Origen de la pieza",description:"Procedencia de entrada al stock",dataType:"LIST",domainId:"dom_origen",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_legal",name:"Estado legal",description:"Situacin jurdica de la pieza",dataType:"LIST",domainId:"dom_legal",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_publico",name:"Pblico objetivo",description:"Segmento de cliente",dataType:"LIST",domainId:"dom_publico",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_uso",name:"Uso / Ocasin",description:"Contexto de uso recomendado",dataType:"LIST",domainId:"dom_uso",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"attr_iva",name:"IVA Aplicable",description:"Rgimen fiscal",dataType:"LIST",domainId:"dom_iva",isActive:!0,createdAt:new Date,createdBy:"system"}],ji={getAll:async()=>{const t=At(Ke(X,Na),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){for(const n of Hx)await pn(me(X,Na,n.id),{...n,createdAt:Fe()});return Hx}return e.docs.map(n=>{var r;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},create:async t=>{if(t.dataType==="LIST"&&!t.domainId)throw new Error("Un atributo de tipo LISTA debe tener un dominio asociado.");const e=`attr_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return n.domainId===void 0&&delete n.domainId,await pn(me(X,Na,e),n),{...n,id:e,createdAt:new Date}},update:async(t,e)=>{var s;const n=me(X,Na,t),r={...e};Object.keys(r).forEach(o=>{r[o]===void 0&&delete r[o]}),await Rt(n,r);const i=await En(n);if(i.exists())return{...i.data(),id:i.id,createdAt:(s=i.data().createdAt)==null?void 0:s.toDate()}},deleteLogic:async t=>{const e=me(X,Na,t);try{return await Rt(e,{isActive:!1}),!0}catch{return!1}}},SI=()=>{var D,T,fe,Qe,He,Ne,K;const[t,e]=R.useState(null),[n,r]=R.useState(null),[i,s]=R.useState(!1),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,p]=R.useState(null),[g,x]=R.useState("attributes"),[C,j]=R.useState({name:"",description:"",dataType:"TEXT",domainId:"",newValue:"",newSortOrder:1,newJustification:""}),[P,b]=R.useState([]),[y,I]=R.useState([]),[N,M]=R.useState([]);R.useEffect(()=>{B()},[]);const B=async()=>{try{const[O,Q]=await Promise.all([Ft.getDomains(),ji.getAll()]);b(O),I(Q)}catch(O){console.error("Error loading domains/attributes:",O)}};R.useEffect(()=>{if(t){const O=y.find(Q=>Q.id===t);O!=null&&O.domainId?r(O.domainId):r(null)}},[t,y]),R.useEffect(()=>{(async()=>{if(n){const Q=await Ft.getValuesByDomain(n);M(Q)}else M([])})()},[n]);const _=(O,Q)=>{var xe;c(O),O==="attr_edit"&&Q?(d(Q),j({...C,name:Q.name,description:Q.description||"",dataType:Q.dataType,domainId:Q.domainId||""})):O==="dom_new"?j({...C,name:"",description:"CLOSED",dataType:"TEXT",domainId:""}):O==="val_edit"&&Q?(p(Q),j({...C,newValue:Q.value,newSortOrder:Q.sortOrder,newJustification:Q.justification||""})):j({name:"",description:"",dataType:"TEXT",domainId:((xe=P[0])==null?void 0:xe.id)||"",newValue:"",newSortOrder:N.length+1,newJustification:""}),s(!0)},v=async()=>{try{if(o==="attr_edit"&&u?await ji.update(u.id,{name:C.name,description:C.description,dataType:C.dataType,domainId:C.dataType==="LIST"?C.domainId:void 0}):o==="attr_new"?await ji.create({name:C.name,description:C.description,dataType:C.dataType,domainId:C.dataType==="LIST"?C.domainId:void 0,createdBy:"user"}):o==="val_new"&&n?await Ft.addValue({domainId:n,value:C.newValue,sortOrder:Number(C.newSortOrder),source:"USER_ADDED",justification:C.newJustification,createdBy:"user"}):o==="val_edit"&&f?await Ft.updateValue(f.id,{value:C.newValue,sortOrder:Number(C.newSortOrder),justification:C.newJustification}):o==="dom_new"&&await Ft.createDomain({name:C.name,code:C.name.toUpperCase().replace(/\s+/g,"_"),type:C.description,createdBy:"admin"}),await B(),n){const O=await Ft.getValuesByDomain(n);M(O)}s(!1)}catch(O){alert(O.message)}},S=async O=>{const Q=y.find(xe=>xe.id===O);Q&&window.confirm(`Seguro que desea eliminar el atributo "${Q.name}" del catlogo maestro?`)&&window.confirm(`ATENCIN: Esta accin es IRREVERSIBLE y podra afectar a las categoras que usan este atributo.

EST ABSOLUTAMENTE SEGURO de querer borrarlo?`)&&(await ji.deleteLogic(O),await B(),t===O&&e(null))},A=async(O,Q)=>{if(window.confirm(`Seguro que desea eliminar el valor "${Q}" de este dominio?`)&&window.confirm(`Confirme nuevamente: Est seguro de borrar "${Q}"?`)&&(await Ft.deleteValueLogic(O),n)){const xe=await Ft.getValuesByDomain(n);M(xe)}},k=()=>i?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100,padding:"20px"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"100%",maxWidth:"500px",backgroundColor:"white",boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:[a.jsx("h2",{style:{marginBottom:"24px"},children:o==="attr_edit"?"Editar Atributo":o==="attr_new"?"Nuevo Atributo":o==="dom_new"?"Nuevo Dominio Maestro":o==="val_edit"?"Editar Valor":"Aadir Valor al Dominio"}),(o==null?void 0:o.startsWith("attr"))&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Nombre"}),a.jsx("input",{className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.name,onChange:O=>j({...C,name:O.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Descripcin"}),a.jsx("textarea",{className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd",minHeight:"80px"},value:C.description,onChange:O=>j({...C,description:O.target.value})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Tipo de Dato"}),a.jsxs("select",{className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.dataType,onChange:O=>j({...C,dataType:O.target.value}),children:[a.jsx("option",{value:"TEXT",children:"TEXT"}),a.jsx("option",{value:"NUMBER",children:"NUMBER"}),a.jsx("option",{value:"BOOLEAN",children:"BOOLEAN"}),a.jsx("option",{value:"LIST",children:"LIST (Dominio)"}),a.jsx("option",{value:"RANGE",children:"RANGE"}),a.jsx("option",{value:"DATE",children:"DATE"})]})]}),C.dataType==="LIST"&&a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Dominio Asociado"}),a.jsxs("select",{className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.domainId,onChange:O=>j({...C,domainId:O.target.value}),children:[a.jsx("option",{value:"",children:"Seleccionar..."}),P.map(O=>a.jsx("option",{value:O.id,children:O.name},O.id))]})]})]})]}),o==="dom_new"&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Nombre del Dominio"}),a.jsx("input",{className:"form-control",placeholder:"Ej: Tipos de Cierre, Calidades de Gema...",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.name,onChange:O=>j({...C,name:O.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Tipo de Gobernanza"}),a.jsxs("select",{className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.description,onChange:O=>j({...C,description:O.target.value}),children:[a.jsx("option",{value:"CLOSED",children:"CERRADO (Solo Admin aade valores)"}),a.jsx("option",{value:"SEMI_CLOSED",children:"SEMI-CERRADO (Joyero puede sugerir con justificacin)"})]})]}),a.jsxs("p",{style:{fontSize:"12px",color:"var(--text-muted)",backgroundColor:"#f8f9fa",padding:"12px",borderRadius:"8px"},children:[a.jsx("strong",{children:"Tip:"})," Un dominio es un diccionario reutilizable. Una vez creado, podrs vincularlo a uno o ms atributos."]})]}),(o==null?void 0:o.startsWith("val"))&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Valor"}),a.jsx("input",{className:"form-control",placeholder:"Ej: Oro Rosa",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.newValue,onChange:O=>j({...C,newValue:O.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Orden"}),a.jsx("input",{type:"number",className:"form-control",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd"},value:C.newSortOrder,onChange:O=>j({...C,newSortOrder:Number(O.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:600},children:"Justificacin (Requerida por Anexo D)"}),a.jsx("textarea",{className:"form-control",placeholder:"Indique por qu es necesario este nuevo valor...",style:{width:"100%",padding:"10px",borderRadius:"8px",border:"1px solid #ddd",minHeight:"80px"},value:C.newJustification,onChange:O=>j({...C,newJustification:O.target.value})})]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"32px"},children:[a.jsx("button",{className:"btn",onClick:()=>s(!1),children:"Cancelar"}),a.jsx("button",{className:"btn btn-primary",onClick:v,children:"Guardar Cambios"})]})]})}):null;return a.jsxs("div",{className:"container",style:{paddingBottom:"60px"},children:[a.jsxs("div",{style:{backgroundColor:"rgba(52, 152, 219, 0.05)",border:"1px solid rgba(52, 152, 219, 0.1)",padding:"16px 24px",borderRadius:"12px",marginBottom:"24px",display:"flex",gap:"20px",alignItems:"center"},children:[a.jsx(As,{size:20,color:"var(--primary)"}),a.jsxs("div",{style:{fontSize:"13px",color:"#555",lineHeight:"1.5"},children:[a.jsx("strong",{children:"Gua rpida:"})," El ",a.jsx("strong",{children:"Atributo"})," es el campo tcnico (ej: ",a.jsx("em",{children:'"Acabado"'}),"). El ",a.jsx("strong",{children:"Dominio"})," es la lista de opciones (ej: ",a.jsx("em",{children:'"Lista de Acabados"'}),": Pulido, Mate...). Varios atributos pueden compartir el mismo dominio para mantener la consistencia."]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"32px"},children:[a.jsxs("div",{children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Torre de Control de Atributos"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Gestin tcnica del catlogo de datos LES"})]}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsxs("button",{className:`btn ${g==="attributes"?"btn-accent":""}`,onClick:()=>x("attributes"),style:{border:g==="attributes"?"none":"1px solid #ddd"},children:[a.jsx(rp,{size:18})," Catlogo de Atributos"]}),a.jsxs("button",{className:`btn ${g==="domains"?"btn-accent":""}`,onClick:()=>x("domains"),style:{border:g==="domains"?"none":"1px solid #ddd"},children:[a.jsx(_s,{size:16})," Dominios Maestros"]})]}),g==="attributes"?a.jsxs("button",{className:"btn btn-primary",onClick:()=>_("attr_new"),children:[a.jsx(Ot,{size:18})," Nuevo Atributo"]}):a.jsxs("button",{className:"btn btn-primary",onClick:()=>_("dom_new"),children:[a.jsx(Ot,{size:18})," Nuevo Dominio"]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) minmax(300px, 1fr) minmax(400px, 1.5fr)",gap:"24px",alignItems:"start"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:g==="attributes"?"Atributos Tcnicos":"Dominios de Datos"}),a.jsx(Ju,{size:16,color:"var(--primary)",opacity:.5})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:g==="attributes"?y.map(O=>a.jsxs("div",{className:`selection-card ${t===O.id?"active":""}`,onClick:()=>e(O.id),style:{padding:"16px",borderRadius:"12px",backgroundColor:t===O.id?"var(--primary)":"white",color:t===O.id?"white":"var(--text-main)",cursor:"pointer",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid rgba(0,0,0,0.05)",boxShadow:t===O.id?"0 8px 16px rgba(52, 152, 219, 0.2)":"none"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx(rp,{size:16,opacity:.7}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:O.name}),a.jsx("div",{style:{fontSize:"10px",opacity:.7},children:O.dataType})]})]}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:Q=>{Q.stopPropagation(),_("attr_edit",O)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",opacity:.6},title:"Editar Atributo",children:a.jsx(Pl,{size:14})}),a.jsx("button",{onClick:Q=>{Q.stopPropagation(),S(O.id)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",opacity:.6},title:"Eliminar Atributo",children:a.jsx(Zn,{size:14})})]})]},O.id)):P.map(O=>a.jsx("div",{className:`selection-card ${n===O.id?"active":""}`,onClick:()=>r(O.id),style:{padding:"16px",borderRadius:"12px",backgroundColor:n===O.id?"var(--primary)":"white",color:n===O.id?"white":"var(--text-main)",cursor:"pointer",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid rgba(0,0,0,0.05)",boxShadow:n===O.id?"0 8px 16px rgba(52, 152, 219, 0.2)":"none"},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx(_s,{size:16,opacity:.7}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:O.name}),a.jsx("div",{style:{fontSize:"10px",opacity:.7},children:"DOMINIO"})]})]})},O.id))})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Dominio de Datos"}),a.jsx(_s,{size:16,color:"var(--primary)",opacity:.5})]}),t||g==="domains"&&n?a.jsx("div",{children:g==="attributes"&&((D=y.find(O=>O.id===t))==null?void 0:D.dataType)==="LIST"||g==="domains"?a.jsxs("div",{style:{padding:"20px",borderRadius:"16px",backgroundColor:"white",border:"1px solid var(--primary-light)",textAlign:"center"},children:[a.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"rgba(52, 152, 219, 0.1)",color:"var(--primary)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:a.jsx(_s,{size:24})}),a.jsx("h3",{style:{fontSize:"16px",marginBottom:"4px"},children:((T=P.find(O=>O.id===n))==null?void 0:T.name)||"Sin Dominio"}),a.jsx("p",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"16px"},children:(fe=P.find(O=>O.id===n))==null?void 0:fe.code}),a.jsx("div",{style:{fontSize:"11px",backgroundColor:((Qe=P.find(O=>O.id===n))==null?void 0:Qe.type)==="CLOSED"?"#ebf5fb":"#fff8e1",color:((He=P.find(O=>O.id===n))==null?void 0:He.type)==="CLOSED"?"#3498db":"#f39c12",padding:"4px 12px",borderRadius:"20px",display:"inline-block",fontWeight:700},children:(Ne=P.find(O=>O.id===n))==null?void 0:Ne.type}),g==="domains"&&a.jsxs("div",{style:{marginTop:"24px",textAlign:"left"},children:[a.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),a.jsx("h5",{style:{fontSize:"10px",color:"var(--text-muted)",marginBottom:"12px",letterSpacing:"0.5px"},children:"USO EN CATLOGO GLOBAL"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[y.filter(O=>O.domainId===n).map(O=>a.jsxs("div",{style:{fontSize:"11px",padding:"6px 10px",borderRadius:"6px",backgroundColor:"#f8f9fa",border:"1px solid #f1f1f1",display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(Ju,{size:12,opacity:.5}),O.name]},O.id)),y.filter(O=>O.domainId===n).length===0&&a.jsx("p",{style:{fontSize:"11px",color:"#ccc",fontStyle:"italic",margin:0},children:"Sin atributos vinculados."})]})]})]}):a.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",opacity:.5},children:[a.jsx(As,{size:32,style:{margin:"0 auto 12px"}}),a.jsx("p",{style:{fontSize:"13px"},children:"Este atributo no utiliza una lista de dominio cerrada."}),a.jsxs("span",{style:{fontSize:"11px"},children:["Tipo: ",(K=y.find(O=>O.id===t))==null?void 0:K.dataType]})]})}):a.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",opacity:.3},children:[a.jsx(_s,{size:32,style:{margin:"0 auto 12px"}}),a.jsx("p",{style:{fontSize:"13px"},children:g==="attributes"?"Seleccione un atributo para ver su configuracin de dominio.":"Seleccione un dominio para gestionar sus valores maestros."})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Valores Permitidos"}),n&&a.jsxs("button",{className:"btn btn-primary btn-sm",style:{padding:"4px 12px",fontSize:"11px"},onClick:()=>_("val_new"),children:[a.jsx(Ot,{size:14})," Aadir"]})]}),n?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:N.map((O,Q)=>a.jsxs("div",{style:{padding:"12px 16px",borderRadius:"12px",backgroundColor:"white",border:"1px solid #f1f1f1",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#999",width:"20px"},children:O.sortOrder}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:O.value}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[O.source==="NORMATIVE"?a.jsx("div",{style:{fontSize:"9px",color:"#1abc9c",fontWeight:700},children:"NORMATIVO"}):a.jsx("div",{style:{fontSize:"9px",color:"#f39c12",fontWeight:700},children:"MANUAL"}),O.justification&&a.jsxs("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontStyle:"italic",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(As,{size:10})," ",O.justification]})]})]})]}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:()=>_("val_edit",O),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer",opacity:.5},title:"Editar Valor",children:a.jsx(Pl,{size:12})}),a.jsx("button",{onClick:()=>A(O.id,O.value),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer",opacity:.5},title:"Eliminar Valor",children:a.jsx(Zn,{size:12})})]})]},O.id))}):a.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",opacity:.3},children:[a.jsx(G1,{size:32,style:{margin:"0 auto 12px"}}),a.jsx("p",{style:{fontSize:"13px"},children:"Gestione aqu los valores del dominio seleccionado."})]})]})]}),k()]})},Xs="locations",Gx=[{id:"loc_1",name:"Tienda Principal",address:"Calle Mayor 1",type:"STORE",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"loc_2",name:"Almacn Central",address:"Polgono Ind.",type:"OTHER",isActive:!0,createdAt:new Date,createdBy:"system"}],xs={getAll:async()=>{const t=At(Ke(X,Xs),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){for(const n of Gx)await pn(me(X,Xs,n.id),{...n,createdAt:Fe()});return Gx}return e.docs.map(n=>{var r;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},getById:async t=>{var r;const e=me(X,Xs,t),n=await En(e);if(n.exists()&&n.data().isActive)return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}},create:async t=>{const e=`loc_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return await pn(me(X,Xs,e),n),{...n,id:e,createdAt:new Date}},update:async(t,e)=>{var i;const n=me(X,Xs,t);await Rt(n,e);const r=await En(n);if(r.exists())return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate()}},deleteLogic:async t=>{const e=me(X,Xs,t);try{return await Rt(e,{isActive:!1}),!0}catch{return!1}}},Pa="operational_statuses",Kx=[{id:"stat_available",name:"Disponible",color:"#10b981",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"stat_sold",name:"Vendido",color:"#ef4444",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"stat_reserved",name:"Reservado",color:"#f59e0b",isActive:!0,createdAt:new Date,createdBy:"system"}],Ka={getAll:async()=>{const t=At(Ke(X,Pa),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){for(const n of Kx)await pn(me(X,Pa,n.id),{...n,createdAt:Fe()});return Kx}return e.docs.map(n=>{var r;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},create:async t=>{const e=`stat_${Date.now()}`,n={name:t,color:"#9b59b6",isActive:!0,createdAt:Fe()};return await pn(me(X,Pa,e),n),{...n,id:e,createdAt:new Date}},update:async(t,e)=>{var i;const n=me(X,Pa,t);await Rt(n,{name:e});const r=await En(n);if(r.exists())return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate()}},deleteLogic:async t=>{const e=me(X,Pa,t);try{return await Rt(e,{isActive:!1}),!0}catch{return!1}}},mi="inventory",fr={getAll:async()=>{const t=At(Ke(X,mi),Ye("isActive","==",!0));return(await Tt(t)).docs.map(n=>{var r,i;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate(),updatedAt:(i=n.data().updatedAt)==null?void 0:i.toDate()}})},getById:async t=>{var r,i;const e=me(X,mi,t),n=await En(e);if(n.exists()&&n.data().isActive)return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate(),updatedAt:(i=n.data().updatedAt)==null?void 0:i.toDate()}},getByCode:async t=>{var r,i;const e=At(Ke(X,mi),Ye("itemCode","==",t),Ye("isActive","==",!0)),n=await Tt(e);if(!n.empty){const s=n.docs[0];return{...s.data(),id:s.id,createdAt:(r=s.data().createdAt)==null?void 0:r.toDate(),updatedAt:(i=s.data().updatedAt)==null?void 0:i.toDate()}}},generateItemCode:async()=>{const e=`LD-${new Date().getFullYear()}-`,n=At(Ke(X,mi),Ye("itemCode",">=",e),Ye("itemCode","<=",e+"")),r=await Tt(n);let i=0;r.forEach(o=>{const c=o.data().itemCode;if(c&&c.startsWith(e)){const u=c.substring(e.length),d=parseInt(u,10);!isNaN(d)&&d>i&&(i=d)}});const s=i+1;return`${e}${s.toString().padStart(4,"0")}`},create:async t=>{let e=t.itemCode;e||(e=await fr.generateItemCode());const n=await xo(Ke(X,mi),{...t,itemCode:e,isActive:!0,createdAt:Fe(),updatedAt:Fe()}),r=n.id,i=`https://les.londor.com/i/${r}`;return await Rt(n,{qrCode:i}),{...(await En(n)).data(),id:r,qrCode:i,createdAt:new Date,updatedAt:new Date}},update:async(t,e)=>{var i,s;const n=me(X,mi,t);await Rt(n,{...e,updatedAt:Fe()});const r=await En(n);if(r.exists())return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate(),updatedAt:(s=r.data().updatedAt)==null?void 0:s.toDate()}},deleteLogic:async t=>{const e=me(X,mi,t);try{return await Rt(e,{isActive:!1,updatedAt:Fe()}),!0}catch{return!1}},getByLocation:async t=>{const e=At(Ke(X,mi),Ye("locationId","==",t),Ye("isActive","==",!0));return(await Tt(e)).docs.map(r=>{var i,s;return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate(),updatedAt:(s=r.data().updatedAt)==null?void 0:s.toDate()}})}},pN=[{key:"monday",label:"Lunes"},{key:"tuesday",label:"Martes"},{key:"wednesday",label:"Mircoles"},{key:"thursday",label:"Jueves"},{key:"friday",label:"Viernes"},{key:"saturday",label:"Sbado"},{key:"sunday",label:"Domingo"}],mN=({location:t,onBack:e,onSave:n})=>{var st;const[r,i]=R.useState("orders"),[s,o]=R.useState(!1),[c,u]=R.useState({...t}),[d,f]=R.useState(0),[p,g]=R.useState(!1),[x,C]=R.useState(""),[j,P]=R.useState(!1),[b,y]=R.useState({pieceId:"",workType:"ENGASTE"}),[I,N]=R.useState([]),[M,B]=R.useState(!1),[_,v]=R.useState("info"),[S,A]=R.useState(!1),[k,D]=R.useState(!1),[T,fe]=R.useState({date:"",label:"",isClosed:!0}),Qe=[{id:"1",name:"Vitrina Principal A",details:["Iluminacin LED clida","Cristal reforzado 10mm","Sensor de proximidad"]},{id:"2",name:"Boutique Alta Gama",details:["Cierre electrnico biomtrico","Iluminacin focalizada","Exhibicin vertical"]},{id:"3",name:"Escaparate Exterior",details:["Cristal blindado Nivel 1","Proteccin UV","Iluminacin 24/7"]},{id:"4",name:"Caja Fuerte / Stock",details:["Proteccin Ignfuga","Acceso restringido auditado","Control humedad"]}],He=((st=c.metadata)==null?void 0:st.showcases)||Qe;Kt.useEffect(()=>{u({...t}),o(!1),f(0),t.type==="STORE"&&Ne()},[t.id]);const Ne=async()=>{B(!0);try{const H=await fr.getByLocation(t.id);N(H)}catch(H){console.error("Error fetching store inventory:",H)}finally{B(!1)}},K=()=>{if(!x.trim())return;const H={id:Date.now().toString(),name:x,details:["Nueva Vitrina"]},Ie=[...He,H];u({...c,metadata:{...c.metadata,showcases:Ie,showcasesCount:Ie.length}}),C(""),g(!1),f(Ie.length-1)},O=(H,Ie)=>{const de=[...He];de[H]={...de[H],details:Ie},u({...c,metadata:{...c.metadata,showcases:de}})},Q=["Pulido","Engaste","Grabado","Ajuste de Talla","Reparacin General","Limpieza"],xe=H=>{var et;const Ie=((et=c.metadata)==null?void 0:et.specialties)||[],de=Ie.includes(H)?Ie.filter(We=>We!==H):[...Ie,H];u({...c,metadata:{...c.metadata,specialties:de}})},ue=()=>{var de;if(!T.date||!T.label)return;const H={id:Date.now().toString(),...T},Ie=((de=c.metadata)==null?void 0:de.specialDates)||[];u({...c,metadata:{...c.metadata,specialDates:[...Ie,H]}}),fe({date:"",label:"",isClosed:!0}),D(!1)},Ze=H=>{var de;const Ie=((de=c.metadata)==null?void 0:de.specialDates)||[];u({...c,metadata:{...c.metadata,specialDates:Ie.filter(et=>et.id!==H)}})},$e=()=>{n(c),o(!1)},kt=()=>{var H,Ie,de,et,We;return a.jsxs("div",{className:"glass-card",style:{padding:"32px",display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--accent)"},children:[a.jsx(Dl,{size:24}),a.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:"Informacin del Taller"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Nombre del Taller"}),a.jsx("input",{className:"form-control",disabled:!s,value:c.name,onChange:Ce=>u({...c,name:Ce.target.value}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Persona de Contacto"}),a.jsx("input",{className:"form-control",disabled:!s,value:((H=c.metadata)==null?void 0:H.contactPerson)||"",onChange:Ce=>u({...c,metadata:{...c.metadata,contactPerson:Ce.target.value}}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Telfono Fijo"}),a.jsx("input",{className:"form-control",disabled:!s,value:((Ie=c.metadata)==null?void 0:Ie.phoneFixed)||"",onChange:Ce=>u({...c,metadata:{...c.metadata,phoneFixed:Ce.target.value}}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Telfono Mvil"}),a.jsx("input",{className:"form-control",disabled:!s,value:((de=c.metadata)==null?void 0:de.phoneMobile)||"",onChange:Ce=>u({...c,metadata:{...c.metadata,phoneMobile:Ce.target.value}}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee"}})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Email"}),a.jsx("input",{className:"form-control",disabled:!s,value:((et=c.metadata)==null?void 0:et.email)||"",onChange:Ce=>u({...c,metadata:{...c.metadata,email:Ce.target.value}}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Direccin"}),a.jsx("textarea",{className:"form-control",disabled:!s,rows:3,value:((We=c.metadata)==null?void 0:We.address)||"",onChange:Ce=>u({...c,metadata:{...c.metadata,address:Ce.target.value}}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #eee",resize:"none"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"16px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Especialidades"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:Q.map(Ce=>{var we,F,re,ge,be,$;return a.jsxs("div",{onClick:()=>s&&xe(Ce),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px",borderRadius:"8px",border:"1px solid #eee",backgroundColor:(F=(we=c.metadata)==null?void 0:we.specialties)!=null&&F.includes(Ce)?"rgba(241, 196, 15, 0.1)":"white",color:(ge=(re=c.metadata)==null?void 0:re.specialties)!=null&&ge.includes(Ce)?"#d4ac0d":"var(--text-main)",cursor:s?"pointer":"default",fontSize:"13px",fontWeight:500,transition:"all 0.2s"},children:[a.jsx(G1,{size:16,color:($=(be=c.metadata)==null?void 0:be.specialties)!=null&&$.includes(Ce)?"#f1c40f":"#ddd"}),Ce]},Ce)})})]}),a.jsx("button",{className:"btn",onClick:()=>alert(`Desactivando ${c.name}...`),style:{width:"100%",marginTop:"20px",backgroundColor:"#ffdada",color:"#c0392b",justifyContent:"center"},children:"Desactivar Taller"})]})},ze=()=>{var H,Ie;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"32px"},children:[kt(),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"6px",borderRadius:"12px",display:"inline-flex",alignSelf:"flex-start"},children:[a.jsx("button",{className:`btn-sm ${r==="orders"?"btn-primary":""}`,onClick:()=>i("orders"),style:{border:"none",background:r==="orders"?"var(--primary)":"transparent",color:r==="orders"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"rdenes Activas"}),a.jsx("button",{className:`btn-sm ${r==="history"?"btn-primary":""}`,onClick:()=>i("history"),style:{border:"none",background:r==="history"?"var(--primary)":"transparent",color:r==="history"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Historial de Servicios"}),a.jsx("button",{className:`btn-sm ${r==="docs"?"btn-primary":""}`,onClick:()=>i("docs"),style:{border:"none",background:r==="docs"?"var(--primary)":"transparent",color:r==="docs"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Documentacin"})]}),a.jsxs("div",{className:"glass-card",style:{padding:0,overflow:"hidden"},children:[a.jsxs("div",{style:{padding:"24px 32px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("h3",{style:{margin:0},children:"Piezas en Taller"}),a.jsxs("button",{className:"btn btn-primary btn-sm",style:{padding:"8px 16px"},onClick:()=>P(!0),children:[a.jsx(Ot,{size:16})," Nueva Orden"]})]}),a.jsx("div",{style:{padding:"20px 32px"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{textAlign:"left",borderBottom:"2px solid #f8f8f8"},children:[a.jsx("th",{style:{padding:"12px 0",fontSize:"11px",color:"var(--text-muted)",fontWeight:800},children:"ID PIEZA"}),a.jsx("th",{style:{padding:"12px 0",fontSize:"11px",color:"var(--text-muted)",fontWeight:800},children:"DESCRIPCIN"}),a.jsx("th",{style:{padding:"12px 0",fontSize:"11px",color:"var(--text-muted)",fontWeight:800},children:"TIPO DE TRABAJO"}),a.jsx("th",{style:{padding:"12px 0",fontSize:"11px",color:"var(--text-muted)",fontWeight:800},children:"ESTADO"}),a.jsx("th",{style:{padding:"12px 0",fontSize:"11px",color:"var(--text-muted)",fontWeight:800},children:"FECHA ENTREGA"}),a.jsx("th",{})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{style:{borderBottom:"1px solid #f8f8f8"},children:[a.jsx("td",{style:{padding:"20px 0",fontWeight:700,fontSize:"14px"},children:"#LD-4592"}),a.jsx("td",{children:"Anillo de compromiso 18K"}),a.jsx("td",{children:a.jsx("span",{style:{fontSize:"10px",fontWeight:800,padding:"4px 8px",borderRadius:"4px",backgroundColor:"#f4f4f4"},children:"ENGASTE"})}),a.jsx("td",{children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[a.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#f1c40f"}})," En proceso"]})}),a.jsx("td",{children:"12 Oct, 2023"}),a.jsx("td",{children:a.jsx(qh,{size:18,color:"#ccc"})})]}),a.jsxs("tr",{style:{borderBottom:"1px solid #f8f8f8"},children:[a.jsx("td",{style:{padding:"20px 0",fontWeight:700,fontSize:"14px"},children:"#LD-8821"}),a.jsx("td",{children:"Brazalete rgido oro blanco"}),a.jsx("td",{children:a.jsx("span",{style:{fontSize:"10px",fontWeight:800,padding:"4px 8px",borderRadius:"4px",backgroundColor:"#f4f4f4"},children:"PULIDO"})}),a.jsx("td",{children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[a.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#e67e22"}})," Retrasado"]})}),a.jsx("td",{style:{color:"var(--error)"},children:"08 Oct, 2023"}),a.jsx("td",{children:a.jsx(qh,{size:18,color:"#ccc"})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"20px 0",fontWeight:700,fontSize:"14px"},children:"#LD-1029"}),a.jsx("td",{children:"Pendientes Brillantes 1.2ct"}),a.jsx("td",{children:a.jsx("span",{style:{fontSize:"10px",fontWeight:800,padding:"4px 8px",borderRadius:"4px",backgroundColor:"#f4f4f4"},children:"REPARACIN"})}),a.jsx("td",{children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[a.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#2ecc71"}})," Listo para entrega"]})}),a.jsx("td",{children:"15 Oct, 2023"}),a.jsx("td",{children:a.jsx(qh,{size:18,color:"#ccc"})})]})]})]})})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"24px",backgroundColor:"#fcfcfc"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:800,color:"var(--text-muted)"},children:"RDENES TOTALES"}),a.jsx("div",{style:{fontSize:"1.8rem",fontWeight:800,marginTop:"8px"},children:"124"})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px",backgroundColor:"#fcfcfc"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:800,color:"var(--text-muted)"},children:"TIEMPO PROMEDIO"}),a.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:800,marginTop:"8px"},children:[((H=t.metadata)==null?void 0:H.slaDays)||4.2," Das"]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px",backgroundColor:"#fcfcfc"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:800,color:"var(--text-muted)"},children:"CALIFICACIN"}),a.jsxs("div",{style:{fontSize:"1.8rem",fontWeight:800,marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[((Ie=t.metadata)==null?void 0:Ie.rating)||4.8," ",a.jsx(rA,{size:20,fill:"#f1c40f",color:"#f1c40f"})]})]})]}),a.jsxs("div",{className:"glass-card",style:{backgroundColor:"#111",padding:"24px 32px",display:"flex",justifyContent:"space-between",alignItems:"center",color:"white"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[a.jsx("div",{style:{width:"48px",height:"48px",backgroundColor:"var(--accent)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)"},children:a.jsx(pv,{size:24})}),a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1.1rem"},children:"Contrato de Servicios 2024"}),a.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"13px",opacity:.7},children:"Tarifas preferenciales y SLAs de entrega actualizados."})]})]}),a.jsx("button",{className:"btn",style:{background:"transparent",border:"1px solid rgba(255,255,255,0.2)",color:"white"},onClick:()=>alert("Abriendo Contrato de Servicios..."),children:"Ver PDF"})]})]})]})},it=()=>{var de,et,We,Ce,we,F,re,ge,be;const H=He[d],Ie=I.filter($=>$.showcaseId===(H==null?void 0:H.id));return a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"6px",borderRadius:"12px",display:"inline-flex",alignSelf:"flex-start"},children:[a.jsx("button",{className:`btn-sm ${_==="info"?"btn-primary":""}`,onClick:()=>v("info"),style:{border:"none",background:_==="info"?"var(--primary)":"transparent",color:_==="info"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Informacin"}),a.jsx("button",{className:`btn-sm ${_==="schedule"?"btn-primary":""}`,onClick:()=>v("schedule"),style:{border:"none",background:_==="schedule"?"var(--primary)":"transparent",color:_==="schedule"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Horarios y Calendario"}),a.jsx("button",{className:`btn-sm ${_==="showcases"?"btn-primary":""}`,onClick:()=>v("showcases"),style:{border:"none",background:_==="showcases"?"var(--primary)":"transparent",color:_==="showcases"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Vitrinas y Operacin"}),a.jsx("button",{className:`btn-sm ${_==="general_stock"?"btn-primary":""}`,onClick:()=>v("general_stock"),style:{border:"none",background:_==="general_stock"?"var(--primary)":"transparent",color:_==="general_stock"?"white":"var(--text-muted)",padding:"8px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Stock General"})]}),_==="info"&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"32px",display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--accent)"},children:[a.jsx(sp,{size:24}),a.jsx("h3",{style:{margin:0},children:"Contacto y Ubicacin"})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Responsable / Gerente"}),a.jsx("input",{className:"form-control",disabled:!s,value:((de=c.metadata)==null?void 0:de.managerName)||"",onChange:$=>u({...c,metadata:{...c.metadata,managerName:$.target.value}}),style:{width:"100%"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Correo Electrnico"}),a.jsx("input",{className:"form-control",disabled:!s,value:((et=c.metadata)==null?void 0:et.email)||"",onChange:$=>u({...c,metadata:{...c.metadata,email:$.target.value}}),style:{width:"100%"}})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Tel. Fijo"}),a.jsx("input",{className:"form-control",disabled:!s,value:((We=c.metadata)==null?void 0:We.phoneFixed)||"",onChange:$=>u({...c,metadata:{...c.metadata,phoneFixed:$.target.value}}),style:{width:"100%"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Tel. Mvil"}),a.jsx("input",{className:"form-control",disabled:!s,value:((Ce=c.metadata)==null?void 0:Ce.phoneMobile)||"",onChange:$=>u({...c,metadata:{...c.metadata,phoneMobile:$.target.value}}),style:{width:"100%"}})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600,color:"var(--text-muted)"},children:"Direccin Fsica"}),a.jsx("textarea",{className:"form-control",disabled:!s,rows:3,value:((we=c.metadata)==null?void 0:we.address)||"",onChange:$=>u({...c,metadata:{...c.metadata,address:$.target.value}}),style:{width:"100%",resize:"none"}})]})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"32px",display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--text-muted)"},children:[a.jsx(pv,{size:24}),a.jsx("h3",{style:{margin:0},children:"Notas Adicionales"})]}),a.jsx("textarea",{className:"form-control",disabled:!s,rows:10,value:((F=c.metadata)==null?void 0:F.managerNotes)||"",onChange:$=>u({...c,metadata:{...c.metadata,managerNotes:$.target.value}}),placeholder:"Notas internas para la gestin de la tienda...",style:{width:"100%",padding:"16px",borderRadius:"12px",border:"1px solid #eee",resize:"none",flex:1}})]})]}),_==="schedule"&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(400px, 1fr) 2fr",gap:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"32px"},children:[a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--accent)"},children:[a.jsx(Dm,{size:24}),a.jsx("h3",{style:{margin:0},children:"Horarios Semanales"})]})}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:pN.map($=>{var _e,W,oe,ce,wt,en;const le=((W=(_e=c.metadata)==null?void 0:_e.businessHours)==null?void 0:W[$.key])||{morning:{open:"10:00",close:"14:00",isClosed:!1},afternoon:{open:"17:00",close:"20:30",isClosed:!1}};return a.jsxs("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:"#f9f9f9",border:"1px solid #eee"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("span",{style:{fontSize:"13px",fontWeight:800,textTransform:"uppercase"},children:$.label}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:s&&a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",fontWeight:600,cursor:"pointer"},children:[a.jsx("input",{type:"checkbox",checked:le.isClosed,onChange:mt=>{var Ve;const gt=((Ve=c.metadata)==null?void 0:Ve.businessHours)||{};u({...c,metadata:{...c.metadata,businessHours:{...gt,[$.key]:{...le,isClosed:mt.target.checked}}}})}}),"CERRADO"]})})]}),le.isClosed?a.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--error)",fontSize:"12px",fontWeight:700},children:"ESTABLECIMIENTO CERRADO"}):a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"12px"},children:[a.jsx("span",{style:{color:"var(--text-muted)",fontWeight:600},children:"MAANA:"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"time",disabled:!s,value:(oe=le.morning)==null?void 0:oe.open,className:"form-control-sm",onChange:mt=>{var at;const gt=((at=c.metadata)==null?void 0:at.businessHours)||{},Ve=gt[$.key]||le;u({...c,metadata:{...c.metadata,businessHours:{...gt,[$.key]:{...Ve,morning:{...Ve.morning,open:mt.target.value}}}}})}}),a.jsx("span",{children:"-"}),a.jsx("input",{type:"time",disabled:!s,value:(ce=le.morning)==null?void 0:ce.close,className:"form-control-sm",onChange:mt=>{var at;const gt=((at=c.metadata)==null?void 0:at.businessHours)||{},Ve=gt[$.key]||le;u({...c,metadata:{...c.metadata,businessHours:{...gt,[$.key]:{...Ve,morning:{...Ve.morning,close:mt.target.value}}}}})}})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"12px"},children:[a.jsx("span",{style:{color:"var(--text-muted)",fontWeight:600},children:"TARDE:"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"time",disabled:!s,value:(wt=le.afternoon)==null?void 0:wt.open,className:"form-control-sm",onChange:mt=>{var at;const gt=((at=c.metadata)==null?void 0:at.businessHours)||{},Ve=gt[$.key]||le;u({...c,metadata:{...c.metadata,businessHours:{...gt,[$.key]:{...Ve,afternoon:{...Ve.afternoon,open:mt.target.value}}}}})}}),a.jsx("span",{children:"-"}),a.jsx("input",{type:"time",disabled:!s,value:(en=le.afternoon)==null?void 0:en.close,className:"form-control-sm",onChange:mt=>{var at;const gt=((at=c.metadata)==null?void 0:at.businessHours)||{},Ve=gt[$.key]||le;u({...c,metadata:{...c.metadata,businessHours:{...gt,[$.key]:{...Ve,afternoon:{...Ve.afternoon,close:mt.target.value}}}}})}})]})]})]})]},$.key)})})]}),a.jsxs("div",{className:"glass-card",style:{padding:"32px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--accent)"},children:[a.jsx(jm,{size:24}),a.jsx("h3",{style:{margin:0},children:"Das Festivos y Cierres Especiales"})]}),a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>D(!0),disabled:!s,children:[a.jsx(Ot,{size:16})," Aadir Fecha"]})]}),k&&a.jsxs("div",{className:"glass-card",style:{padding:"20px",backgroundColor:"#fcfcfc",border:"1px solid var(--primary)",marginBottom:"24px"},children:[a.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:"14px"},children:"Nueva Fecha Especial"}),a.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"flex-end"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:800,color:"var(--text-muted)",marginBottom:"4px"},children:"FECHA"}),a.jsx("input",{type:"date",className:"form-control",value:T.date,onChange:$=>fe({...T,date:$.target.value})})]}),a.jsxs("div",{style:{flex:2},children:[a.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:800,color:"var(--text-muted)",marginBottom:"4px"},children:"DESCRIPCIN"}),a.jsx("input",{className:"form-control",placeholder:"Ej: Festivo Local / Inventario",value:T.label,onChange:$=>fe({...T,label:$.target.value})})]}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{className:"btn btn-primary",onClick:ue,children:a.jsx(tA,{size:16})}),a.jsx("button",{className:"btn",onClick:()=>D(!1),children:a.jsx(Br,{size:16})})]})]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:(((re=c.metadata)==null?void 0:re.specialDates)||[]).length===0?a.jsx("div",{style:{gridColumn:"1/-1",padding:"40px",textAlign:"center",backgroundColor:"#f9f9f9",borderRadius:"12px",border:"1px dashed #ddd",color:"var(--text-muted)"},children:"No hay fechas especiales registradas para este ao."}):(((ge=c.metadata)==null?void 0:ge.specialDates)||[]).sort(($,le)=>$.date.localeCompare(le.date)).map($=>a.jsxs("div",{style:{padding:"16px 20px",borderRadius:"12px",backgroundColor:"white",border:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[a.jsxs("div",{style:{textAlign:"center",minWidth:"50px"},children:[a.jsx("div",{style:{fontSize:"10px",fontWeight:800,color:"var(--primary)",textTransform:"uppercase"},children:new Date($.date).toLocaleDateString("es-ES",{month:"short"})}),a.jsx("div",{style:{fontSize:"1.4rem",fontWeight:800},children:new Date($.date).getDate()+1})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:"14px"},children:$.label}),a.jsx("div",{style:{fontSize:"11px",color:"var(--error)",fontWeight:600},children:"CIERRE TOTAL"})]})]}),s&&a.jsx(Zn,{size:16,color:"var(--error)",style:{cursor:"pointer",opacity:.6},onClick:()=>Ze($.id)})]},$.id))})]})]}),_==="showcases"&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"300px 350px 1fr",gap:"32px",alignItems:"start"},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Gestin de Vitrinas"}),a.jsx(Ot,{size:16,color:"var(--primary)",style:{cursor:"pointer"},onClick:()=>g(!0)})]}),p&&a.jsxs("div",{style:{marginBottom:"24px",display:"flex",gap:"8px"},children:[a.jsx("input",{className:"form-control",autoFocus:!0,placeholder:"Nombre vitrina",value:x,onChange:$=>C($.target.value),onKeyDown:$=>$.key==="Enter"&&K(),style:{flex:1,fontSize:"12px",padding:"8px"}}),a.jsx("button",{className:"btn btn-primary btn-sm",onClick:K,children:"OK"})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:He.map(($,le)=>a.jsxs("div",{onClick:()=>f(le),style:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:le===d?"var(--primary)":"transparent",color:le===d?"white":"var(--text-main)",transition:"all 0.2s",border:"1px solid transparent"},onMouseEnter:_e=>le!==d&&(_e.currentTarget.style.backgroundColor="#f9f9f9"),onMouseLeave:_e=>le!==d&&(_e.currentTarget.style.backgroundColor="transparent"),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx(Nl,{size:16,opacity:.7}),a.jsx("span",{style:{fontWeight:600},children:$.name})]}),a.jsx(H1,{size:16,opacity:.5})]},$.id||le))})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)",marginBottom:"16px"},children:"Seguridad"}),a.jsxs("select",{className:"form-control",disabled:!s,value:((be=c.metadata)==null?void 0:be.securityLevel)||"MEDIUM",onChange:$=>u({...c,metadata:{...c.metadata,securityLevel:$.target.value}}),style:{width:"100%",fontSize:"13px",padding:"8px"},children:[a.jsx("option",{value:"LOW",children:"Bsica"}),a.jsx("option",{value:"MEDIUM",children:"Estndar"}),a.jsx("option",{value:"HIGH",children:"Alta"}),a.jsx("option",{value:"ELITE",children:"Mxima"})]})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:0,overflow:"hidden"},children:[a.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("h4",{style:{margin:0},children:"Stock en Vitrina"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s&&!S&&a.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>A(!0),style:{fontSize:"11px",padding:"4px 12px"},children:[a.jsx(Ot,{size:14})," Asignar Pieza"]}),a.jsxs("span",{style:{fontSize:"11px",fontWeight:800,backgroundColor:"#f4f4f4",padding:"4px 8px",borderRadius:"4px"},children:[Ie.length," PIEZAS"]})]})]}),S&&a.jsxs("div",{style:{padding:"20px 24px",backgroundColor:"#f9f9f9",borderBottom:"1px solid #eee"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h5",{style:{margin:0,fontSize:"12px",textTransform:"uppercase",letterSpacing:"1px"},children:"Seleccionar Pieza Aprobada"}),a.jsx("button",{className:"btn-icon",onClick:()=>A(!1),children:a.jsx(Br,{size:14})})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"250px",overflowY:"auto",paddingRight:"12px"},children:I.filter($=>!$.showcaseId).length===0?a.jsx("div",{style:{padding:"16px",textAlign:"center",fontSize:"12px",color:"var(--text-muted)"},children:"No hay piezas disponibles para asignar en esta ubicacin."}):I.filter($=>!$.showcaseId).map($=>{var le;return a.jsxs("div",{onClick:async()=>{try{const _e={showcaseId:H==null?void 0:H.id};$.isApproved||(_e.isApproved=!0),await fr.update($.id,_e),A(!1),Ne()}catch(_e){console.error("Error assigning item:",_e)}},style:{padding:"10px 14px",backgroundColor:"white",border:"1px solid #eee",borderRadius:"10px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s"},onMouseEnter:_e=>{_e.currentTarget.style.borderColor="var(--primary)",_e.currentTarget.style.transform="translateX(4px)"},onMouseLeave:_e=>{_e.currentTarget.style.borderColor="#eee",_e.currentTarget.style.transform="translateX(0)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:"1px solid #eee"},children:(le=$.images)!=null&&le[0]?a.jsx("img",{src:$.images[0],alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):a.jsx(Ao,{size:16,color:"#ccc"})}),a.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:800,color:"var(--primary)"},children:$.itemCode}),!$.isApproved&&a.jsx("span",{style:{fontSize:"8px",fontWeight:800,backgroundColor:"#fdedec",color:"#e74c3c",padding:"1px 4px",borderRadius:"3px"},children:"PENDIENTE"})]}),a.jsx("span",{style:{fontSize:"12px",color:"var(--text-main)",marginTop:"2px",fontWeight:500},children:$.name||$.description})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[$.mainWeight&&a.jsxs("span",{style:{fontSize:"10px",fontWeight:600,color:"var(--text-muted)"},children:[$.mainWeight,"g"]}),a.jsx("div",{style:{backgroundColor:"rgba(241, 196, 15, 0.1)",color:"var(--primary)",padding:"4px",borderRadius:"6px"},children:a.jsx(Ot,{size:14})})]})]},$.id)})})]}),a.jsx("div",{style:{padding:"0"},children:Ie.length===0?a.jsx("div",{style:{padding:"32px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"},children:"No hay piezas asignadas a esta vitrina."}):Ie.map(($,le)=>{var _e;return a.jsxs("div",{style:{padding:"16px 24px",borderBottom:le===Ie.length-1?"none":"1px solid #f8f8f8",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[a.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:"1px solid #eee"},children:(_e=$.images)!=null&&_e[0]?a.jsx("img",{src:$.images[0],alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):a.jsx(Ao,{size:18,color:"#ccc"})}),a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"10px",fontWeight:800,color:"var(--primary)"},children:$.itemCode||$.id}),a.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"13px",fontWeight:600,color:"var(--text-main)"},children:$.name||$.description})]})]}),a.jsx("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:s&&a.jsx("button",{className:"btn-icon",title:"Quitar de vitrina",onClick:async()=>{try{await fr.update($.id,{showcaseId:void 0}),Ne()}catch(W){console.error("Error removing item from showcase:",W)}},children:a.jsx(Br,{size:14,color:"var(--error)"})})})]},$.id)})})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)",marginBottom:"16px"},children:["Especificaciones de ",H==null?void 0:H.name]}),a.jsx("div",{style:{backgroundColor:"#f9f9f9",padding:"16px",borderRadius:"12px"},children:a.jsxs("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px",color:"var(--text-muted)"},children:[((H==null?void 0:H.details)||[]).map(($,le)=>a.jsx("li",{style:{marginBottom:"8px"},children:s?a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("input",{className:"form-control",value:$,onChange:_e=>{const W=[...H.details];W[le]=_e.target.value,O(d,W)},style:{flex:1,padding:"4px 8px",fontSize:"12px"}}),a.jsx("button",{onClick:()=>{const _e=H.details.filter((W,oe)=>oe!==le);O(d,_e)},style:{background:"none",border:"none",color:"var(--error)",cursor:"pointer"},children:a.jsx(Zn,{size:12})})]}):$},le)),s&&a.jsx("li",{style:{listStyle:"none",marginTop:"12px"},children:a.jsx("button",{className:"btn-sm",onClick:()=>{const $=[...H.details||[],"Nueva caracterstica"];O(d,$)},style:{fontSize:"11px",color:"var(--primary)",background:"none",border:"none",cursor:"pointer",padding:0,fontWeight:600},children:"+ Aadir caracterstica"})})]})})]})]})]}),_==="general_stock"&&a.jsxs("div",{className:"glass-card",style:{padding:"32px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsxs("div",{children:[a.jsxs("h3",{style:{margin:0},children:["Stock Fsico en ",t.name]}),a.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"var(--text-muted)"},children:"Listado completo de piezas asignadas a esta ubicacin."})]}),a.jsx("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:"11px",fontWeight:800,color:"var(--text-muted)"},children:"TOTAL PIEZAS"}),a.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800},children:I.length})]})})]}),M?a.jsx("div",{style:{padding:"60px",textAlign:"center",color:"var(--text-muted)"},children:"Cargando inventario..."}):I.length===0?a.jsxs("div",{style:{padding:"60px",textAlign:"center",color:"var(--text-muted)",backgroundColor:"#fcfcfc",borderRadius:"12px",border:"1px dashed #ddd"},children:[a.jsx(Nl,{size:48,style:{marginBottom:"16px",opacity:.3}}),a.jsx("p",{children:"No hay piezas registradas en esta ubicacin."})]}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"24px"},children:I.map($=>{var le,_e,W,oe;return a.jsxs("div",{className:"glass-card",style:{padding:0,overflow:"hidden",border:"1px solid #eee"},children:[a.jsx("div",{style:{height:"160px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",color:"#ccc",position:"relative"},children:$.images&&$.images.length>0?a.jsx("img",{src:$.images[0],alt:$.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):a.jsx(Ao,{size:40})}),a.jsxs("div",{style:{padding:"16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{style:{fontSize:"10px",fontWeight:800,color:"var(--primary)",backgroundColor:"rgba(241, 196, 15, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:$.itemCode}),a.jsxs("span",{style:{fontSize:"10px",fontWeight:700,color:"var(--text-muted)"},children:[$.mainWeight,"g"]})]}),a.jsx("h4",{style:{margin:0,fontSize:"14px",fontWeight:700,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:$.name}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"12px"},children:[a.jsxs("div",{style:{fontSize:"11px",color:"var(--text-muted)"},children:["PVPR: ",a.jsxs("span",{style:{fontWeight:700,color:"var(--text-main)"},children:[((le=$.salePrice)==null?void 0:le.toLocaleString())||"0",""]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[$.showcaseId&&a.jsx("span",{style:{fontSize:"9px",fontWeight:800,backgroundColor:"#f0f0f0",padding:"2px 6px",borderRadius:"4px"},children:((oe=(W=(_e=c.metadata)==null?void 0:_e.showcases)==null?void 0:W.find(ce=>ce.id===$.showcaseId))==null?void 0:oe.name)||"VITRINA"}),a.jsx("div",{onClick:async()=>{if(s)try{await fr.update($.id,{isApproved:!$.isApproved}),Ne()}catch(ce){console.error("Error toggling approval:",ce)}},style:{fontSize:"10px",fontWeight:800,backgroundColor:$.isApproved?"#e8f6f3":"#fdedec",color:$.isApproved?"#1abc9c":"#e74c3c",padding:"4px 10px",borderRadius:"20px",cursor:s?"pointer":"default"},children:$.isApproved?"APROBADO":"PENDIENTE"})]})]})]})]},$.id)})})]})]})},Le=()=>{var H,Ie;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"32px",display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"var(--text-muted)"},children:[a.jsx(Ts,{size:24}),a.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:"Detalles de Ubicacin"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Nombre / Alias"}),a.jsx("input",{className:"form-control",disabled:!s,value:c.name,onChange:de=>u({...c,name:de.target.value}),style:{width:"100%"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Persona de Contacto"}),a.jsx("input",{className:"form-control",disabled:!s,value:((H=c.metadata)==null?void 0:H.contactPerson)||"",onChange:de=>u({...c,metadata:{...c.metadata,contactPerson:de.target.value}}),style:{width:"100%"}})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"32px"},children:[a.jsx("h4",{style:{margin:"0 0 16px 0",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Notas y Observaciones"}),a.jsx("textarea",{className:"form-control",disabled:!s,rows:10,value:((Ie=c.metadata)==null?void 0:Ie.notes)||"",onChange:de=>u({...c,metadata:{...c.metadata,notes:de.target.value}}),placeholder:"Escriba aqu cualquier informacin relevante sobre esta ubicacin...",style:{width:"100%",padding:"16px",borderRadius:"12px",border:"1px solid #eee",resize:"none"}})]})]})};return a.jsxs("div",{style:{paddingBottom:"100px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"40px"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontSize:"13px",color:"var(--text-muted)"},children:[a.jsx("span",{children:"Gestin de Ubicaciones"}),a.jsx("span",{children:"/"}),a.jsxs("span",{style:{fontWeight:600,color:"var(--text-main)"},children:["Ficha de ",t.type==="WORKSHOP"?"Taller":"Tienda"]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[a.jsx("h1",{style:{margin:0,fontSize:"2.5rem"},children:t.name}),a.jsx("span",{style:{fontSize:"11px",fontWeight:800,backgroundColor:t.isActive?"#e8f6f3":"#fdedec",color:t.isActive?"#1abc9c":"#e74c3c",padding:"4px 10px",borderRadius:"20px"},children:t.isActive?"ACTIVO":"INACTIVO"})]}),a.jsx("p",{style:{color:"var(--text-muted)",marginTop:"8px"},children:t.type==="WORKSHOP"?"Gestin integral de talleres externos y servicios de alta gama.":"Punto de venta directo y exhibicin."})]}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsx("button",{className:"btn",onClick:e,children:"Volver al Listado"}),s?a.jsx("button",{className:"btn btn-primary",onClick:$e,children:"Guardar Cambios"}):a.jsx("button",{className:"btn btn-primary",onClick:()=>o(!0),children:"Editar Ficha"})]})]}),t.type==="WORKSHOP"?ze():t.type==="STORE"?it():Le(),j&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{width:"400px",padding:"32px",backgroundColor:"white"},children:[a.jsx("h3",{style:{marginTop:0,marginBottom:"24px"},children:"Nueva Orden de Trabajo"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"ID de la Pieza"}),a.jsx("input",{className:"form-control",placeholder:"Ej: LD-5001",value:b.pieceId,onChange:H=>y({...b,pieceId:H.target.value}),style:{width:"100%"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Tipo de Trabajo"}),a.jsx("select",{className:"form-control",value:b.workType,onChange:H=>y({...b,workType:H.target.value}),style:{width:"100%",padding:"12px"},children:Q.map(H=>a.jsx("option",{value:H.toUpperCase(),children:H},H))})]}),a.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"12px"},children:[a.jsx("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>{alert(`Orden para ${b.pieceId} creada con xito.`),P(!1)},children:"Generar Orden"}),a.jsx("button",{className:"btn",style:{flex:1},onClick:()=>P(!1),children:"Cancelar"})]})]})]})})]})},gN=()=>{const[t,e]=R.useState("locations"),[n,r]=R.useState(null),[i,s]=R.useState([]),[o,c]=R.useState([]),[u,d]=R.useState(!1),[f,p]=R.useState({name:"",type:"OTHER"});R.useEffect(()=>{g()},[]);const g=async()=>{try{const[y,I]=await Promise.all([xs.getAll(),Ka.getAll()]);s(y),c(I)}catch(y){console.error("Error loading locations/statuses:",y)}},x=y=>{p(y?{id:y.id,name:y.name,type:y.type}:{name:"",type:"OTHER"}),d(!0)},C=async()=>{f.name.trim()&&(t==="locations"?f.id?await xs.update(f.id,{name:f.name,type:f.type}):await xs.create({name:f.name,type:f.type,createdBy:"user",metadata:{}}):f.id?await Ka.update(f.id,f.name):await Ka.create(f.name),await g(),d(!1))},j=async y=>{if(n){await xs.update(n.id,y),await g();const I=await xs.getById(n.id);r(I||null)}},P=async(y,I)=>{I.stopPropagation(),confirm("Ests seguro de desactivar este elemento?")&&(t==="locations"?await xs.deleteLogic(y):await Ka.deleteLogic(y),await g())};if(n)return a.jsx("div",{className:"container",style:{paddingTop:"40px"},children:a.jsx(mN,{location:n,onBack:()=>r(null),onSave:j})});const b=()=>{const y=t==="locations"?i:o,I=t==="locations"?Ts:Dl,N=t==="locations"?"Ubicaciones":"Estados Operativos";return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsx("h2",{style:{margin:0},children:N}),a.jsxs("button",{className:"btn btn-accent",onClick:()=>x(),children:[a.jsx(Ot,{size:18})," Nuevo ",t==="locations"?"Punto":"Estado"]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"20px"},children:y.map(M=>{var _;const B=M.type?M.type==="WORKSHOP"?"TALLER":M.type==="STORE"?"TIENDA":"OTRO":null;return a.jsxs("div",{className:"glass-card",style:{padding:"24px",cursor:t==="locations"?"pointer":"default",transition:"all 0.2s"},onClick:()=>t==="locations"&&r(M),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[a.jsx("div",{style:{padding:"8px",backgroundColor:t==="locations"?"rgba(52, 152, 219, 0.1)":"rgba(155, 89, 182, 0.1)",color:t==="locations"?"var(--primary)":"#9b59b6",borderRadius:"8px"},children:a.jsx(I,{size:20})}),a.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[B&&a.jsx("span",{style:{fontSize:"10px",fontWeight:800,padding:"4px 8px",borderRadius:"4px",backgroundColor:"#f4f4f4",color:"#666"},children:B}),a.jsxs("span",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:600},children:["ID: ",M.id]})]})]}),a.jsx("h3",{style:{marginBottom:"12px"},children:M.name}),t==="locations"&&a.jsx("p",{style:{fontSize:"13px",color:"var(--text-muted)",marginBottom:"16px"},children:((_=M.metadata)==null?void 0:_.address)||"Sin direccin definida."}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid #f1f1f1",paddingTop:"16px"},children:[a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsxs("button",{onClick:v=>{v.stopPropagation(),x(M)},style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(Pl,{size:14})," Editar"]}),a.jsxs("button",{onClick:v=>P(M.id,v),style:{background:"none",border:"none",color:"var(--error)",fontSize:"13px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(Zn,{size:14})," Desactivar"]})]}),t==="locations"&&a.jsx(H1,{size:18,color:"var(--primary)"})]})]},M.id)})})]})};return a.jsxs("div",{className:"container",style:{paddingBottom:"60px"},children:[a.jsxs("header",{style:{marginBottom:"40px"},children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Control Logstico"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Gestin de ubicaciones fsicas y estados de las piezas"}),a.jsxs("div",{className:"glass-card",style:{display:"inline-flex",padding:"6px",marginTop:"24px",borderRadius:"12px"},children:[a.jsxs("button",{onClick:()=>e("locations"),style:{padding:"10px 20px",border:"none",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontWeight:600,fontSize:"14px",backgroundColor:t==="locations"?"var(--primary)":"transparent",color:t==="locations"?"white":"var(--text-muted)",transition:"all 0.2s"},children:[a.jsx(Ts,{size:18})," Ubicaciones"]}),a.jsxs("button",{onClick:()=>e("statuses"),style:{padding:"10px 20px",border:"none",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontWeight:600,fontSize:"14px",backgroundColor:t==="statuses"?"var(--primary)":"transparent",color:t==="statuses"?"white":"var(--text-muted)",transition:"all 0.2s"},children:[a.jsx(Dl,{size:18})," Estados"]})]})]}),b(),u&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"450px",backgroundColor:"white"},children:[a.jsxs("h2",{style:{marginBottom:"24px"},children:[f.id?"Editar":"Nueva"," ",t==="locations"?"Ubicacin":"Estado"]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px",marginBottom:"32px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Nombre"}),a.jsx("input",{className:"form-control",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd"},value:f.name,onChange:y=>p({...f,name:y.target.value}),placeholder:"Ej: Joyeros Unificados, Tienda Serrano..."})]}),t==="locations"&&a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Tipo de Ubicacin"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:["WORKSHOP","STORE","OTHER"].map(y=>a.jsx("button",{type:"button",onClick:()=>p({...f,type:y}),style:{padding:"10px 5px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"12px",fontWeight:700,backgroundColor:f.type===y?"var(--primary)":"white",color:f.type===y?"white":"var(--text-main)",cursor:"pointer"},children:y==="WORKSHOP"?"TALLER":y==="STORE"?"TIENDA":"OTRO"},y))})]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[a.jsx("button",{className:"btn",onClick:()=>d(!1),children:"Cancelar"}),a.jsx("button",{className:"btn btn-primary",onClick:C,children:"Continuar"})]})]})})]})},ms="subcategories",Qx=[{id:"sub_an_solitario",categoryId:"cat_anillos",name:"Solitario",description:"Anillo con una sola piedra central.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_alianza",categoryId:"cat_anillos",name:"Alianza",description:"Alianzas de boda o compromiso.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_media_alianza",categoryId:"cat_anillos",name:"Media alianza",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_roseton",categoryId:"cat_anillos",name:"Rosetn",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_sello",categoryId:"cat_anillos",name:"Sello",description:"Anillos tipo sello.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_trilogy",categoryId:"cat_anillos",name:"Trilogy / Tresillo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_piedra_central",categoryId:"cat_anillos",name:"Anillo con piedra central",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_sin_piedra",categoryId:"cat_anillos",name:"Anillo sin piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_ajustable",categoryId:"cat_anillos",name:"Anillo ajustable",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_an_infantil",categoryId:"cat_anillos",name:"Anillo infantil",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_boton",categoryId:"cat_pendientes",name:"Pendientes de botn",description:"Pegados al lbulo.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_aro",categoryId:"cat_pendientes",name:"Pendientes de aro",description:"Pendientes circulares.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_largo",categoryId:"cat_pendientes",name:"Pendientes largos",description:"Cuelgan del lbulo.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_colgante",categoryId:"cat_pendientes",name:"Pendientes colgantes",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_criolla",categoryId:"cat_pendientes",name:"Criollas",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_trepador",categoryId:"cat_pendientes",name:"Trepadores (ear climbers)",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_con_piedra",categoryId:"cat_pendientes",name:"Pendientes con piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_sin_piedra",categoryId:"cat_pendientes",name:"Pendientes sin piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pe_infantil",categoryId:"cat_pendientes",name:"Pendientes infantiles",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_corto",categoryId:"cat_collares",name:"Collar corto",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_largo",categoryId:"cat_collares",name:"Collar largo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_rigido",categoryId:"cat_collares",name:"Collar rgido",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_flexible",categoryId:"cat_collares",name:"Collar flexible",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_colgante_fijo",categoryId:"cat_collares",name:"Collar con colgante fijo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_co_colgante_desm",categoryId:"cat_collares",name:"Collar con colgante desmontable",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_clasico",categoryId:"cat_colgantes",name:"Colgante clsico",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_con_piedra",categoryId:"cat_colgantes",name:"Colgante con piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_sin_piedra",categoryId:"cat_colgantes",name:"Colgante sin piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_medalla",categoryId:"cat_colgantes",name:"Medalla",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_cruz",categoryId:"cat_colgantes",name:"Cruz",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_inicial",categoryId:"cat_colgantes",name:"Inicial / letra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_simbolo",categoryId:"cat_colgantes",name:"Smbolo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_religioso",categoryId:"cat_colgantes",name:"Colgante religioso",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cg_infantil",categoryId:"cat_colgantes",name:"Colgante infantil",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_fina",categoryId:"cat_cadenas",name:"Cadena fina",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_media",categoryId:"cat_cadenas",name:"Cadena media",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_gruesa",categoryId:"cat_cadenas",name:"Cadena gruesa",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_rigida",categoryId:"cat_cadenas",name:"Cadena rgida",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_flexible",categoryId:"cat_cadenas",name:"Cadena flexible",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_cordon",categoryId:"cat_cadenas",name:"Cadena tipo cordn",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_eslabon",categoryId:"cat_cadenas",name:"Cadena tipo eslabn",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ca_infantil",categoryId:"cat_cadenas",name:"Cadena infantil",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_cadena",categoryId:"cat_pulseras",name:"Pulsera cadena",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_rigida",categoryId:"cat_pulseras",name:"Pulsera rgida",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_flexible",categoryId:"cat_pulseras",name:"Pulsera flexible",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_colgantes",categoryId:"cat_pulseras",name:"Pulsera con colgantes",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_con_piedras",categoryId:"cat_pulseras",name:"Pulsera con piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_sin_piedras",categoryId:"cat_pulseras",name:"Pulsera sin piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_pu_infantil",categoryId:"cat_pulseras",name:"Pulsera infantil",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_br_rigido",categoryId:"cat_brazaletes",name:"Brazalete rgido",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_br_abierto",categoryId:"cat_brazaletes",name:"Brazalete abierto",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_br_cerrado",categoryId:"cat_brazaletes",name:"Brazalete cerrado",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_br_con_piedras",categoryId:"cat_brazaletes",name:"Brazalete con piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_br_sin_piedras",categoryId:"cat_brazaletes",name:"Brazalete sin piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_to_cadena",categoryId:"cat_tobilleras",name:"Tobillera cadena",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_to_colgantes",categoryId:"cat_tobilleras",name:"Tobillera con colgantes",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_to_con_piedras",categoryId:"cat_tobilleras",name:"Tobillera con piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_to_sin_piedras",categoryId:"cat_tobilleras",name:"Tobillera sin piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ge_clasicos",categoryId:"cat_gemelos",name:"Gemelos clsicos",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ge_con_piedra",categoryId:"cat_gemelos",name:"Gemelos con piedra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ge_personalizado",categoryId:"cat_gemelos",name:"Gemelos personalizados",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ge_infantil",categoryId:"cat_gemelos",name:"Gemelos infantiles",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_bc_clasico",categoryId:"cat_broches",name:"Broche clsico",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_bc_con_piedras",categoryId:"cat_broches",name:"Broche con piedras",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_bc_decorativo",categoryId:"cat_broches",name:"Broche decorativo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_bc_funcional",categoryId:"cat_broches",name:"Broche funcional",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_re_pulsera",categoryId:"cat_relojes",name:"Reloj de pulsera",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_re_clasico",categoryId:"cat_relojes",name:"Reloj clsico",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_re_deportivo",categoryId:"cat_relojes",name:"Reloj deportivo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_re_joya",categoryId:"cat_relojes",name:"Reloj joya",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cj_anillo_pendientes",categoryId:"cat_conjuntos",name:"Conjunto anillo + pendientes",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cj_collar_pendientes",categoryId:"cat_conjuntos",name:"Conjunto collar + pendientes",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cj_pulsera_collar",categoryId:"cat_conjuntos",name:"Conjunto pulsera + collar",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_cj_completo",categoryId:"cat_conjuntos",name:"Conjunto completo",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ot_personalizada",categoryId:"cat_otros",name:"Pieza personalizada",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ot_unica",categoryId:"cat_otros",name:"Pieza nica",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ot_prototipo",categoryId:"cat_otros",name:"Prototipo / muestra",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"sub_ot_historica",categoryId:"cat_otros",name:"Pieza histrica / especial",isActive:!0,createdAt:new Date,createdBy:"system"}],Po={getAll:async()=>{const t=At(Ke(X,ms),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){console.log("Sembrando subcategoras iniciales en Firestore...");for(const n of Qx)await pn(me(X,ms,n.id),{...n,createdAt:Fe()});return Qx}return e.docs.map(n=>{var r;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},getByCategory:async t=>{const e=At(Ke(X,ms),Ye("categoryId","==",t),Ye("isActive","==",!0));return(await Tt(e)).docs.map(r=>{var i;return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate()}})},create:async t=>{const e=`sub_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return await pn(me(X,ms,e),n),{...n,id:e,createdAt:new Date}},update:async(t,e)=>{var i;const n=me(X,ms,t);await Rt(n,e);const r=await En(n);if(r.exists())return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate()}},deleteLogic:async t=>{const e=me(X,ms,t);try{return await Rt(e,{isActive:!1}),!0}catch{return!1}},deactivateByCategory:async t=>{const e=At(Ke(X,ms),Ye("categoryId","==",t)),n=await Tt(e),r=dd(X);n.docs.forEach(i=>{r.update(i.ref,{isActive:!1})}),await r.commit()}},Zs="categories",Yx=[{id:"cat_anillos",name:"Anillos",description:"Piezas destinadas a ser llevadas en el dedo.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_pendientes",name:"Pendientes",description:"Piezas destinadas a la oreja.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_collares",name:"Collares",description:"Piezas completas destinadas al cuello.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_colgantes",name:"Colgantes",description:"Piezas colgables independientes.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_cadenas",name:"Cadenas",description:"Elementos lineales de cuello.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_pulseras",name:"Pulseras",description:"Piezas destinadas a la mueca (flexibles).",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_brazaletes",name:"Brazaletes",description:"Piezas rgidas o semi-rgidas de mueca.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_tobilleras",name:"Tobilleras",description:"Piezas destinadas al tobillo.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_gemelos",name:"Gemelos",description:"Piezas destinadas a camisas.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_broches",name:"Broches",description:"Piezas decorativas o funcionales para prendas.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_relojes",name:"Relojes",description:"(Solo si se incluye en inventario troncal) Instrumentos de medida del tiempo.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_conjuntos",name:"Conjuntos / Sets",description:"Entidad lgica de agrupacin de piezas.",isActive:!0,createdAt:new Date,createdBy:"system"},{id:"cat_otros",name:"Otros / Especiales",description:"Uso controlado y excepcional.",isActive:!0,createdAt:new Date,createdBy:"system"}],ul={getAll:async()=>{const t=At(Ke(X,Zs),Ye("isActive","==",!0)),e=await Tt(t);if(e.empty){console.log("Sembrando categoras iniciales en Firestore...");for(const n of Yx)await pn(me(X,Zs,n.id),{...n,createdAt:Fe()});return Yx}return e.docs.map(n=>{var r;return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},getById:async t=>{var r;const e=me(X,Zs,t),n=await En(e);if(n.exists()&&n.data().isActive)return{...n.data(),id:n.id,createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}},create:async t=>{const e=`cat_${Date.now()}`,n={...t,isActive:!0,createdAt:Fe()};return await pn(me(X,Zs,e),n),{...n,id:e,createdAt:new Date}},update:async(t,e)=>{var i;const n=me(X,Zs,t);await Rt(n,e);const r=await En(n);if(r.exists())return{...r.data(),id:r.id,createdAt:(i=r.data().createdAt)==null?void 0:i.toDate()}},deleteLogic:async t=>{const e=me(X,Zs,t);try{return await Po.deactivateByCategory(t),await Rt(e,{isActive:!1}),!0}catch{return!1}}},gi="classification_mappings",Oa="audit_logs",Jx=[{categoryId:"cat_anillos",subcategoryId:"",attributeId:"attr_mat_pri",isMandatory:!0,sortOrder:0},{categoryId:"cat_anillos",subcategoryId:"",attributeId:"attr_ley",isMandatory:!0,sortOrder:1},{categoryId:"cat_anillos",subcategoryId:"",attributeId:"attr_col_met",isMandatory:!1,sortOrder:2},{categoryId:"",subcategoryId:"sub_an_solitario",attributeId:"attr_tip_pie",isMandatory:!0,sortOrder:3},{categoryId:"",subcategoryId:"sub_an_solitario",attributeId:"attr_for_pie",isMandatory:!1,sortOrder:4},{categoryId:"cat_relojes",subcategoryId:"",attributeId:"attr_mat_pri",isMandatory:!0,sortOrder:0},{categoryId:"cat_relojes",subcategoryId:"",attributeId:"attr_acabado",isMandatory:!1,sortOrder:1},{categoryId:"cat_pendientes",subcategoryId:"",attributeId:"attr_mat_pri",isMandatory:!0,sortOrder:0},{categoryId:"cat_pendientes",subcategoryId:"",attributeId:"attr_ley",isMandatory:!0,sortOrder:1},{categoryId:"cat_collares",subcategoryId:"",attributeId:"attr_mat_pri",isMandatory:!0,sortOrder:0},{categoryId:"cat_collares",subcategoryId:"",attributeId:"attr_ley",isMandatory:!0,sortOrder:1},{categoryId:"cat_colgantes",subcategoryId:"",attributeId:"attr_mat_pri",isMandatory:!0,sortOrder:0},{categoryId:"cat_colgantes",subcategoryId:"",attributeId:"attr_ley",isMandatory:!0,sortOrder:1}],ar={getAttributesByCategory:async t=>{const e=At(Ke(X,gi),Ye("categoryId","==",t),Ye("subcategoryId","==","")),n=await Tt(e);if(n.empty&&t==="cat_anillos"){for(const r of Jx.filter(i=>i.categoryId===t))await pn(me(X,gi,`${r.categoryId}_${r.subcategoryId}_${r.attributeId}`),r);return Jx.filter(r=>r.categoryId===t&&!r.subcategoryId)}return n.docs.map(r=>r.data()).sort((r,i)=>r.sortOrder-i.sortOrder)},getAttributesBySubcategory:async(t,e)=>{const n=At(Ke(X,gi),Ye("subcategoryId","==",t)),i=(await Tt(n)).docs.map(c=>c.data());let s=[];if(e){const c=At(Ke(X,gi),Ye("categoryId","==",e),Ye("subcategoryId","==",""));s=(await Tt(c)).docs.map(d=>d.data())}const o=[...i];return s.forEach(c=>{o.some(u=>u.attributeId===c.attributeId)||o.push(c)}),o.sort((c,u)=>c.sortOrder-u.sortOrder)},addMapping:async(t,e,n)=>{const r=n==="category",i=r?`${t}__${e}`:`__${t}_${e}`;await pn(me(X,gi,i),{categoryId:r?t:"",subcategoryId:r?"":t,attributeId:e,isMandatory:!1,sortOrder:0}),await xo(Ke(X,Oa),{timestamp:Fe(),user:"admin",action:"CREATE",targetType:n,targetId:t,details:`Vinculado atributo ${e}.`})},removeMapping:async(t,e,n)=>{const i=n==="category"?`${t}__${e}`:`__${t}_${e}`;await uj(me(X,gi,i)),await xo(Ke(X,Oa),{timestamp:Fe(),user:"admin",action:"DELETE",targetType:n,targetId:t,details:`Desvinculado atributo ${e}.`})},toggleMandatory:async(t,e,n)=>{const i=n==="category"?`${t}__${e}`:`__${t}_${e}`,s=me(X,gi,i),o=await En(s);if(o.exists()){const c=o.data().isMandatory;await Rt(s,{isMandatory:!c}),await xo(Ke(X,Oa),{timestamp:Fe(),user:"admin",action:"UPDATE",targetType:n,targetId:t,details:`Cambiado atributo ${e} a ${c?"OPCIONAL":"OBILGATORIO"}.`})}},getLogs:async t=>{const e=At(Ke(X,Oa),Ye("targetId","==",t));return(await Tt(e)).docs.map(r=>{var i;return{...r.data(),id:r.id,timestamp:(i=r.data().timestamp)==null?void 0:i.toDate()}})},reorderMappings:async(t,e,n)=>{const r=n==="category",i=dd(X);for(let s=0;s<e.length;s++){const o=e[s],c=r?`${t}__${o}`:`__${t}_${o}`,u=me(X,gi,c);i.update(u,{sortOrder:s})}await i.commit(),await xo(Ke(X,Oa),{timestamp:Fe(),user:"admin",action:"REORDER",targetType:n,targetId:t,details:"Reordenado catlogo de atributos."})}};var Xx;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(Xx||(Xx={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zx;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(Zx||(Zx={}));var e0;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(e0||(e0={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=["user","model","function","system"];var n0;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(n0||(n0={}));var r0;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(r0||(r0={}));var i0;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(i0||(i0={}));var s0;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(s0||(s0={}));var dl;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.OTHER="OTHER"})(dl||(dl={}));var o0;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(o0||(o0={}));var a0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(a0||(a0={}));var l0;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(l0||(l0={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class eo extends fn{constructor(e,n){super(e),this.response=n}}class CI extends fn{constructor(e,n,r,i){super(e),this.status=n,this.statusText=r,this.errorDetails=i}}class Hi extends fn{}class AI extends fn{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN="https://generativelanguage.googleapis.com",vN="v1beta",xN="0.24.1",_N="genai-js";var Bs;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Bs||(Bs={}));class wN{constructor(e,n,r,i,s){this.model=e,this.task=n,this.apiKey=r,this.stream=i,this.requestOptions=s}toString(){var e,n;const r=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||vN;let s=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||yN}/${r}/${this.model}:${this.task}`;return this.stream&&(s+="?alt=sse"),s}}function EN(t){const e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${_N}/${xN}`),e.join(" ")}async function IN(t){var e;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",EN(t.requestOptions)),n.append("x-goog-api-key",t.apiKey);let r=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(i){throw new Hi(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${i.message}`)}for(const[i,s]of r.entries()){if(i==="x-goog-api-key")throw new Hi(`Cannot set reserved header name ${i}`);if(i==="x-goog-api-client")throw new Hi(`Header name ${i} can only be set using the apiClient field`);n.append(i,s)}}return n}async function bN(t,e,n,r,i,s){const o=new wN(t,e,n,r,s);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},TN(s)),{method:"POST",headers:await IN(o),body:i})}}async function mc(t,e,n,r,i,s={},o=fetch){const{url:c,fetchOptions:u}=await bN(t,e,n,r,i,s);return SN(c,u,o)}async function SN(t,e,n=fetch){let r;try{r=await n(t,e)}catch(i){CN(i,t)}return r.ok||await AN(r,t),r}function CN(t,e){let n=t;throw n.name==="AbortError"?(n=new AI(`Request aborted when fetching ${e.toString()}: ${t.message}`),n.stack=t.stack):t instanceof CI||t instanceof Hi||(n=new fn(`Error fetching from ${e.toString()}: ${t.message}`),n.stack=t.stack),n}async function AN(t,e){let n="",r;try{const i=await t.json();n=i.error.message,i.error.details&&(n+=` ${JSON.stringify(i.error.details)}`,r=i.error.details)}catch{}throw new CI(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${n}`,t.status,t.statusText,r)}function TN(t){const e={};if((t==null?void 0:t.signal)!==void 0||(t==null?void 0:t.timeout)>=0){const n=new AbortController;(t==null?void 0:t.timeout)>=0&&setTimeout(()=>n.abort(),t.timeout),t!=null&&t.signal&&t.signal.addEventListener("abort",()=>{n.abort()}),e.signal=n.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Iu(t.candidates[0]))throw new eo(`${xi(t)}`,t);return RN(t)}else if(t.promptFeedback)throw new eo(`Text not available. ${xi(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Iu(t.candidates[0]))throw new eo(`${xi(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),c0(t)[0]}else if(t.promptFeedback)throw new eo(`Function call not available. ${xi(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Iu(t.candidates[0]))throw new eo(`${xi(t)}`,t);return c0(t)}else if(t.promptFeedback)throw new eo(`Function call not available. ${xi(t)}`,t)},t}function RN(t){var e,n,r,i;const s=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const o of(i=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||i===void 0?void 0:i.parts)o.text&&s.push(o.text),o.executableCode&&s.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&s.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return s.length>0?s.join(""):""}function c0(t){var e,n,r,i;const s=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const o of(i=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||i===void 0?void 0:i.parts)o.functionCall&&s.push(o.functionCall);if(s.length>0)return s}const kN=[dl.RECITATION,dl.SAFETY,dl.LANGUAGE];function Iu(t){return!!t.finishReason&&kN.includes(t.finishReason)}function xi(t){var e,n,r;let i="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)i+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(i+=` due to ${t.promptFeedback.blockReason}`),!((n=t.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(i+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((r=t.candidates)===null||r===void 0)&&r[0]){const s=t.candidates[0];Iu(s)&&(i+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(i+=`: ${s.finishMessage}`))}return i}function Wl(t){return this instanceof Wl?(this.v=t,this):new Wl(t)}function jN(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(g){r[g]&&(i[g]=function(x){return new Promise(function(C,j){s.push([g,x,C,j])>1||c(g,x)})})}function c(g,x){try{u(r[g](x))}catch(C){p(s[0][3],C)}}function u(g){g.value instanceof Wl?Promise.resolve(g.value.v).then(d,f):p(s[0][2],g)}function d(g){c("next",g)}function f(g){c("throw",g)}function p(g,x){g(x),s.shift(),s.length&&c(s[0][0],s[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function DN(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=ON(e),[r,i]=n.tee();return{stream:PN(r),response:NN(i)}}async function NN(t){const e=[],n=t.getReader();for(;;){const{done:r,value:i}=await n.read();if(r)return wg(LN(e));e.push(i)}}function PN(t){return jN(this,arguments,function*(){const n=t.getReader();for(;;){const{value:r,done:i}=yield Wl(n.read());if(i)break;yield yield Wl(wg(r))}})}function ON(t){const e=t.getReader();return new ReadableStream({start(r){let i="";return s();function s(){return e.read().then(({value:o,done:c})=>{if(c){if(i.trim()){r.error(new fn("Failed to parse stream"));return}r.close();return}i+=o;let u=i.match(u0),d;for(;u;){try{d=JSON.parse(u[1])}catch{r.error(new fn(`Error parsing JSON response: "${u[1]}"`));return}r.enqueue(d),i=i.substring(u[0].length),u=i.match(u0)}return s()}).catch(o=>{let c=o;throw c.stack=o.stack,c.name==="AbortError"?c=new AI("Request aborted when reading from the stream"):c=new fn("Error reading from the stream"),c})}}})}function LN(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of t){if(r.candidates){let i=0;for(const s of r.candidates)if(n.candidates||(n.candidates=[]),n.candidates[i]||(n.candidates[i]={index:i}),n.candidates[i].citationMetadata=s.citationMetadata,n.candidates[i].groundingMetadata=s.groundingMetadata,n.candidates[i].finishReason=s.finishReason,n.candidates[i].finishMessage=s.finishMessage,n.candidates[i].safetyRatings=s.safetyRatings,s.content&&s.content.parts){n.candidates[i].content||(n.candidates[i].content={role:s.content.role||"user",parts:[]});const o={};for(const c of s.content.parts)c.text&&(o.text=c.text),c.functionCall&&(o.functionCall=c.functionCall),c.executableCode&&(o.executableCode=c.executableCode),c.codeExecutionResult&&(o.codeExecutionResult=c.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),n.candidates[i].content.parts.push(o)}i++}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TI(t,e,n,r){const i=await mc(e,Bs.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),r);return DN(i)}async function RI(t,e,n,r){const s=await(await mc(e,Bs.GENERATE_CONTENT,t,!1,JSON.stringify(n),r)).json();return{response:wg(s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function ql(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return MN(e)}function MN(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,i=!1;for(const s of t)"functionResponse"in s?(n.parts.push(s),i=!0):(e.parts.push(s),r=!0);if(r&&i)throw new fn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!i)throw new fn("No content is provided for sending chat message.");return r?e:n}function VN(t,e){var n;let r={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(n=e==null?void 0:e.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const i=t.generateContentRequest!=null;if(t.contents){if(i)throw new Hi("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=t.contents}else if(i)r=Object.assign(Object.assign({},r),t.generateContentRequest);else{const s=ql(t);r.contents=[s]}return{generateContentRequest:r}}function d0(t){let e;return t.contents?e=t:e={contents:[ql(t)]},t.systemInstruction&&(e.systemInstruction=kI(t.systemInstruction)),e}function zN(t){return typeof t=="string"||Array.isArray(t)?{content:ql(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],BN={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function FN(t){let e=!1;for(const n of t){const{role:r,parts:i}=n;if(!e&&r!=="user")throw new fn(`First content should be with role 'user', got ${r}`);if(!t0.includes(r))throw new fn(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(t0)}`);if(!Array.isArray(i))throw new fn("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new fn("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const c of i)for(const u of h0)u in c&&(s[u]+=1);const o=BN[r];for(const c of h0)if(!o.includes(c)&&s[c]>0)throw new fn(`Content with role '${r}' can't contain '${c}' part`);e=!0}}function f0(t){var e;if(t.candidates===void 0||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const r of n.parts)if(r===void 0||Object.keys(r).length===0||r.text!==void 0&&r.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="SILENT_ERROR";class UN{constructor(e,n,r,i={}){this.model=n,this.params=r,this._requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,r!=null&&r.history&&(FN(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,n={}){var r,i,s,o,c,u;await this._sendPromise;const d=ql(e),f={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,d]},p=Object.assign(Object.assign({},this._requestOptions),n);let g;return this._sendPromise=this._sendPromise.then(()=>RI(this._apiKey,this.model,f,p)).then(x=>{var C;if(f0(x.response)){this._history.push(d);const j=Object.assign({parts:[],role:"model"},(C=x.response.candidates)===null||C===void 0?void 0:C[0].content);this._history.push(j)}else{const j=xi(x.response);j&&console.warn(`sendMessage() was unsuccessful. ${j}. Inspect response object for details.`)}g=x}).catch(x=>{throw this._sendPromise=Promise.resolve(),x}),await this._sendPromise,g}async sendMessageStream(e,n={}){var r,i,s,o,c,u;await this._sendPromise;const d=ql(e),f={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(i=this.params)===null||i===void 0?void 0:i.generationConfig,tools:(s=this.params)===null||s===void 0?void 0:s.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(c=this.params)===null||c===void 0?void 0:c.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,d]},p=Object.assign(Object.assign({},this._requestOptions),n),g=TI(this._apiKey,this.model,f,p);return this._sendPromise=this._sendPromise.then(()=>g).catch(x=>{throw new Error(p0)}).then(x=>x.response).then(x=>{if(f0(x)){this._history.push(d);const C=Object.assign({},x.candidates[0].content);C.role||(C.role="model"),this._history.push(C)}else{const C=xi(x);C&&console.warn(`sendMessageStream() was unsuccessful. ${C}. Inspect response object for details.`)}}).catch(x=>{x.message!==p0&&console.error(x)}),g}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(t,e,n,r){return(await mc(e,Bs.COUNT_TOKENS,t,!1,JSON.stringify(n),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(t,e,n,r){return(await mc(e,Bs.EMBED_CONTENT,t,!1,JSON.stringify(n),r)).json()}async function qN(t,e,n,r){const i=n.requests.map(o=>Object.assign(Object.assign({},o),{model:e}));return(await mc(e,Bs.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:i}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,n,r={}){this.apiKey=e,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=kI(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(e,n={}){var r;const i=d0(e),s=Object.assign(Object.assign({},this._requestOptions),n);return RI(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},i),s)}async generateContentStream(e,n={}){var r;const i=d0(e),s=Object.assign(Object.assign({},this._requestOptions),n);return TI(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},i),s)}startChat(e){var n;return new UN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},e),this._requestOptions)}async countTokens(e,n={}){const r=VN(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),i=Object.assign(Object.assign({},this._requestOptions),n);return $N(this.apiKey,this.model,r,i)}async embedContent(e,n={}){const r=zN(e),i=Object.assign(Object.assign({},this._requestOptions),n);return WN(this.apiKey,this.model,r,i)}async batchEmbedContents(e,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return qN(this.apiKey,this.model,e,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.apiKey=e}getGenerativeModel(e,n){if(!e.model)throw new fn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new m0(this.apiKey,e,n)}getGenerativeModelFromCachedContent(e,n,r){if(!e.name)throw new Hi("Cached content must contain a `name` field.");if(!e.model)throw new Hi("Cached content must contain a `model` field.");const i=["model","systemInstruction"];for(const o of i)if(n!=null&&n[o]&&e[o]&&(n==null?void 0:n[o])!==e[o]){if(o==="model"){const c=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,u=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(c===u)continue}throw new Hi(`Different value for "${o}" specified in modelParams (${n[o]}) and cachedContent (${e[o]})`)}const s=Object.assign(Object.assign({},n),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new m0(this.apiKey,s,r)}}const GN="AIzaSyC7kZtz9OlbcIS46-tpvHlqCAXjUKd9XsU",g0=new HN(GN),y0={analyzeImage:async(t,e="image/jpeg",n)=>{const r=g0.getGenerativeModel({model:"gemini-2.0-flash"}),i=await ul.getAll(),s=await Po.getAll(),o=i.map(d=>`- ${d.name} (ID: ${d.id})`).join(`
`),c=s.map(d=>`- ${d.name} (ID: ${d.id}, CategoriaID: ${d.categoryId})`).join(`
`),u=`
            Analiza esta imagen de una joya o reloj y devuelve un objeto JSON con la siguiente estructura:
            {
                "name": "Nombre corto y comercial",
                "description": "Una descripcin literaria, elegante y vendedora de la pieza (ej. 'Anillo de oro amarillo con corazn central y doble banda de brillantes'). No usar formateo tcnico tipo lista.",
                "categoryId": "ID de la categora detectada",
                "subcategoryId": "ID de la subcategora detectada",
                "attributes": {
                    "ID_DEL_ATRIBUTO": "valor_detectado"
                },
                "socialDescription": "Un caption atractivo para Instagram/Facebook con hashtags",
                "detailedDescription": {
                    "design": "Descripcin del diseo y estructura central",
                    "details": "Detalles minuciosos de la pieza",
                    "materials": "Informacin sobre materiales y acabados",
                    "technicalSpecs": "Especificaciones tcnicas estimadas",
                    "symbolism": "Simbolismo o historia sugerida de la pieza"
                },
                "commercialLine": "Nupcial | Juvenil | Alta Joyera | Daily Wear",
                "symbology": ["Amor", "Proteccin", "xito", "etc"],
                "occasion": ["Compromiso", "Aniversario", "Graduacin", "etc"],
                "customerProfile": ["Romntico", "Minimalista", "Clsico", "Trendsetter"]
            }

            CONTEXTO DE CLASIFICACIN:
            Categoras:
            ${o}

            Subcategoras:
            ${c}

            ATRIBUTOS DISPONIBLES (Usa estos IDs en el objeto "attributes" y para construir la descripcin):
            ${n.attributes.map(d=>`- ${d.name} (ID: ${d.id}, Tipo: ${d.dataType})`).join(`
`)}

            VALORES DISPONIBLES (Si el atributo es de tipo LIST, usa preferiblemente estos valores):
            ${Object.entries(n.domainValuesMap).map(([d,f])=>{const p=n.attributes.find(g=>g.id===d);return`- ${(p==null?void 0:p.name)||d}: [${f.map(g=>g.value).join(", ")}]`}).join(`
`)}

            INSTRUCCIONES CRTICAS:
            1. Responde UNICAMENTE con el JSON.
            2. La "description" DEBE ser fluida y descriptiva, resaltando la esttica de la pieza.
            3. Rellena el objeto "attributes" mapeando lo que veas a los IDs proporcionados.
            4. Si detectas un material o propiedad que tiene un valor en la lista de "VALORES DISPONIBLES", salo exactamente en el objeto "attributes".
            5. Genera contenidos de alta calidad para "socialDescription" y "detailedDescription".
            6. Sugiere la clasificacin comercial (commercialLine, symbology, occasion, customerProfile) basada en la esttica y uso probable de la pieza.
        `;try{const f=(await r.generateContent([u,{inlineData:{data:t.split(",")[1]||t,mimeType:e}}])).response.text();console.log("Gemini Response Raw:",f);const p=f.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(p)}catch(d){throw console.error("Error detallado en anlisis de Gemini:",d),new Error(`Error Gemini: ${d.message||"No se pudo completar el anlisis"}`)}},generateCopywriting:async t=>{const e=g0.getGenerativeModel({model:"gemini-2.0-flash"}),n=`
            Eres un experto en Copywriting para Joyera de Lujo. Tu tarea es generar descripciones atractivas y vendedoras para una pieza con los siguientes datos:
            
            DATOS DE LA PIEZA:
            - Nombre: ${t.name}
            - Clasificacin: ${t.category} / ${t.subcategory}
            
            ESTRATEGIA COMERCIAL SELECCIONADA:
            - Lnea: ${t.commercialLine}
            - Coleccin: ${t.collection}
            - Simbologa: ${t.symbology}
            - Ocasin: ${t.occasion}
            - Perfil de Cliente: ${t.customerProfile}

            OBJETIVO:
            Genera un objeto JSON con dos campos:
            1. "socialDescription": Un caption para Instagram con emojis, hashtags y un tono que encaje con el Perfil de Cliente indicado.
            2. "detailedDescription": Un objeto con:
               - "design": Descripcin evocadora del diseo.
               - "details": Puntos clave que lo hacen especial.
               - "materials": Cmo los materiales realzan la pieza.
               - "technicalSpecs": Resumen tcnico (ej. 'Oro 18k, 0.5ct Diamantes').
               - "symbolism": El significado profundo basado en la simbologa indicada.

            REGLAS:
            - Tono: Elegante, exclusivo y emocional.
            - Idioma: Espaol.
            - Responde SOLO con el JSON.
        `;try{const s=(await e.generateContent(n)).response.text().replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(s)}catch(r){throw console.error("Error en generacin de copy IA:",r),new Error(`Error Copywriting Gemini: ${r.message}`)}}},La="customers",Ai={async getAll(){const t=At(Ke(X,La),Ye("isActive","==",!0));return(await Tt(t)).docs.map(n=>{var r;return{id:n.id,...n.data(),createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}})},async getById(t){var r;const e=me(X,La,t),n=await En(e);return n.exists()?{id:n.id,...n.data(),createdAt:(r=n.data().createdAt)==null?void 0:r.toDate()}:null},async create(t){return(await xo(Ke(X,La),{...t,isActive:!0,createdAt:Fe()})).id},async update(t,e){const n=me(X,La,t);await Rt(n,{...e,updatedAt:Fe()})},async deleteLogic(t){const e=me(X,La,t);await Rt(e,{isActive:!1})},async search(t){const e=await this.getAll(),n=t.toLowerCase();return e.filter(r=>{var i;return r.firstName.toLowerCase().includes(n)||r.lastName.toLowerCase().includes(n)||((i=r.dni)==null?void 0:i.toLowerCase().includes(n))||r.phone.includes(n)})}},Ma="reservations",v0="inventory",bu={async getAll(){const t=At(Ke(X,Ma));return(await Tt(t)).docs.map(n=>{var r,i,s,o;return{id:n.id,...n.data(),startDate:(r=n.data().startDate)==null?void 0:r.toDate(),expiryDate:(i=n.data().expiryDate)==null?void 0:i.toDate(),createdAt:(s=n.data().createdAt)==null?void 0:s.toDate(),resolvedAt:(o=n.data().resolvedAt)==null?void 0:o.toDate()}})},async getActiveReservations(){const t=At(Ke(X,Ma),Ye("status","==","ACTIVE"));return(await Tt(t)).docs.map(n=>{var r,i,s;return{id:n.id,...n.data(),startDate:(r=n.data().startDate)==null?void 0:r.toDate(),expiryDate:(i=n.data().expiryDate)==null?void 0:i.toDate(),createdAt:(s=n.data().createdAt)==null?void 0:s.toDate()}})},async createReservation(t){const e=dd(X),n=me(Ke(X,Ma));e.set(n,{...t,status:"ACTIVE",startDate:Fe(),createdAt:Fe()});const r=me(X,v0,t.itemId);return e.update(r,{statusId:"stat_reserved",updatedAt:Fe()}),await e.commit(),n.id},async resolveReservation(t,e){const n=dd(X),r=me(X,Ma,t),i=await En(r);if(!i.exists())throw new Error("Reserva no encontrada");const s=i.data();if(n.update(r,{status:e.status,resolutionNote:e.note,resolvedAt:Fe(),resolvedBy:e.user}),e.status==="CANCELLED"||e.status==="EXPIRED"){const o=me(X,v0,s.itemId);n.update(o,{statusId:"stat_available",updatedAt:Fe()})}await n.commit()},async checkExpirations(){const t=await this.getActiveReservations(),e=new Date;let n=0;for(const r of t)r.expiryDate<e&&(await Rt(me(X,Ma,r.id),{status:"EXPIRED",updatedAt:Fe()}),n++);return n}},x0=[{id:"evt_san_valentin",name:"San Valentn",triggerDate:{day:14,month:2},priorityDays:20,targetSymbology:["Amor","Vnculo","Corazn","Pasin"],targetOccasion:["Aniversario","Detalle Romntico"],isActive:!0},{id:"evt_dia_madre",name:"Da de la Madre",triggerDate:{day:10,month:5},priorityDays:30,targetSymbology:["Proteccin","Gratitud","Familia"],targetOccasion:["Regalo Mam"],isActive:!0},{id:"evt_graduaciones",name:"Temporada Graduaciones",triggerDate:{day:15,month:6},priorityDays:45,targetSymbology:["xito","Futuro","Sabidura"],targetOccasion:["Graduacin"],targetProfile:["Joven","Moderno"],isActive:!0},{id:"evt_navidad",name:"Navidad y Reyes",triggerDate:{day:24,month:12},priorityDays:40,targetOccasion:["Regalo Navidad"],isActive:!0}],vd={getAllEvents:async()=>{const t=localStorage.getItem("les_commercial_events");return t?JSON.parse(t):(localStorage.setItem("les_commercial_events",JSON.stringify(x0)),x0)},saveEvent:async t=>{const e=await vd.getAllEvents(),n=e.findIndex(r=>r.id===t.id);n>=0?e[n]=t:e.push(t),localStorage.setItem("les_commercial_events",JSON.stringify(e))},getActiveEvents:async()=>{const t=await vd.getAllEvents(),e=new Date;return e.getMonth()+1,e.getDate(),t.filter(n=>{if(!n.isActive)return!1;const r=new Date(e.getFullYear(),n.triggerDate.month-1,n.triggerDate.day);r<e&&r.setFullYear(e.getFullYear()+1);const i=r.getTime()-e.getTime();return Math.ceil(i/(1e3*60*60*24))<=n.priorityDays})}},KN=({onClose:t,onSelectItem:e})=>{var g;const[n,r]=R.useState([]),[i,s]=R.useState([]),[o,c]=R.useState([]),[u,d]=R.useState(!0);R.useEffect(()=>{f()},[]);const f=async()=>{d(!0);try{const[x,C,j]=await Promise.all([vd.getAllEvents(),vd.getActiveEvents(),fr.getAll()]);r(x),s(C),c(j)}catch(x){console.error("Error loading dashboard data:",x)}finally{d(!1)}},p=x=>o.filter(C=>{var y,I,N;if(C.statusId!=="stat_available")return!1;const j=(y=x.targetSymbology)==null?void 0:y.some(M=>{var B;return(B=C.symbology)==null?void 0:B.includes(M)}),P=(I=x.targetOccasion)==null?void 0:I.some(M=>{var B;return(B=C.occasion)==null?void 0:B.includes(M)}),b=(N=x.targetProfile)==null?void 0:N.some(M=>{var B;return(B=C.customerProfile)==null?void 0:B.includes(M)});return j||P||b}).slice(0,4);return u?a.jsx("div",{style:{padding:"40px",textAlign:"center"},children:"Cargando Inteligencia Comercial..."}):a.jsxs("div",{style:{padding:"40px",maxWidth:"1200px",margin:"0 auto"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[a.jsxs("div",{children:[a.jsxs("h1",{style:{display:"flex",alignItems:"center",gap:"12px",margin:0},children:[a.jsx(ip,{size:32,color:"var(--primary)"}),"Dashboard de Oportunidades"]}),a.jsx("p",{style:{color:"var(--text-muted)",marginTop:"8px"},children:"Estrategia de ventas impulsada por eventos y perfiles"})]}),a.jsx("button",{className:"btn",onClick:t,children:"Volver al Inventario"})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 300px",gap:"32px"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{fontSize:"18px",marginBottom:"24px",display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(op,{size:20,color:"#e67e22"})," Eventos Prximos (Foco de Venta)"]}),i.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:i.map(x=>{const C=p(x);return a.jsxs("div",{className:"glass-card",style:{padding:"24px",borderLeft:"6px solid var(--primary)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"20px"},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0,fontSize:"20px"},children:x.name}),a.jsxs("span",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:600},children:["FECHA: ",x.triggerDate.day," / ",x.triggerDate.month]})]}),a.jsx("div",{style:{backgroundColor:"var(--primary-light)",padding:"4px 12px",borderRadius:"12px",color:"var(--primary)",fontSize:"12px",fontWeight:700},children:"PRIORIDAD ALTA"})]}),a.jsxs("div",{children:[a.jsxs("h4",{style:{fontSize:"13px",color:"var(--text-muted)",marginBottom:"12px",display:"flex",alignItems:"center",gap:"6px"},children:[a.jsx($a,{size:14})," PIEZAS RECOMENDADAS (",C.length,")"]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px"},children:[C.map(j=>a.jsxs("div",{onClick:()=>e(j),style:{cursor:"pointer",borderRadius:"8px",overflow:"hidden",border:"1px solid #eee",backgroundColor:"white",transition:"transform 0.2s"},onMouseEnter:P=>P.currentTarget.style.transform="translateY(-4px)",onMouseLeave:P=>P.currentTarget.style.transform="translateY(0)",children:[a.jsx("div",{style:{height:"100px",backgroundColor:"#f9f9f9",display:"flex",alignItems:"center",justifyContent:"center"},children:j.images&&j.images[0]?a.jsx("img",{src:j.images[0],alt:j.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):a.jsx(Nl,{size:24,color:"#ccc"})}),a.jsx("div",{style:{padding:"8px",fontSize:"11px",fontWeight:600,textAlign:"center"},children:j.itemCode})]},j.id)),C.length===0&&a.jsx("div",{style:{gridColumn:"span 4",padding:"20px",textAlign:"center",color:"#999",fontSize:"13px",border:"1px dashed #ddd",borderRadius:"8px"},children:"No hay piezas vinculadas a esta estrategia an."})]})]})]},x.id)})}):a.jsxs("div",{className:"glass-card",style:{padding:"40px",textAlign:"center",color:"#666"},children:[a.jsx(jm,{size:48,color:"#ddd",style:{marginBottom:"16px"}}),a.jsx("p",{children:"No hay eventos comerciales activos en los prximos das."})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:"14px",textTransform:"uppercase",color:"var(--text-muted)"},children:"Mtricas de Valor"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontSize:"13px",color:"#666"},children:"Simbologa completada:"}),a.jsxs("span",{style:{fontWeight:700},children:[o.length>0?Math.round(o.filter(x=>x.symbology&&x.symbology.length>0).length/o.length*100):0,"%"]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontSize:"13px",color:"#666"},children:"Perfilado de Cliente:"}),a.jsxs("span",{style:{fontWeight:700},children:[o.length>0?Math.round(o.filter(x=>x.customerProfile&&x.customerProfile.length>0).length/o.length*100):0,"%"]})]})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px",backgroundColor:"#fff8f0"},children:[a.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:"14px",color:"#e67e22"},children:"PRXIMO HIT"}),n.find(x=>{const C=new Date;return new Date(C.getFullYear(),x.triggerDate.month-1,x.triggerDate.day)>C})?a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 4px 0"},children:(g=n.find(x=>{const C=new Date;return new Date(C.getFullYear(),x.triggerDate.month-1,x.triggerDate.day)>C}))==null?void 0:g.name}),a.jsx("p",{style:{fontSize:"12px",color:"#666"},children:"Empieza a preparar el stock."})]}):a.jsx("p",{children:"Calculando..."})]})]})]})]})},QN=({isOpen:t,onClose:e,domainId:n,domainName:r,onUpdate:i})=>{const[s,o]=R.useState([]),[c,u]=R.useState(!1),[d,f]=R.useState(null),[p,g]=R.useState({value:"",sortOrder:1,justification:""});R.useEffect(()=>{t&&n&&x()},[t,n]);const x=async()=>{u(!0);try{const b=await Ft.getValuesByDomain(n);o(b)}catch(b){console.error("Error loading domain values:",b)}finally{u(!1)}},C=async()=>{if(p.value)try{d?await Ft.updateValue(d.id,{value:p.value,sortOrder:Number(p.sortOrder),justification:p.justification}):await Ft.addValue({domainId:n,value:p.value,sortOrder:Number(p.sortOrder),source:"USER_ADDED",justification:p.justification,createdBy:"user"}),g({value:"",sortOrder:s.length+2,justification:""}),f(null),await x(),i&&i()}catch(b){console.error("Error saving domain value:",b),alert("Error al guardar el valor")}},j=async(b,y)=>{window.confirm(`Seguro que desea eliminar "${y}"?`)&&(await Ft.deleteValueLogic(b),await x(),i&&i())},P=b=>{f(b),g({value:b.value,sortOrder:b.sortOrder,justification:b.justification||""})};return t?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px",backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"100%",maxWidth:"600px",backgroundColor:"white",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[a.jsxs("h2",{style:{margin:0,fontSize:"20px"},children:["Gestionar Maestro: ",r]}),a.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer",color:"#666"},children:a.jsx(Br,{size:24})})]}),a.jsxs("div",{style:{backgroundColor:"#f8f9fa",padding:"20px",borderRadius:"12px",marginBottom:"24px",border:"1px solid #eee"},children:[a.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:"14px",textTransform:"uppercase",color:"#666"},children:d?"Editar Valor":"Aadir Nuevo Valor"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(200px, 1fr) 80px",gap:"12px",marginBottom:"12px"},children:[a.jsx("input",{className:"form-control",placeholder:"Ej: Nueva Coleccin, Graduacin...",value:p.value,onChange:b=>g({...p,value:b.target.value})}),a.jsx("input",{type:"number",className:"form-control",placeholder:"Orden",value:p.sortOrder,onChange:b=>g({...p,sortOrder:Number(b.target.value)})})]}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsx("textarea",{className:"form-control",placeholder:"Justificacin necesaria para auditora...",style:{flex:1,minHeight:"40px"},value:p.justification,onChange:b=>g({...p,justification:b.target.value})}),a.jsx("button",{className:"btn btn-primary",onClick:C,disabled:!p.value,style:{alignSelf:"flex-end",height:"42px"},children:d?a.jsx(K1,{size:18}):a.jsx(Ot,{size:18})})]}),d&&a.jsx("button",{onClick:()=>{f(null),g({value:"",sortOrder:s.length+1,justification:""})},style:{background:"none",border:"none",color:"var(--primary)",fontSize:"12px",marginTop:"8px",cursor:"pointer"},children:"Cancelar edicin"})]}),a.jsx("div",{style:{overflowY:"auto",flex:1},children:c?a.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999"},children:"Cargando valores..."}):s.length===0?a.jsxs("div",{style:{padding:"40px",textAlign:"center",color:"#999"},children:[a.jsx(As,{size:32,style:{opacity:.3,marginBottom:"12px"}}),a.jsx("p",{children:"No hay valores definidos para este maestro."})]}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.map(b=>a.jsxs("div",{style:{padding:"12px 16px",borderRadius:"10px",backgroundColor:"white",border:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"background 0.2s"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:800,color:"#ccc",width:"20px"},children:b.sortOrder}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:600,fontSize:"14px"},children:b.value}),a.jsx("div",{style:{fontSize:"10px",color:"#999"},children:b.source==="NORMATIVE"?"SISTEMA":"MANUAL"})]})]}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:()=>P(b),style:{background:"none",border:"none",color:"#666",cursor:"pointer",padding:"4px"},children:a.jsx(Pl,{size:14})}),b.source!=="NORMATIVE"&&a.jsx("button",{onClick:()=>j(b.id,b.value),style:{background:"none",border:"none",color:"#e74c3c",cursor:"pointer",padding:"4px"},children:a.jsx(Zn,{size:14})})]})]},b.id))})})]})}):null},YN=()=>{var Gs,wc,ma,ga;const[t,e]=R.useState([]),[n,r]=R.useState([]),[i,s]=R.useState([]),[o,c]=R.useState([]),[u,d]=R.useState([]),[f,p]=R.useState([]),[g,x]=R.useState([]),[C,j]=R.useState([]),[P,b]=R.useState([]),[y,I]=R.useState([]),[N,M]=R.useState([]),[B,_]=R.useState(!1),[v,S]=R.useState({id:"",name:""}),[A,k]=R.useState(!1),[D,T]=R.useState([]),[fe,Qe]=R.useState([]),[He,Ne]=R.useState({}),[K,O]=R.useState(!1),[Q,xe]=R.useState(null),[ue,Ze]=R.useState("grid"),[$e,kt]=R.useState(""),[ze,it]=R.useState(!1),[Le,st]=R.useState([]),[H,Ie]=R.useState(null),[de,et]=R.useState(!1),[We,Ce]=R.useState(""),[we,F]=R.useState({categoryId:"",locationId:"",statusId:"",minPrice:"",maxPrice:""}),[re,ge]=R.useState(!1),[be,$]=R.useState(!1),[le,_e]=R.useState({commercialLine:"",symbology:[],occasion:[],customerProfile:[]}),[W,oe]=R.useState({name:"",description:"",categoryId:"",subcategoryId:"",locationId:"",statusId:"",purchasePrice:0,salePrice:0,mainWeight:0,isApproved:!1,itemCode:"",comments:"",socialDescription:"",detailedDescription:{design:"",details:"",materials:"",technicalSpecs:"",symbolism:""},commercialLine:"",collection:"",symbology:[],occasion:[],customerProfile:[],attributes:{}}),[ce,wt]=R.useState(null),[en,mt]=R.useState(0),[gt,Ve]=R.useState(!1),[at,Ln]=R.useState([]),[ii,Hn]=R.useState([]),[Sn,si]=R.useState(!1),_r=Kt.useRef(null),[qs,rr]=R.useState(!1),[oi,ke]=R.useState(""),[Et,yt]=R.useState(""),[tn,nn]=R.useState([]);R.useEffect(()=>{Mn()},[]);const Wt=async()=>{rr(!0);const w=new Date;w.setDate(w.getDate()+3),ke(w.toISOString().split("T")[0]);try{const V=await Ai.getAll();nn(V)}catch(V){console.error("Error loading customers for reservation:",V)}},jt=async()=>{if(!ce||!Et||!oi){alert("Por favor, selecciona un cliente y una fecha de vencimiento.");return}try{await bu.createReservation({itemId:ce.id,customerId:Et,locationId:ce.locationId,expiryDate:new Date(oi),resolutionNote:"",createdBy:"admin"}),rr(!1),wt(null),await Mn(),alert("Reserva creada con xito.")}catch(w){console.error("Error creating reservation:",w),alert("Error al crear la reserva.")}};R.useEffect(()=>{(async()=>{try{let V=[];W.subcategoryId?V=await ar.getAttributesBySubcategory(W.subcategoryId,W.categoryId):W.categoryId&&(V=await ar.getAttributesByCategory(W.categoryId)),T(V);const Y={};for(const ne of V){const ie=fe.find(Me=>Me.id===ne.attributeId);(ie==null?void 0:ie.dataType)==="LIST"&&ie.domainId&&(Y[ne.attributeId]=await Ft.getValuesByDomain(ie.domainId))}Ne(Y),V.length>0&&oe(ne=>{const ie={...ne.attributes};return V.forEach(Me=>{ie[Me.attributeId]===void 0&&(ie[Me.attributeId]="")}),{...ne,attributes:ie}})}catch(V){console.error("Error en fetchFields:",V)}})()},[W.subcategoryId,W.categoryId,fe]);const Mn=async()=>{var w;console.log("Iniciando carga de datos...");try{const[V,Y,ne,ie,Me,us,Pe]=await Promise.all([fr.getAll(),ul.getAll(),Po.getAll(),xs.getAll(),Ka.getAll(),ji.getAll(),Ai.getAll()]);console.log("Datos cargados:",{items:V.length,cats:Y.length,subs:ne.length}),e(V),r(Y),s(ne),c(ie),d(Me),Qe(us),p(Pe),await ht()}catch(V){console.error("Error crtico en loadData:",V),(w=V.message)!=null&&w.includes("permissions")?alert("Error de permisos en Firestore. Asegrate de que las reglas de seguridad permitan el acceso de lectura/escritura."):alert("Error al cargar los datos iniciales. Revisa la consola para ms detalles.")}},ht=async()=>{try{const[w,V,Y,ne,ie]=await Promise.all([Ft.getValuesByDomain("dom_linea"),Ft.getValuesByDomain("dom_coleccion"),Ft.getValuesByDomain("dom_perfil_cli"),Ft.getValuesByDomain("dom_simbol"),Ft.getValuesByDomain("dom_ocasion")]);x(w),j(V),b(Y),I(ne),M(ie)}catch(w){console.error("Error loading commercial masters:",w)}},yn=async w=>{w.preventDefault(),Ve(!0);try{const V=[...at];Q?await fr.update(Q,{...W,images:V}):await fr.create({...W,images:V,createdBy:"admin",socialDescription:W.socialDescription,detailedDescription:W.detailedDescription,commercialLine:W.commercialLine,collection:W.collection,symbology:W.symbology,occasion:W.occasion,customerProfile:W.customerProfile}),O(!1),rn(),await Mn()}catch(V){console.error("Error saving item:",V),alert("No se pudo guardar la pieza.")}finally{Ve(!1)}},rn=()=>{oe({name:"",description:"",categoryId:"",subcategoryId:"",locationId:"",statusId:"",purchasePrice:0,salePrice:0,mainWeight:0,isApproved:!1,itemCode:"",comments:"",socialDescription:"",detailedDescription:{design:"",details:"",materials:"",technicalSpecs:"",symbolism:""},commercialLine:"",collection:"",symbology:[],occasion:[],customerProfile:[],attributes:{}}),T([]),xe(null),Ln([]),Hn([])},qt=(w,V)=>{oe(Y=>({...Y,attributes:{...Y.attributes,[w]:V}}))},ir=w=>{var V,Y,ne,ie,Me;oe({name:w.name,description:w.description,categoryId:w.categoryId,subcategoryId:w.subcategoryId,locationId:w.locationId,statusId:w.statusId,purchasePrice:w.purchasePrice||0,salePrice:w.salePrice||0,mainWeight:w.mainWeight||0,isApproved:w.isApproved||!1,itemCode:w.itemCode||"",comments:w.comments||"",socialDescription:w.socialDescription||"",detailedDescription:{design:((V=w.detailedDescription)==null?void 0:V.design)||"",details:((Y=w.detailedDescription)==null?void 0:Y.details)||"",materials:((ne=w.detailedDescription)==null?void 0:ne.materials)||"",technicalSpecs:((ie=w.detailedDescription)==null?void 0:ie.technicalSpecs)||"",symbolism:((Me=w.detailedDescription)==null?void 0:Me.symbolism)||""},commercialLine:w.commercialLine||"",collection:w.collection||"",symbology:w.symbology||[],occasion:w.occasion||[],customerProfile:w.customerProfile||[],attributes:w.attributes||{}}),xe(w.id),Ln(w.images||[]),wt(null),O(!0)},vn=w=>new Promise((V,Y)=>{const ne=new FileReader;ne.readAsDataURL(w),ne.onload=()=>V(ne.result),ne.onerror=ie=>Y(ie)}),Cn=async w=>{var V,Y;Ve(!0);try{const ne=await vn(w),ie=await y0.analyzeImage(ne,w.type,{attributes:fe,mappings:D,domainValuesMap:He}),Me=((V=n.find(Pe=>Pe.id===ie.categoryId||Pe.name.toLowerCase()===(ie.categoryId||"").toLowerCase()))==null?void 0:V.id)||ie.categoryId||"",us=((Y=i.find(Pe=>Pe.id===ie.subcategoryId||Pe.name.toLowerCase()===(ie.subcategoryId||"").toLowerCase()))==null?void 0:Y.id)||ie.subcategoryId||"";oe(Pe=>{var on,An,Er,li,Be;return{...Pe,name:ie.name||Pe.name,description:ie.description||Pe.description,socialDescription:ie.socialDescription||Pe.socialDescription,detailedDescription:{design:((on=ie.detailedDescription)==null?void 0:on.design)||Pe.detailedDescription.design,details:((An=ie.detailedDescription)==null?void 0:An.details)||Pe.detailedDescription.details,materials:((Er=ie.detailedDescription)==null?void 0:Er.materials)||Pe.detailedDescription.materials,technicalSpecs:((li=ie.detailedDescription)==null?void 0:li.technicalSpecs)||Pe.detailedDescription.technicalSpecs,symbolism:((Be=ie.detailedDescription)==null?void 0:Be.symbolism)||Pe.detailedDescription.symbolism},commercialLine:ie.commercialLine||Pe.commercialLine,symbology:ie.symbology||Pe.symbology,occasion:ie.occasion||Pe.occasion,customerProfile:ie.customerProfile||Pe.customerProfile,categoryId:Me,subcategoryId:us,attributes:{...Pe.attributes,...ie.attributes||{}}}})}catch(ne){console.error("Error en anlisis IA:",ne),alert(ne.message||"No se pudo completar el anlisis de la imagen.")}finally{Ve(!1)}},sn=async()=>{k(!0);try{const w={name:W.name,category:fa(W.categoryId),subcategory:ls(W.subcategoryId),commercialLine:W.commercialLine,collection:W.collection,symbology:(W.symbology||[]).join(", "),occasion:(W.occasion||[]).join(", "),customerProfile:(W.customerProfile||[]).join(", ")},V=await y0.generateCopywriting(w);V&&(oe(Y=>({...Y,socialDescription:V.socialDescription||Y.socialDescription,detailedDescription:{...Y.detailedDescription,...V.detailedDescription}})),alert("Contenido generado con xito."))}catch(w){console.error("Error generating AI content:",w),alert("Error al generar contenido con IA.")}finally{k(!1)}},ai=async w=>{if(w.target.files&&w.target.files.length>0){const V=Array.from(w.target.files),Y=await Promise.all(V.map(ne=>vn(ne)));Ln(ne=>[...ne,...Y]),Hn(ne=>[...ne,...V]),at.length===0&&Cn(V[0])}},xc=async w=>{if(w.preventDefault(),si(!1),w.dataTransfer.files&&w.dataTransfer.files.length>0){const V=Array.from(w.dataTransfer.files),Y=await Promise.all(V.map(ne=>vn(ne)));Ln(ne=>[...ne,...Y]),Hn(ne=>[...ne,...V]),at.length===0&&Cn(V[0])}},da=()=>{ii.length>0?Cn(ii[0]):alert("Sube una imagen primero para analizarla con IA.")},sr=t.filter(w=>{const V=w.name.toLowerCase().includes($e.toLowerCase())||w.itemCode.toLowerCase().includes($e.toLowerCase())||w.description.toLowerCase().includes($e.toLowerCase()),Y=!we.categoryId||w.categoryId===we.categoryId,ne=!we.locationId||w.locationId===we.locationId,ie=!we.statusId||w.statusId===we.statusId,Me=w.salePrice||0,us=!we.minPrice||Me>=parseFloat(we.minPrice),Pe=!we.maxPrice||Me<=parseFloat(we.maxPrice);let on=!0;if(de&&We){const An=We.toLowerCase(),Er=(w.commercialLine||"").toLowerCase(),li=(w.collection||"").toLowerCase(),Be=(w.symbology||[]).join(" ").toLowerCase(),Ks=(w.occasion||[]).join(" ").toLowerCase(),ds=(w.customerProfile||[]).join(" ").toLowerCase();on=Er.includes(An)||li.includes(An)||Be.includes(An)||Ks.includes(An)||ds.includes(An)}return V&&Y&&ne&&ie&&us&&Pe&&on}).sort((w,V)=>{if(!H)return 0;const{field:Y,direction:ne}=H;let ie=w[Y],Me=V[Y];return Y==="createdAt"&&(ie=new Date(ie).getTime(),Me=new Date(Me).getTime()),ie<Me?ne==="asc"?-1:1:ie>Me?ne==="asc"?1:-1:0}),_c=()=>{Le.length===sr.length?st([]):st(sr.map(w=>w.id))},ha=w=>{st(V=>V.includes(w)?V.filter(Y=>Y!==w):[...V,w])},wr=w=>{Ie(V=>(V==null?void 0:V.field)===w?{field:w,direction:V.direction==="asc"?"desc":"asc"}:{field:w,direction:"asc"})},fa=w=>{var V;return((V=n.find(Y=>Y.id===w))==null?void 0:V.name)||"N/A"},ls=w=>{var V;return((V=i.find(Y=>Y.id===w))==null?void 0:V.name)||"N/A"},pa=w=>{var V;return((V=o.find(Y=>Y.id===w))==null?void 0:V.name)||"N/A"},Hs=w=>{var V;return((V=u.find(Y=>Y.id===w))==null?void 0:V.name)||"N/A"},cs=w=>{const V=fe.find(Y=>Y.id===w.attributeId);return V?a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("label",{style:{display:"block",marginBottom:"6px",fontSize:"13px",fontWeight:600},children:[V.name," ",w.isMandatory&&a.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),V.dataType==="LIST"?a.jsxs("select",{required:w.isMandatory,value:W.attributes[V.id]||"",onChange:Y=>qt(V.id,Y.target.value),className:"form-control",style:{width:"100%"},children:[a.jsx("option",{value:"",children:"Seleccione..."}),(He[V.id]||[]).map(Y=>a.jsx("option",{value:Y.value,children:Y.value},Y.id))]}):V.dataType==="NUMBER"?a.jsx("input",{type:"number",required:w.isMandatory,className:"form-control",style:{width:"100%"},value:W.attributes[V.id]||"",onChange:Y=>qt(V.id,Y.target.value)}):V.dataType==="BOOLEAN"?a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("input",{type:"checkbox",checked:!!W.attributes[V.id],onChange:Y=>qt(V.id,Y.target.checked)}),a.jsx("span",{style:{fontSize:"13px"},children:"S / No"})]}):a.jsx("input",{type:"text",required:w.isMandatory,className:"form-control",style:{width:"100%"},value:W.attributes[V.id]||"",onChange:Y=>qt(V.id,Y.target.value)})]},V.id):null},Mr=()=>{const w=V=>(H==null?void 0:H.field)!==V?a.jsx(UC,{size:12,className:"sort-icon"}):H.direction==="asc"?a.jsx(qC,{size:12,className:"sort-icon"}):a.jsx(WC,{size:12,className:"sort-icon"});return a.jsx("div",{className:"excel-container",children:a.jsxs("table",{className:"excel-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"40px"},className:"badge-cell",children:a.jsx("input",{type:"checkbox",checked:Le.length===sr.length&&sr.length>0,onChange:_c})}),a.jsxs("th",{style:{width:"50px"},className:"sortable",onClick:()=>wr("can"),children:["CAN ",w("can")]}),a.jsxs("th",{style:{width:"100px"},className:`sortable ${(H==null?void 0:H.field)==="createdAt"?"active-sort":""}`,onClick:()=>wr("createdAt"),children:["FECHA ",w("createdAt")]}),a.jsx("th",{style:{width:"60px"},children:"IMAGEN"}),a.jsxs("th",{style:{width:"120px"},className:`sortable ${(H==null?void 0:H.field)==="itemCode"?"active-sort":""}`,onClick:()=>wr("itemCode"),children:["REF ",w("itemCode")]}),a.jsxs("th",{className:"sortable",onClick:()=>wr("description"),children:["DESCRIPCIN ",w("description")]}),a.jsxs("th",{style:{width:"100px"},className:`sortable ${(H==null?void 0:H.field)==="purchasePrice"?"active-sort":""}`,onClick:()=>wr("purchasePrice"),children:["COSTE ",w("purchasePrice")]}),a.jsxs("th",{style:{width:"80px"},className:`sortable ${(H==null?void 0:H.field)==="mainWeight"?"active-sort":""}`,onClick:()=>wr("mainWeight"),children:["PESO ",w("mainWeight")]}),a.jsxs("th",{style:{width:"100px"},className:`sortable ${(H==null?void 0:H.field)==="salePrice"?"active-sort":""}`,onClick:()=>wr("salePrice"),children:["P. VENTA ",w("salePrice")]}),a.jsx("th",{style:{width:"110px"},children:"DISPONIBLE"}),a.jsx("th",{children:"COMENTARIOS"})]})}),a.jsx("tbody",{children:sr.map(V=>{var Y,ne;return a.jsxs("tr",{className:Le.includes(V.id)?"selected":"",onClick:()=>{wt(V),mt(0)},style:{cursor:"pointer"},children:[a.jsx("td",{className:"badge-cell",onClick:ie=>{ie.stopPropagation(),ha(V.id)},children:a.jsx("input",{type:"checkbox",checked:Le.includes(V.id),readOnly:!0})}),a.jsx("td",{className:"number",children:"1"}),a.jsx("td",{className:"date",children:new Date(V.createdAt).toLocaleDateString()}),a.jsx("td",{className:"badge-cell",children:a.jsx("div",{className:"excel-thumbnail-container",children:V.images&&V.images.length>0?a.jsx("img",{src:V.images[0],alt:V.name,className:"excel-thumbnail"}):a.jsx(Ao,{size:16,color:"#ccc"})})}),a.jsx("td",{style:{fontWeight:600,color:"var(--primary)"},children:V.itemCode}),a.jsx("td",{title:V.description,children:V.description}),a.jsx("td",{className:"number",children:(Y=V.purchasePrice)==null?void 0:Y.toLocaleString("es-ES",{style:"currency",currency:"EUR"})}),a.jsxs("td",{className:"number",children:[V.mainWeight,"g"]}),a.jsx("td",{className:"number",style:{fontWeight:600},children:(ne=V.salePrice)==null?void 0:ne.toLocaleString("es-ES",{style:"currency",currency:"EUR"})}),a.jsx("td",{className:"badge-cell",children:a.jsx("span",{className:`excel-badge ${V.statusId==="stat_available"?"excel-badge-success":"excel-badge-warning"}`,children:V.statusId==="stat_available"?"S":V.statusId==="stat_sold"?"VEND":"NO"})}),a.jsx("td",{style:{color:"var(--text-muted)",fontSize:"11px"},children:V.comments||a.jsx("span",{style:{opacity:.5},children:"-"})})]},V.id)})})]})})};return a.jsxs("div",{className:"container",children:[a.jsxs("header",{style:{marginBottom:"40px",display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Inventario de Activos"}),a.jsx("span",{style:{fontSize:"10px",backgroundColor:"var(--accent)",color:"white",padding:"2px 8px",borderRadius:"4px",fontWeight:800,marginTop:"-15px"},children:"v1.2.2"})]}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Gestin centralizada de existencias y trazabilidad"})]}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"4px",display:"flex",gap:"4px"},children:[a.jsx("button",{onClick:()=>Ze("grid"),style:{padding:"8px",border:"none",background:ue==="grid"?"var(--primary)":"transparent",color:ue==="grid"?"white":"var(--text-muted)",borderRadius:"6px",cursor:"pointer"},children:a.jsx(JC,{size:18})}),a.jsx("button",{onClick:()=>Ze("list"),style:{padding:"8px",border:"none",background:ue==="list"?"var(--primary)":"transparent",color:ue==="list"?"white":"var(--text-muted)",borderRadius:"6px",cursor:"pointer"},children:a.jsx(rp,{size:18})}),a.jsx("button",{onClick:()=>Ze("excel"),style:{padding:"8px",border:"none",background:ue==="excel"?"var(--primary)":"transparent",color:ue==="excel"?"white":"var(--text-muted)",borderRadius:"6px",cursor:"pointer"},children:a.jsx(iA,{size:18})})]}),a.jsxs("button",{className:"btn",style:{backgroundColor:"#f0f4ff",color:"#4338ca",border:"1px solid #c7d2fe",display:"flex",alignItems:"center",gap:"8px"},onClick:()=>ge(!0),children:[a.jsx(ip,{size:18})," Dashboard de Oportunidades"]}),a.jsxs("button",{className:"btn btn-primary",onClick:()=>O(!0),children:[a.jsx(Ot,{size:20})," Alta de Pieza"]})]})]}),a.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",padding:"24px",backgroundColor:de?"var(--primary)":"white",border:"1px solid var(--primary)",transition:"all 0.3s ease"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:de?"16px":0},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:de?"white":"var(--primary)"},children:[a.jsx(op,{size:24}),a.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Asistente de Ventas & Inteligencia"})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx("span",{style:{fontSize:"12px",color:de?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:de?"Modo Estratgico Activo":"Activar Modo Consultivo"}),a.jsx("div",{onClick:()=>et(!de),style:{width:"50px",height:"24px",backgroundColor:de?"#27ae60":"#ddd",borderRadius:"12px",position:"relative",cursor:"pointer",padding:"2px"},children:a.jsx("div",{style:{width:"20px",height:"20px",backgroundColor:"white",borderRadius:"50%",position:"absolute",left:de?"28px":"2px",transition:"left 0.2s ease"}})})]})]}),de&&a.jsxs("div",{style:{display:"flex",gap:"16px",animation:"fadeIn 0.3s ease"},children:[a.jsxs("div",{style:{flex:1,position:"relative"},children:[a.jsx(Yu,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"rgba(255,255,255,0.6)"},size:20}),a.jsx("input",{type:"text",className:"form-control",placeholder:"Busca por intencin: 'Aniversario', 'Minimalista', 'Proteccin', 'Graduacin'...",style:{paddingLeft:"48px",height:"52px",backgroundColor:"rgba(255,255,255,0.15)",border:"1px solid rgba(255,255,255,0.3)",color:"white",fontSize:"16px"},value:We,onChange:w=>Ce(w.target.value)})]}),a.jsx("div",{style:{display:"flex",gap:"8px"},children:["Nupcial","Juvenil","Alta Joyera","Daily Wear"].map(w=>a.jsx("button",{className:"btn",onClick:()=>Ce(w),style:{backgroundColor:We===w?"white":"rgba(255,255,255,0.1)",color:We===w?"var(--primary)":"white",border:"none",fontSize:"12px",fontWeight:700},children:w},w))})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"16px 24px",marginBottom:"32px",display:"flex",gap:"20px",alignItems:"center"},children:[a.jsxs("div",{style:{flex:1,position:"relative"},children:[a.jsx(Yu,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),a.jsx("input",{type:"text",placeholder:"Buscar por nombre o cdigo...",style:{width:"100%",paddingLeft:"40px"},value:$e,onChange:w=>kt(w.target.value)})]}),a.jsxs("button",{className:"btn",style:{border:"1px solid #ddd"},onClick:()=>it(!0),children:[a.jsx(Q1,{size:18})," Filtros ",Object.values(we).filter(w=>w!=="").length>0&&`(${Object.values(we).filter(w=>w!=="").length})`]})]}),Le.length>0&&a.jsxs("div",{style:{position:"fixed",bottom:"32px",left:"50%",transform:"translateX(-50%)",zIndex:100,display:"flex",alignItems:"center",gap:"24px",padding:"16px 32px",backgroundColor:"var(--primary)",borderRadius:"50px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)",color:"white"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",borderRight:"1px solid rgba(255,255,255,0.2)",paddingRight:"24px"},children:[a.jsxs("span",{style:{fontWeight:600},children:[Le.length," seleccionados"]}),a.jsx("button",{onClick:()=>st([]),style:{background:"transparent",border:"none",color:"rgba(255,255,255,0.6)",cursor:"pointer",display:"flex"},children:a.jsx(Br,{size:16})})]}),a.jsxs("div",{style:{display:"flex",gap:"20px"},children:[a.jsxs("button",{className:"bulk-btn",style:{backgroundColor:"#fdf2f2",color:"var(--primary)",borderColor:"#fee2e2"},onClick:()=>$(!0),children:[a.jsx($a,{size:18}),a.jsx("span",{children:"Estrategia IA"})]}),a.jsxs("button",{className:"bulk-btn",title:"Cambiar Ubicacin/Estado",children:[a.jsx(Ts,{size:18}),a.jsx("span",{children:"Mover"})]}),a.jsxs("button",{className:"bulk-btn",title:"Imprimir Etiquetas",children:[a.jsx(eA,{size:18}),a.jsx("span",{children:"Etiquetas"})]}),a.jsxs("button",{className:"bulk-btn",title:"Exportar",children:[a.jsx(KC,{size:18}),a.jsx("span",{children:"Exportar"})]}),a.jsxs("button",{className:"bulk-btn",style:{color:"#ff4d4d"},title:"Eliminar",children:[a.jsx(Zn,{size:18}),a.jsx("span",{children:"Borrar"})]})]})]}),sr.length===0?a.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[a.jsx(Nl,{size:64,style:{color:"#eee",marginBottom:"20px"}}),a.jsx("h3",{children:"No hay piezas registradas"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Empieza dando de alta tu primera joya en el sistema."})]}):ue==="excel"?Mr():a.jsx("div",{style:{display:ue==="grid"?"grid":"block",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"24px"},children:sr.map(w=>{var V;return a.jsxs("div",{className:`glass-card item-card ${Le.includes(w.id)?"selected":""}`,onClick:Y=>{(Y.ctrlKey||Y.metaKey)&&ha(w.id)},style:{padding:"0",overflow:"hidden",marginBottom:ue==="list"?"16px":"0",cursor:"pointer",position:"relative"},children:[a.jsx("div",{onClick:Y=>{Y.stopPropagation(),ha(w.id)},style:{position:"absolute",top:"12px",right:"12px",zIndex:10,width:"24px",height:"24px",borderRadius:"6px",border:"2px solid white",backgroundColor:Le.includes(w.id)?"var(--accent)":"rgba(0,0,0,0.2)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:Le.includes(w.id)&&a.jsx(K1,{size:16,color:"white",strokeWidth:3})}),a.jsxs("div",{style:{height:"180px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",color:"#ccc",position:"relative"},children:[w.images&&w.images.length>0?a.jsx("img",{src:w.images[0],alt:w.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):a.jsx(Ao,{size:48}),a.jsx("div",{style:{position:"absolute",top:"12px",left:"12px"},children:a.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",backgroundColor:"var(--primary)",color:"white",fontSize:"10px",fontWeight:800},children:w.itemCode})}),new Date().getTime()-new Date(w.createdAt||0).getTime()<1728e5&&a.jsx("div",{style:{position:"absolute",top:"12px",left:"80px"},children:a.jsx("span",{style:{padding:"4px 10px",borderRadius:"20px",backgroundColor:"var(--success)",color:"white",fontSize:"10px",fontWeight:800,textTransform:"uppercase"},children:"Nuevo"})})]}),a.jsxs("div",{style:{padding:"20px"},onClick:()=>{wt(w),mt(0)},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[a.jsx("span",{style:{fontSize:"11px",color:"var(--accent)",fontWeight:700},children:fa(w.categoryId)}),a.jsx("span",{style:{fontSize:"11px",color:"var(--text-muted)"},children:Hs(w.statusId)})]}),a.jsx("h3",{style:{marginBottom:"4px"},children:w.name}),a.jsx("p",{style:{fontSize:"13px",color:"var(--text-muted)",marginBottom:"20px",lineClamp:2,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:w.description}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderTop:"1px solid #f1f1f1",paddingTop:"16px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"var(--text-muted)",fontSize:"12px"},children:[a.jsx(Ts,{size:14}),pa(w.locationId)]}),a.jsx("div",{style:{fontWeight:700,color:"var(--primary)"},children:(V=w.salePrice)==null?void 0:V.toLocaleString("es-ES",{style:"currency",currency:"EUR"})})]})]})]},w.id)})}),K&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"40px",width:"800px",backgroundColor:"white",maxHeight:"90vh",overflowY:"auto"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[a.jsx("h2",{style:{margin:0},children:Q?"Editar Pieza":"Alta de Nueva Pieza"}),a.jsxs("button",{type:"button",className:"btn btn-accent",style:{padding:"6px 16px",fontSize:"12px"},onClick:da,disabled:gt,children:[a.jsx(HC,{size:14})," ",gt?"Escaneando...":"Autocompletar con IA"]}),a.jsxs("button",{type:"button",className:"btn",style:{padding:"6px 16px",fontSize:"12px",border:"1px solid #ddd"},onClick:()=>{if(t.length>0){const w=t[t.length-1];oe({...W,name:`${w.name} (Copia)`,categoryId:w.categoryId,subcategoryId:w.subcategoryId,locationId:w.locationId,purchasePrice:w.purchasePrice||0,salePrice:w.salePrice||0,mainWeight:w.mainWeight||0,attributes:{...w.attributes||{}}})}},children:[a.jsx(fv,{size:14})," Duplicar ltimo"]}),a.jsxs("button",{type:"button",className:"btn",style:{padding:"6px 16px",fontSize:"12px",border:"1px solid #ddd"},onClick:rn,children:[a.jsx(gv,{size:14})," Limpiar"]})]}),a.jsx("button",{className:"btn",onClick:()=>O(!1),children:"Esc"})]}),a.jsxs("form",{onSubmit:yn,children:[a.jsxs("div",{style:{marginBottom:"32px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"12px",fontWeight:600},children:"Media (Fotos de la Pieza)"}),a.jsx("input",{type:"file",multiple:!0,ref:_r,style:{display:"none"},onChange:ai,accept:"image/*"}),a.jsxs("div",{style:{border:Sn?"2px solid var(--accent)":"2px dashed #ddd",borderRadius:"12px",padding:"40px",textAlign:"center",backgroundColor:Sn?"var(--accent-light)":"#fafafa",cursor:"pointer",transition:"all 0.2s",opacity:Sn?.7:1},className:"upload-zone",onClick:()=>{var w;return(w=_r.current)==null?void 0:w.click()},onDragOver:w=>{w.preventDefault(),si(!0)},onDragLeave:()=>si(!1),onDrop:xc,children:[a.jsx(YC,{size:40,color:"var(--text-muted)",style:{marginBottom:"12px"}}),a.jsxs("p",{style:{margin:0,color:"var(--text-muted)",fontSize:"14px"},children:["Arrastra las fotos aqu o ",a.jsx("strong",{children:"haz clic para explorar"})]}),a.jsx("p",{style:{marginTop:"4px",color:"#999",fontSize:"11px"},children:"Soporta mltiples imgenes JPG, PNG (Max 5MB)"})]}),at.length>0&&a.jsx("div",{style:{display:"flex",gap:"12px",marginTop:"16px",overflowX:"auto",paddingBottom:"8px"},children:at.map((w,V)=>a.jsxs("div",{style:{position:"relative",flexShrink:0},children:[a.jsx("img",{src:w,style:{width:"80px",height:"80px",borderRadius:"8px",objectFit:"cover",border:"1px solid #eee"}}),a.jsx("button",{type:"button",onClick:Y=>{Y.stopPropagation(),Ln(ne=>ne.filter((ie,Me)=>Me!==V)),Hn(ne=>ne.filter((ie,Me)=>Me!==V))},style:{position:"absolute",top:"-6px",right:"-6px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"var(--error)",color:"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"10px"},children:a.jsx(Br,{size:12})})]},V))})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"40px"},children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Identificacin Bsica"}),a.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"12px"},children:[a.jsx("div",{style:{flex:1},children:a.jsx("input",{required:!0,className:"form-control",value:W.name,onChange:w=>oe({...W,name:w.target.value}),placeholder:"Nombre Corto...",style:{width:"100%"}})}),a.jsx("div",{style:{width:"180px"},children:a.jsx("input",{className:"form-control",value:W.itemCode,onChange:w=>oe({...W,itemCode:w.target.value}),placeholder:"REF (Auto si vaco)",style:{width:"100%",fontWeight:700,color:"var(--primary)"}})})]}),a.jsx("textarea",{required:!0,rows:3,value:W.description,onChange:w=>oe({...W,description:w.target.value}),placeholder:"Descripcin tcnica...",style:{width:"100%",borderRadius:"8px",border:"1px solid #ddd",padding:"12px",marginBottom:"12px"}}),a.jsx("textarea",{rows:2,value:W.comments,onChange:w=>oe({...W,comments:w.target.value}),placeholder:"Comentarios y notas internas...",style:{width:"100%",borderRadius:"8px",border:"1px solid #ddd",padding:"12px",fontSize:"13px",backgroundColor:"#fffcf5"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Clasificacin"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[a.jsxs("select",{required:!0,className:"form-control",value:W.categoryId,onChange:w=>oe({...W,categoryId:w.target.value,subcategoryId:""}),children:[a.jsx("option",{value:"",disabled:!0,children:"Categora..."}),n.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]}),a.jsxs("select",{required:!0,className:"form-control",value:W.subcategoryId,onChange:w=>oe({...W,subcategoryId:w.target.value}),disabled:!W.categoryId,children:[a.jsx("option",{value:"",disabled:!0,children:"Subcategora..."}),i.filter(w=>w.categoryId===W.categoryId).map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]})]}),D.length>0&&a.jsxs("div",{style:{padding:"24px",backgroundColor:"#f9f9f9",borderRadius:"12px",border:"1px solid #eee"},children:[a.jsxs("h4",{style:{margin:"0 0 16px 0",fontSize:"13px",color:"var(--primary)",textTransform:"uppercase"},children:["Especificaciones de ",(Gs=i.find(w=>w.id===W.subcategoryId))==null?void 0:Gs.name]}),D.map(cs)]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Logstica y Estado"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[a.jsxs("select",{required:!0,className:"form-control",value:W.locationId,onChange:w=>oe({...W,locationId:w.target.value}),children:[a.jsx("option",{value:"",disabled:!0,children:"Ubicacin..."}),o.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]}),a.jsxs("select",{required:!0,className:"form-control",value:W.statusId,onChange:w=>oe({...W,statusId:w.target.value}),children:[a.jsx("option",{value:"",disabled:!0,children:"Estado..."}),u.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Pesos y Medidas"}),a.jsx("input",{type:"number",step:"0.01",required:!0,className:"form-control",value:W.mainWeight,onChange:w=>oe({...W,mainWeight:parseFloat(w.target.value)}),placeholder:"Peso exacto (gr)...",style:{width:"100%"}})]}),a.jsxs("div",{style:{backgroundColor:"#fff8f0",padding:"24px",borderRadius:"12px",border:"1px solid #ffe8cc"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[a.jsx("label",{style:{fontWeight:600,color:"#e67e22",margin:0},children:"Valoracin y Margen"}),a.jsx(hv,{size:16,color:"#e67e22"})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"16px"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"11px",color:"#666",fontWeight:600},children:"COSTE ()"}),a.jsx("input",{type:"number",required:!0,className:"form-control",value:W.purchasePrice,onChange:w=>oe({...W,purchasePrice:parseFloat(w.target.value)}),style:{width:"100%",marginTop:"4px"}})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"11px",color:"#666",fontWeight:600},children:"PVP ()"}),a.jsx("input",{type:"number",required:!0,className:"form-control",value:W.salePrice,onChange:w=>oe({...W,salePrice:parseFloat(w.target.value)}),style:{width:"100%",marginTop:"4px"}})]})]}),a.jsx("div",{style:{padding:"12px",backgroundColor:"rgba(230, 126, 34, 0.05)",borderRadius:"8px",border:"1px solid rgba(230, 126, 34, 0.1)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"},children:[a.jsx("span",{style:{color:"#666"},children:"Margen Bruto:"}),a.jsxs("span",{style:{fontWeight:700,color:"#27ae60"},children:[(W.salePrice-W.purchasePrice||0).toLocaleString("es-ES",{style:"currency",currency:"EUR"}),"(",W.purchasePrice>0?((W.salePrice-W.purchasePrice)/W.purchasePrice*100).toFixed(1):0,"%)"]})]})})]})]})]}),a.jsxs("div",{style:{marginTop:"40px",padding:"32px",border:"1px solid #e0e0e0",borderRadius:"16px",backgroundColor:"#fdfdfd"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px"},children:[a.jsx(ip,{size:24,color:"var(--primary)"}),a.jsx("h3",{style:{margin:0},children:"Estrategia Comercial e Inteligencia"})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"24px"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("label",{style:{margin:0,fontWeight:600,fontSize:"13px"},children:"Lnea Comercial"}),a.jsx("button",{type:"button",onClick:()=>{S({id:"dom_linea",name:"Lnea Comercial"}),_(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:0},children:a.jsx(Ju,{size:14})})]}),a.jsxs("select",{className:"form-control",value:W.commercialLine,onChange:w=>oe({...W,commercialLine:w.target.value}),style:{width:"100%"},children:[a.jsx("option",{value:"",children:"Seleccione lnea..."}),g.map(w=>a.jsx("option",{value:w.value,children:w.value},w.id))]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("label",{style:{margin:0,fontWeight:600,fontSize:"13px"},children:"Coleccin"}),a.jsx("button",{type:"button",onClick:()=>{S({id:"dom_coleccion",name:"Colecciones"}),_(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:0},children:a.jsx(Ju,{size:14})})]}),a.jsxs("select",{className:"form-control",value:W.collection,onChange:w=>oe({...W,collection:w.target.value}),style:{width:"100%"},children:[a.jsx("option",{value:"",children:"Seleccione coleccin..."}),C.map(w=>a.jsx("option",{value:w.value,children:w.value},w.id))]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("label",{style:{margin:0,fontWeight:600,fontSize:"13px"},children:"Perfil de Cliente"}),a.jsx("button",{type:"button",onClick:()=>{S({id:"dom_perfil_cli",name:"Perfiles de Cliente"}),_(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:0},children:a.jsx(Ot,{size:14})})]}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",padding:"8px",border:"1px solid #ddd",borderRadius:"8px",minHeight:"42px",backgroundColor:"white"},children:P.map(w=>{var V,Y;return a.jsx("div",{onClick:()=>{const ne=W.customerProfile||[],ie=ne.includes(w.value)?ne.filter(Me=>Me!==w.value):[...ne,w.value];oe({...W,customerProfile:ie})},style:{padding:"4px 10px",borderRadius:"15px",fontSize:"11px",cursor:"pointer",backgroundColor:(V=W.customerProfile)!=null&&V.includes(w.value)?"var(--primary)":"#f0f2f5",color:(Y=W.customerProfile)!=null&&Y.includes(w.value)?"white":"#555",transition:"all 0.2s"},children:w.value},w.id)})})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginTop:"20px"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("label",{style:{margin:0,fontWeight:600,fontSize:"13px"},children:"Simbologa (Tags)"}),a.jsx("button",{type:"button",onClick:()=>{S({id:"dom_simbol",name:"Simbologas"}),_(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:0},children:a.jsx(Ot,{size:14})})]}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",padding:"8px",border:"1px solid #ddd",borderRadius:"8px",minHeight:"42px",backgroundColor:"white"},children:y.map(w=>{var V,Y;return a.jsx("div",{onClick:()=>{const ne=W.symbology||[],ie=ne.includes(w.value)?ne.filter(Me=>Me!==w.value):[...ne,w.value];oe({...W,symbology:ie})},style:{padding:"4px 10px",borderRadius:"15px",fontSize:"11px",cursor:"pointer",backgroundColor:(V=W.symbology)!=null&&V.includes(w.value)?"var(--accent)":"#f0f2f5",color:(Y=W.symbology)!=null&&Y.includes(w.value)?"white":"#555",transition:"all 0.2s"},children:w.value},w.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("label",{style:{margin:0,fontWeight:600,fontSize:"13px"},children:"Ocasin / Motivo"}),a.jsx("button",{type:"button",onClick:()=>{S({id:"dom_ocasion",name:"Ocasiones"}),_(!0)},style:{background:"none",border:"none",color:"var(--primary)",cursor:"pointer",padding:0},children:a.jsx(Ot,{size:14})})]}),a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",padding:"8px",border:"1px solid #ddd",borderRadius:"8px",minHeight:"42px",backgroundColor:"white"},children:N.map(w=>{var V,Y;return a.jsx("div",{onClick:()=>{const ne=W.occasion||[],ie=ne.includes(w.value)?ne.filter(Me=>Me!==w.value):[...ne,w.value];oe({...W,occasion:ie})},style:{padding:"4px 10px",borderRadius:"15px",fontSize:"11px",cursor:"pointer",backgroundColor:(V=W.occasion)!=null&&V.includes(w.value)?"#9b59b6":"#f0f2f5",color:(Y=W.occasion)!=null&&Y.includes(w.value)?"white":"#555",transition:"all 0.2s"},children:w.value},w.id)})})]})]})]}),a.jsxs("div",{style:{marginTop:"24px",padding:"32px",border:"1px solid #e0e0e0",borderRadius:"16px",backgroundColor:"#f8f9ff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx($a,{size:24,color:"#6366f1"}),a.jsx("h3",{style:{margin:0,color:"#4338ca"},children:"Copywriting & Marketing IA"})]}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:sn,disabled:A,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",backgroundColor:"#6366f1",border:"none"},children:A?a.jsxs(a.Fragment,{children:[a.jsx(gv,{size:16,className:"spin"}),"Generando..."]}):a.jsxs(a.Fragment,{children:[a.jsx($a,{size:16}),"Generar con IA"]})})]}),a.jsxs("div",{style:{marginBottom:"24px"},children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",fontWeight:600},children:[a.jsx(nA,{size:16})," Social Media Copy (Instagram/FB)"]}),a.jsx("textarea",{rows:4,className:"form-control",value:W.socialDescription,onChange:w=>oe({...W,socialDescription:w.target.value}),placeholder:"Caption generado para RRSS...",style:{width:"100%",borderRadius:"12px",border:"1px solid #c7d2fe"}})]}),a.jsx("label",{style:{display:"block",marginBottom:"16px",fontWeight:600},children:"Ficha Tcnica Enriquecida"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:"#666"},children:"1. Diseo y Estructura"}),a.jsx("textarea",{rows:3,className:"form-control",value:W.detailedDescription.design,onChange:w=>oe({...W,detailedDescription:{...W.detailedDescription,design:w.target.value}}),style:{width:"100%",marginTop:"4px"}})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:"#666"},children:"2. Detalles de la Pieza"}),a.jsx("textarea",{rows:3,className:"form-control",value:W.detailedDescription.details,onChange:w=>oe({...W,detailedDescription:{...W.detailedDescription,details:w.target.value}}),style:{width:"100%",marginTop:"4px"}})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:"#666"},children:"3. Materiales y Acabados"}),a.jsx("textarea",{rows:3,className:"form-control",value:W.detailedDescription.materials,onChange:w=>oe({...W,detailedDescription:{...W.detailedDescription,materials:w.target.value}}),style:{width:"100%",marginTop:"4px"}})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:"#666"},children:"4. Especificaciones Tcnicas"}),a.jsx("textarea",{rows:3,className:"form-control",value:W.detailedDescription.technicalSpecs,onChange:w=>oe({...W,detailedDescription:{...W.detailedDescription,technicalSpecs:w.target.value}}),style:{width:"100%",marginTop:"4px"}})]})]}),a.jsxs("div",{style:{marginTop:"20px"},children:[a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:600,color:"#666"},children:[a.jsx(mv,{size:14})," 5. Simbolismo de la Pieza"]}),a.jsx("textarea",{rows:3,className:"form-control",value:W.detailedDescription.symbolism,onChange:w=>oe({...W,detailedDescription:{...W.detailedDescription,symbolism:w.target.value}}),style:{width:"100%",marginTop:"4px"}})]})]}),a.jsxs("div",{style:{marginTop:"40px",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>O(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",style:{padding:"12px 32px"},children:Q?"Guardar Cambios":"Crear Pieza y Generar Cdigo"})]})]})]})}),ze&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",zIndex:2e3,display:"flex",justifyContent:"flex-end"},onClick:()=>it(!1),children:a.jsxs("div",{style:{width:"400px",height:"100%",backgroundColor:"white",padding:"40px",display:"flex",flexDirection:"column",boxShadow:"-10px 0 40px rgba(0,0,0,0.1)",animation:"slideIn 0.3s ease-out"},onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsx("h2",{style:{margin:0},children:"Filtros Avanzados"}),a.jsx("button",{className:"btn",onClick:()=>it(!1),children:a.jsx(Br,{size:20})})]}),a.jsxs("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:"24px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Categora"}),a.jsxs("select",{value:we.categoryId,onChange:w=>F({...we,categoryId:w.target.value}),className:"form-control",children:[a.jsx("option",{value:"",children:"Todas las categoras"}),n.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Ubicacin"}),a.jsxs("select",{value:we.locationId,onChange:w=>F({...we,locationId:w.target.value}),className:"form-control",children:[a.jsx("option",{value:"",children:"Todas las ubicaciones"}),o.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Estado"}),a.jsxs("select",{value:we.statusId,onChange:w=>F({...we,statusId:w.target.value}),className:"form-control",children:[a.jsx("option",{value:"",children:"Todos los estados"}),u.map(w=>a.jsx("option",{value:w.id,children:w.name},w.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Rango de Precio ()"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[a.jsx("input",{type:"number",placeholder:"Min",value:we.minPrice,onChange:w=>F({...we,minPrice:w.target.value})}),a.jsx("input",{type:"number",placeholder:"Max",value:we.maxPrice,onChange:w=>F({...we,maxPrice:w.target.value})})]})]})]}),a.jsxs("div",{style:{marginTop:"40px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[a.jsx("button",{className:"btn",style:{justifyContent:"center"},onClick:()=>F({categoryId:"",locationId:"",statusId:"",minPrice:"",maxPrice:""}),children:"Limpiar"}),a.jsx("button",{className:"btn btn-primary",style:{justifyContent:"center"},onClick:()=>it(!1),children:"Aplicar Filtros"})]})]})}),ce&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",zIndex:1500,display:"flex",justifyContent:"flex-end"},onClick:()=>wt(null),children:a.jsxs("div",{style:{width:"600px",height:"100%",backgroundColor:"white",display:"flex",flexDirection:"column",boxShadow:"-10px 0 40px rgba(0,0,0,0.1)",animation:"slideIn 0.3s ease-out",position:"relative"},onClick:w=>w.stopPropagation(),children:[a.jsx("button",{onClick:()=>wt(null),style:{position:"absolute",top:"20px",left:"-50px",width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"-2px 0 10px rgba(0,0,0,0.1)"},children:a.jsx(Br,{size:20})}),a.jsx("div",{style:{height:"300px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",color:"#ccc",position:"relative",overflow:"hidden"},children:ce.images&&ce.images.length>0?a.jsx("img",{src:ce.images[en]||ce.images[0],alt:ce.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):a.jsx(Ao,{size:64})}),ce.images&&ce.images.length>1&&a.jsx("div",{style:{display:"flex",gap:"8px",padding:"12px 40px",overflowX:"auto",borderBottom:"1px solid #eee"},children:ce.images.map((w,V)=>a.jsx("div",{onClick:()=>mt(V),style:{flexShrink:0,width:"60px",height:"60px",borderRadius:"4px",overflow:"hidden",border:V===en?"2px solid var(--accent)":"1px solid #ddd",cursor:"pointer"},children:a.jsx("img",{src:w,style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"#f8f9fa"}})},V))}),a.jsxs("div",{style:{padding:"40px",flex:1,overflowY:"auto"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"24px"},children:[a.jsxs("div",{children:[a.jsxs("span",{style:{fontSize:"12px",color:"var(--accent)",fontWeight:700,textTransform:"uppercase",letterSpacing:"1px"},children:[fa(ce.categoryId)," / ",ls(ce.subcategoryId)]}),a.jsx("h2",{style:{fontSize:"24px",margin:"4px 0 8px 0"},children:ce.name}),a.jsx("code",{style:{fontSize:"12px",backgroundColor:"#f1f1f1",padding:"2px 8px",borderRadius:"4px"},children:ce.itemCode})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:"24px",fontWeight:800,color:"var(--primary)"},children:(ce.salePrice||0).toLocaleString("es-ES",{style:"currency",currency:"EUR"})}),a.jsx("span",{style:{fontSize:"12px",color:"var(--text-muted)"},children:"PVP Estimado"})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"32px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"16px",display:"flex",alignItems:"center",gap:"12px",border:"1px solid #eee"},children:[a.jsx(Ts,{size:18,color:"var(--text-muted)"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:600},children:"UBICACIN"}),a.jsx("div",{style:{fontSize:"13px",fontWeight:600},children:pa(ce.locationId)})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"16px",display:"flex",alignItems:"center",gap:"12px",border:"1px solid #eee"},children:[a.jsx(sA,{size:18,color:"var(--text-muted)"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:600},children:"ESTADO"}),a.jsx("div",{style:{fontSize:"13px",fontWeight:600},children:Hs(ce.statusId)})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"16px",display:"flex",alignItems:"center",gap:"12px",border:"1px solid #eee"},children:[a.jsx(hv,{size:18,color:"var(--text-muted)"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:600},children:"PESO"}),a.jsxs("div",{style:{fontSize:"13px",fontWeight:600},children:[ce.mainWeight||0," gr"]})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"16px",display:"flex",alignItems:"center",gap:"12px",border:"1px solid #eee"},children:[a.jsx("div",{style:{fontSize:"18px",fontWeight:800,color:"#e67e22"},children:""}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:"10px",color:"var(--text-muted)",fontWeight:600},children:"COSTE"}),a.jsx("div",{style:{fontSize:"13px",fontWeight:600},children:(ce.purchasePrice||0).toLocaleString("es-ES",{style:"currency",currency:"EUR"})})]})]})]}),a.jsxs("div",{style:{marginBottom:"32px"},children:[a.jsx("h4",{style:{fontSize:"14px",marginBottom:"12px",textTransform:"uppercase",color:"var(--text-muted)"},children:"Descripcin Tcnica"}),a.jsx("p",{style:{fontSize:"15px",lineHeight:"1.6",color:"#444"},children:ce.description})]}),a.jsxs("div",{className:"glass-card",style:{marginBottom:"32px",padding:"24px",backgroundColor:"#f8f9ff",border:"1px solid #e0e7ff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[a.jsx($a,{size:20,color:"#4f46e5"}),a.jsx("h4",{style:{fontSize:"14px",margin:0,color:"#4338ca",textTransform:"uppercase"},children:"Marketing & Storytelling"})]}),ce.socialDescription&&a.jsxs("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:"white",borderRadius:"8px",border:"1px dashed #c7d2fe"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:"#6366f1"},children:"SOCIAL MEDIA COPY"}),a.jsx("button",{className:"btn-icon",onClick:()=>navigator.clipboard.writeText(ce.socialDescription||""),children:a.jsx(fv,{size:12})})]}),a.jsx("p",{style:{fontSize:"13px",margin:0,fontStyle:"italic",color:"#444"},children:ce.socialDescription})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginBottom:"20px"},children:[ce.commercialLine&&a.jsx("span",{style:{padding:"4px 10px",backgroundColor:"#4338ca",color:"white",borderRadius:"20px",fontSize:"11px",fontWeight:600},children:ce.commercialLine}),(wc=ce.occasion)==null?void 0:wc.map(w=>a.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#e0e7ff",color:"#4338ca",borderRadius:"20px",fontSize:"11px",fontWeight:600},children:[a.jsx(op,{size:10,style:{marginRight:"4px"}})," ",w]},w)),(ma=ce.customerProfile)==null?void 0:ma.map(w=>a.jsxs("span",{style:{padding:"4px 10px",backgroundColor:"#fef3c7",color:"#92400e",borderRadius:"20px",fontSize:"11px",fontWeight:600},children:[a.jsx(oA,{size:10,style:{marginRight:"4px"}})," ",w]},w))]}),((ga=ce.detailedDescription)==null?void 0:ga.symbolism)&&a.jsxs("div",{style:{padding:"12px",backgroundColor:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #f87171"},children:[a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:700,color:"#dc2626",marginBottom:"6px"},children:[a.jsx(mv,{size:14})," SIMBOLOGA E HISTORIA"]}),a.jsx("p",{style:{fontSize:"13px",margin:0,color:"#7f1d1d"},children:ce.detailedDescription.symbolism})]})]}),a.jsxs("div",{style:{marginBottom:"32px",padding:"16px",backgroundColor:"#fdf7e6",borderRadius:"8px",borderLeft:"4px solid #f39c12"},children:[a.jsx("h4",{style:{fontSize:"12px",marginBottom:"8px",textTransform:"uppercase",color:"#a0522d",fontWeight:700},children:"Comentarios Internos"}),ce.comments?a.jsx("p",{style:{fontSize:"13px",color:"#5d4037",margin:0},children:ce.comments}):a.jsx("p",{style:{fontSize:"13px",color:"#999",margin:0,fontStyle:"italic"},children:"Sin comentarios adicionales."})]}),Object.keys(ce.attributes||{}).length>0&&a.jsxs("div",{children:[a.jsx("h4",{style:{fontSize:"14px",marginBottom:"12px",textTransform:"uppercase",color:"var(--text-muted)"},children:"Especificaciones"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:Object.entries(ce.attributes||{}).map(([w,V])=>{const Y=fe.find(ne=>ne.id===w);return a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #f1f1f1"},children:[a.jsx("span",{style:{fontSize:"13px",color:"var(--text-muted)"},children:(Y==null?void 0:Y.name)||w}),a.jsx("span",{style:{fontSize:"13px",fontWeight:600},children:String(V)})]},w)})})]})]}),a.jsxs("div",{style:{padding:"24px 40px",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:"12px"},children:[a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsx("button",{className:"btn btn-primary",style:{flex:1,justifyContent:"center"},onClick:()=>ir(ce),children:"Editar Ficha"}),a.jsx("button",{className:"btn",style:{flex:1,justifyContent:"center",border:"1px solid #ddd"},children:"Ver Historial"})]}),ce.statusId==="stat_available"&&a.jsxs("button",{className:"btn",style:{width:"100%",backgroundColor:"#fff8e1",border:"1px solid #ffe082",color:"#856404",fontWeight:700},onClick:Wt,children:[a.jsx(Dm,{size:16})," Apartar Pieza"]})]})]})}),qs&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"450px",backgroundColor:"white"},children:[a.jsx("h2",{style:{marginBottom:"24px"},children:"Realizar Apartado"}),a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Seleccionar Cliente"}),a.jsxs("select",{className:"form-control",value:Et,onChange:w=>yt(w.target.value),style:{width:"100%"},children:[a.jsx("option",{value:"",children:"Elija un cliente..."}),tn.map(w=>a.jsxs("option",{value:w.id,children:[w.firstName," ",w.lastName," (",w.dni,")"]},w.id))]})]}),a.jsxs("div",{style:{marginBottom:"32px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Fecha de Vencimiento"}),a.jsx("input",{type:"date",className:"form-control",value:oi,onChange:w=>ke(w.target.value),style:{width:"100%"}}),a.jsx("p",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"8px"},children:"La pieza se marcar como CADUCADA automticamente en esta fecha."})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[a.jsx("button",{className:"btn",onClick:()=>rr(!1),children:"Cancelar"}),a.jsx("button",{className:"btn btn-primary",onClick:jt,children:"Crear Apartado"})]})]})}),a.jsx("style",{children:`
                @keyframes slideIn {
                    from { transform: translateX(100%); }
                    to { transform: translateX(0); }
                }
                .bulk-btn {
                    background: transparent;
                    border: none;
                    color: white;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 4px;
                    cursor: pointer;
                    font-size: 10px;
                    font-weight: 600;
                    text-transform: uppercase;
                    transition: opacity 0.2s;
                    padding: 0 8px;
                }
                .bulk-btn:hover {
                    opacity: 0.8;
                }
                .item-card {
                    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
                }
                .item-card:hover {
                    transform: translateY(-4px);
                }
                .item-card.selected {
                    border: 2px solid var(--accent) !important;
                    background-color: rgba(212, 175, 55, 0.02) !important;
                }
                .upload-zone:hover {
                    border-color: var(--accent) !important;
                    background-color: var(--accent-light) !important;
                    opacity: 0.7;
                }
                `}),re&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#fff",zIndex:3e3,overflowY:"auto"},children:a.jsx(KN,{onClose:()=>ge(!1),onSelectItem:w=>{ge(!1),wt(w)}})}),be&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2500,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"500px",backgroundColor:"white"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[a.jsxs("h2",{style:{margin:0},children:["Etiquetado Masivo (",Le.length," piezas)"]}),a.jsx("button",{className:"btn",onClick:()=>$(!1),children:a.jsx(Br,{size:20})})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Lnea Comercial"}),a.jsxs("select",{className:"form-control",value:le.commercialLine,onChange:w=>_e({...le,commercialLine:w.target.value}),style:{width:"100%"},children:[a.jsx("option",{value:"",children:"No cambiar"}),a.jsx("option",{value:"Nupcial",children:"Nupcial"}),a.jsx("option",{value:"Juvenil",children:"Juvenil"}),a.jsx("option",{value:"Alta Joyera",children:"Alta Joyera"}),a.jsx("option",{value:"Daily Wear",children:"Daily Wear"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Aadir Ocasiones (separadas por coma)"}),a.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Compromiso, Boda...",style:{width:"100%"},onChange:w=>_e({...le,occasion:w.target.value.split(",").map(V=>V.trim()).filter(Boolean)})})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600},children:"Aadir Simbologa (separadas por coma)"}),a.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Amor, Infinito...",style:{width:"100%"},onChange:w=>_e({...le,symbology:w.target.value.split(",").map(V=>V.trim()).filter(Boolean)})})]})]}),a.jsxs("div",{style:{marginTop:"32px",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[a.jsx("button",{className:"btn",onClick:()=>$(!1),children:"Cancelar"}),a.jsx("button",{className:"btn btn-primary",onClick:async()=>{try{for(const w of Le){const V=t.find(Y=>Y.id===w);V&&await fr.update(w,{commercialLine:le.commercialLine||V.commercialLine,occasion:[...new Set([...V.occasion||[],...le.occasion])],symbology:[...new Set([...V.symbology||[],...le.symbology])]})}await Mn(),$(!1),st([]),alert(`Se han actualizado ${Le.length} piezas.`)}catch(w){console.error("Error en etiquetado masivo:",w),alert("Error al actualizar las piezas.")}},children:"Aplicar a seleccionados"})]})]})}),a.jsx(QN,{isOpen:B,onClose:()=>_(!1),domainId:v.id,domainName:v.name,onUpdate:ht})]})};function JN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.useMemo(()=>r=>{e.forEach(i=>i(r))},e)}const ch=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function la(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function Eg(t){return"nodeType"in t}function On(t){var e,n;return t?la(t)?t:Eg(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function Ig(t){const{Document:e}=On(t);return t instanceof e}function gc(t){return la(t)?!1:t instanceof On(t).HTMLElement}function jI(t){return t instanceof On(t).SVGElement}function ca(t){return t?la(t)?t.document:Eg(t)?Ig(t)?t:gc(t)||jI(t)?t.ownerDocument:document:document:document}const Lr=ch?R.useLayoutEffect:R.useEffect;function bg(t){const e=R.useRef(t);return Lr(()=>{e.current=t}),R.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function XN(){const t=R.useRef(null),e=R.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=R.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Hl(t,e){e===void 0&&(e=[t]);const n=R.useRef(t);return Lr(()=>{n.current!==t&&(n.current=t)},e),n}function yc(t,e){const n=R.useRef();return R.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function xd(t){const e=bg(t),n=R.useRef(null),r=R.useCallback(i=>{i!==n.current&&(e==null||e(i,n.current)),n.current=i},[]);return[n,r]}function Dp(t){const e=R.useRef();return R.useEffect(()=>{e.current=t},[t]),e.current}let of={};function vc(t,e){return R.useMemo(()=>{if(e)return e;const n=of[t]==null?0:of[t]+1;return of[t]=n,t+"-"+n},[t,e])}function DI(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,o)=>{const c=Object.entries(o);for(const[u,d]of c){const f=s[u];f!=null&&(s[u]=f+t*d)}return s},{...e})}}const Oo=DI(1),Gl=DI(-1);function ZN(t){return"clientX"in t&&"clientY"in t}function Sg(t){if(!t)return!1;const{KeyboardEvent:e}=On(t.target);return e&&t instanceof e}function eP(t){if(!t)return!1;const{TouchEvent:e}=On(t.target);return e&&t instanceof e}function Np(t){if(eP(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return ZN(t)?{x:t.clientX,y:t.clientY}:null}const Kl=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[Kl.Translate.toString(t),Kl.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),_0="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function tP(t){return t.matches(_0)?t:t.querySelector(_0)}const nP={display:"none"};function rP(t){let{id:e,value:n}=t;return Kt.createElement("div",{id:e,style:nP},n)}function iP(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Kt.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function sP(){const[t,e]=R.useState("");return{announce:R.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const NI=R.createContext(null);function oP(t){const e=R.useContext(NI);R.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function aP(){const[t]=R.useState(()=>new Set),e=R.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[R.useCallback(r=>{let{type:i,event:s}=r;t.forEach(o=>{var c;return(c=o[i])==null?void 0:c.call(o,s)})},[t]),e]}const lP={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},cP={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function uP(t){let{announcements:e=cP,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=lP}=t;const{announce:s,announcement:o}=sP(),c=vc("DndLiveRegion"),[u,d]=R.useState(!1);if(R.useEffect(()=>{d(!0)},[]),oP(R.useMemo(()=>({onDragStart(p){let{active:g}=p;s(e.onDragStart({active:g}))},onDragMove(p){let{active:g,over:x}=p;e.onDragMove&&s(e.onDragMove({active:g,over:x}))},onDragOver(p){let{active:g,over:x}=p;s(e.onDragOver({active:g,over:x}))},onDragEnd(p){let{active:g,over:x}=p;s(e.onDragEnd({active:g,over:x}))},onDragCancel(p){let{active:g,over:x}=p;s(e.onDragCancel({active:g,over:x}))}}),[s,e])),!u)return null;const f=Kt.createElement(Kt.Fragment,null,Kt.createElement(rP,{id:r,value:i.draggable}),Kt.createElement(iP,{id:c,announcement:o}));return n?vo.createPortal(f,n):f}var Pt;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Pt||(Pt={}));function _d(){}function w0(t,e){return R.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function dP(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const xr=Object.freeze({x:0,y:0});function PI(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function OI(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function hP(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function E0(t){let{left:e,top:n,height:r,width:i}=t;return[{x:e,y:n},{x:e+i,y:n},{x:e,y:n+r},{x:e+i,y:n+r}]}function LI(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}function I0(t,e,n){return e===void 0&&(e=t.left),n===void 0&&(n=t.top),{x:e+t.width*.5,y:n+t.height*.5}}const fP=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=I0(e,e.left,e.top),s=[];for(const o of r){const{id:c}=o,u=n.get(c);if(u){const d=PI(I0(u),i);s.push({id:c,data:{droppableContainer:o,value:d}})}}return s.sort(OI)},pP=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=E0(e),s=[];for(const o of r){const{id:c}=o,u=n.get(c);if(u){const d=E0(u),f=i.reduce((g,x,C)=>g+PI(d[C],x),0),p=Number((f/4).toFixed(4));s.push({id:c,data:{droppableContainer:o,value:p}})}}return s.sort(OI)};function mP(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),s=Math.min(e.top+e.height,t.top+t.height),o=i-r,c=s-n;if(r<i&&n<s){const u=e.width*e.height,d=t.width*t.height,f=o*c,p=f/(u+d-f);return Number(p.toFixed(4))}return 0}const gP=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=[];for(const s of r){const{id:o}=s,c=n.get(o);if(c){const u=mP(c,e);u>0&&i.push({id:o,data:{droppableContainer:s,value:u}})}}return i.sort(hP)};function yP(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function MI(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:xr}function vP(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((o,c)=>({...o,top:o.top+t*c.y,bottom:o.bottom+t*c.y,left:o.left+t*c.x,right:o.right+t*c.x}),{...n})}}const xP=vP(1);function _P(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function wP(t,e,n){const r=_P(e);if(!r)return t;const{scaleX:i,scaleY:s,x:o,y:c}=r,u=t.left-o-(1-i)*parseFloat(n),d=t.top-c-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),f=i?t.width/i:t.width,p=s?t.height/s:t.height;return{width:f,height:p,top:d,right:u+f,bottom:d+p,left:u}}const EP={ignoreTransform:!1};function ua(t,e){e===void 0&&(e=EP);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:d,transformOrigin:f}=On(t).getComputedStyle(t);d&&(n=wP(n,d,f))}const{top:r,left:i,width:s,height:o,bottom:c,right:u}=n;return{top:r,left:i,width:s,height:o,bottom:c,right:u}}function b0(t){return ua(t,{ignoreTransform:!0})}function IP(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function bP(t,e){return e===void 0&&(e=On(t).getComputedStyle(t)),e.position==="fixed"}function SP(t,e){e===void 0&&(e=On(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=e[i];return typeof s=="string"?n.test(s):!1})}function uh(t,e){const n=[];function r(i){if(e!=null&&n.length>=e||!i)return n;if(Ig(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!gc(i)||jI(i)||n.includes(i))return n;const s=On(t).getComputedStyle(i);return i!==t&&SP(i,s)&&n.push(i),bP(i,s)?n:r(i.parentNode)}return t?r(t):n}function VI(t){const[e]=uh(t,1);return e??null}function af(t){return!ch||!t?null:la(t)?t:Eg(t)?Ig(t)||t===ca(t).scrollingElement?window:gc(t)?t:null:null}function zI(t){return la(t)?t.scrollX:t.scrollLeft}function BI(t){return la(t)?t.scrollY:t.scrollTop}function Pp(t){return{x:zI(t),y:BI(t)}}var Ut;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Ut||(Ut={}));function FI(t){return!ch||!t?!1:t===document.scrollingElement}function UI(t){const e={x:0,y:0},n=FI(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=e.y,s=t.scrollLeft<=e.x,o=t.scrollTop>=r.y,c=t.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:o,isRight:c,maxScroll:r,minScroll:e}}const CP={x:.2,y:.2};function AP(t,e,n,r,i){let{top:s,left:o,right:c,bottom:u}=n;r===void 0&&(r=10),i===void 0&&(i=CP);const{isTop:d,isBottom:f,isLeft:p,isRight:g}=UI(t),x={x:0,y:0},C={x:0,y:0},j={height:e.height*i.y,width:e.width*i.x};return!d&&s<=e.top+j.height?(x.y=Ut.Backward,C.y=r*Math.abs((e.top+j.height-s)/j.height)):!f&&u>=e.bottom-j.height&&(x.y=Ut.Forward,C.y=r*Math.abs((e.bottom-j.height-u)/j.height)),!g&&c>=e.right-j.width?(x.x=Ut.Forward,C.x=r*Math.abs((e.right-j.width-c)/j.width)):!p&&o<=e.left+j.width&&(x.x=Ut.Backward,C.x=r*Math.abs((e.left+j.width-o)/j.width)),{direction:x,speed:C}}function TP(t){if(t===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:e,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function $I(t){return t.reduce((e,n)=>Oo(e,Pp(n)),xr)}function RP(t){return t.reduce((e,n)=>e+zI(n),0)}function kP(t){return t.reduce((e,n)=>e+BI(n),0)}function jP(t,e){if(e===void 0&&(e=ua),!t)return;const{top:n,left:r,bottom:i,right:s}=e(t);VI(t)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const DP=[["x",["left","right"],RP],["y",["top","bottom"],kP]];class Cg{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=uh(n),i=$I(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,o,c]of DP)for(const u of o)Object.defineProperty(this,u,{get:()=>{const d=c(r),f=i[s]-d;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class hl{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var i;(i=this.target)==null||i.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function NP(t){const{EventTarget:e}=On(t);return t instanceof e?t:ca(t)}function lf(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var Gn;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Gn||(Gn={}));function S0(t){t.preventDefault()}function PP(t){t.stopPropagation()}var je;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(je||(je={}));const WI={start:[je.Space,je.Enter],cancel:[je.Esc],end:[je.Space,je.Enter,je.Tab]},OP=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case je.Right:return{...n,x:n.x+25};case je.Left:return{...n,x:n.x-25};case je.Down:return{...n,y:n.y+25};case je.Up:return{...n,y:n.y-25}}};class Ag{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new hl(ca(n)),this.windowListeners=new hl(On(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Gn.Resize,this.handleCancel),this.windowListeners.add(Gn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Gn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&jP(r),n(xr)}handleKeyDown(e){if(Sg(e)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=WI,coordinateGetter:o=OP,scrollBehavior:c="smooth"}=i,{code:u}=e;if(s.end.includes(u)){this.handleEnd(e);return}if(s.cancel.includes(u)){this.handleCancel(e);return}const{collisionRect:d}=r.current,f=d?{x:d.left,y:d.top}:xr;this.referenceCoordinates||(this.referenceCoordinates=f);const p=o(e,{active:n,context:r.current,currentCoordinates:f});if(p){const g=Gl(p,f),x={x:0,y:0},{scrollableAncestors:C}=r.current;for(const j of C){const P=e.code,{isTop:b,isRight:y,isLeft:I,isBottom:N,maxScroll:M,minScroll:B}=UI(j),_=TP(j),v={x:Math.min(P===je.Right?_.right-_.width/2:_.right,Math.max(P===je.Right?_.left:_.left+_.width/2,p.x)),y:Math.min(P===je.Down?_.bottom-_.height/2:_.bottom,Math.max(P===je.Down?_.top:_.top+_.height/2,p.y))},S=P===je.Right&&!y||P===je.Left&&!I,A=P===je.Down&&!N||P===je.Up&&!b;if(S&&v.x!==p.x){const k=j.scrollLeft+g.x,D=P===je.Right&&k<=M.x||P===je.Left&&k>=B.x;if(D&&!g.y){j.scrollTo({left:k,behavior:c});return}D?x.x=j.scrollLeft-k:x.x=P===je.Right?j.scrollLeft-M.x:j.scrollLeft-B.x,x.x&&j.scrollBy({left:-x.x,behavior:c});break}else if(A&&v.y!==p.y){const k=j.scrollTop+g.y,D=P===je.Down&&k<=M.y||P===je.Up&&k>=B.y;if(D&&!g.x){j.scrollTo({top:k,behavior:c});return}D?x.y=j.scrollTop-k:x.y=P===je.Down?j.scrollTop-M.y:j.scrollTop-B.y,x.y&&j.scrollBy({top:-x.y,behavior:c});break}}this.handleMove(e,Oo(Gl(p,this.referenceCoordinates),x))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ag.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=WI,onActivation:i}=e,{active:s}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const c=s.activatorNode.current;return c&&t.target!==c?!1:(t.preventDefault(),i==null||i({event:t.nativeEvent}),!0)}return!1}}];function C0(t){return!!(t&&"distance"in t)}function A0(t){return!!(t&&"delay"in t)}class Tg{constructor(e,n,r){var i;r===void 0&&(r=NP(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:s}=e,{target:o}=s;this.props=e,this.events=n,this.document=ca(o),this.documentListeners=new hl(this.document),this.listeners=new hl(r),this.windowListeners=new hl(On(o)),this.initialCoordinates=(i=Np(s))!=null?i:xr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Gn.Resize,this.handleCancel),this.windowListeners.add(Gn.DragStart,S0),this.windowListeners.add(Gn.VisibilityChange,this.handleCancel),this.windowListeners.add(Gn.ContextMenu,S0),this.documentListeners.add(Gn.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(A0(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(C0(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(Gn.Click,PP,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Gn.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:c}}=s;if(!i)return;const u=(n=Np(e))!=null?n:xr,d=Gl(i,u);if(!r&&c){if(C0(c)){if(c.tolerance!=null&&lf(d,c.tolerance))return this.handleCancel();if(lf(d,c.distance))return this.handleStart()}if(A0(c)&&lf(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}e.cancelable&&e.preventDefault(),o(u)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===je.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const LP={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Rg extends Tg{constructor(e){const{event:n}=e,r=ca(n.target);super(e,LP,r)}}Rg.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const MP={move:{name:"mousemove"},end:{name:"mouseup"}};var Op;(function(t){t[t.RightClick=2]="RightClick"})(Op||(Op={}));class VP extends Tg{constructor(e){super(e,MP,ca(e.event.target))}}VP.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Op.RightClick?!1:(r==null||r({event:n}),!0)}}];const cf={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class zP extends Tg{constructor(e){super(e,cf)}static setup(){return window.addEventListener(cf.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(cf.move.name,e)};function e(){}}}zP.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var fl;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(fl||(fl={}));var wd;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(wd||(wd={}));function BP(t){let{acceleration:e,activator:n=fl.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:o=5,order:c=wd.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:f,delta:p,threshold:g}=t;const x=UP({delta:p,disabled:!s}),[C,j]=XN(),P=R.useRef({x:0,y:0}),b=R.useRef({x:0,y:0}),y=R.useMemo(()=>{switch(n){case fl.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case fl.DraggableRect:return i}},[n,i,u]),I=R.useRef(null),N=R.useCallback(()=>{const B=I.current;if(!B)return;const _=P.current.x*b.current.x,v=P.current.y*b.current.y;B.scrollBy(_,v)},[]),M=R.useMemo(()=>c===wd.TreeOrder?[...d].reverse():d,[c,d]);R.useEffect(()=>{if(!s||!d.length||!y){j();return}for(const B of M){if((r==null?void 0:r(B))===!1)continue;const _=d.indexOf(B),v=f[_];if(!v)continue;const{direction:S,speed:A}=AP(B,v,y,e,g);for(const k of["x","y"])x[k][S[k]]||(A[k]=0,S[k]=0);if(A.x>0||A.y>0){j(),I.current=B,C(N,o),P.current=A,b.current=S;return}}P.current={x:0,y:0},b.current={x:0,y:0},j()},[e,N,r,j,s,o,JSON.stringify(y),JSON.stringify(x),C,d,M,f,JSON.stringify(g)])}const FP={x:{[Ut.Backward]:!1,[Ut.Forward]:!1},y:{[Ut.Backward]:!1,[Ut.Forward]:!1}};function UP(t){let{delta:e,disabled:n}=t;const r=Dp(e);return yc(i=>{if(n||!r||!i)return FP;const s={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Ut.Backward]:i.x[Ut.Backward]||s.x===-1,[Ut.Forward]:i.x[Ut.Forward]||s.x===1},y:{[Ut.Backward]:i.y[Ut.Backward]||s.y===-1,[Ut.Forward]:i.y[Ut.Forward]||s.y===1}}},[n,e,r])}function $P(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return yc(i=>{var s;return e==null?null:(s=r??i)!=null?s:null},[r,e])}function WP(t,e){return R.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,r)}));return[...n,...s]},[]),[t,e])}var Ql;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Ql||(Ql={}));var Lp;(function(t){t.Optimized="optimized"})(Lp||(Lp={}));const T0=new Map;function qP(t,e){let{dragging:n,dependencies:r,config:i}=e;const[s,o]=R.useState(null),{frequency:c,measure:u,strategy:d}=i,f=R.useRef(t),p=P(),g=Hl(p),x=R.useCallback(function(b){b===void 0&&(b=[]),!g.current&&o(y=>y===null?b:y.concat(b.filter(I=>!y.includes(I))))},[g]),C=R.useRef(null),j=yc(b=>{if(p&&!n)return T0;if(!b||b===T0||f.current!==t||s!=null){const y=new Map;for(let I of t){if(!I)continue;if(s&&s.length>0&&!s.includes(I.id)&&I.rect.current){y.set(I.id,I.rect.current);continue}const N=I.node.current,M=N?new Cg(u(N),N):null;I.rect.current=M,M&&y.set(I.id,M)}return y}return b},[t,s,n,p,u]);return R.useEffect(()=>{f.current=t},[t]),R.useEffect(()=>{p||x()},[n,p]),R.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),R.useEffect(()=>{p||typeof c!="number"||C.current!==null||(C.current=setTimeout(()=>{x(),C.current=null},c))},[c,p,x,...r]),{droppableRects:j,measureDroppableContainers:x,measuringScheduled:s!=null};function P(){switch(d){case Ql.Always:return!1;case Ql.BeforeDragging:return n;default:return!n}}}function qI(t,e){return yc(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function HP(t,e){return qI(t,e)}function GP(t){let{callback:e,disabled:n}=t;const r=bg(e),i=R.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function dh(t){let{callback:e,disabled:n}=t;const r=bg(e),i=R.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function KP(t){return new Cg(ua(t),t)}function R0(t,e,n){e===void 0&&(e=KP);const[r,i]=R.useState(null);function s(){i(u=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=u??n)!=null?d:null}const f=e(t);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const o=GP({callback(u){if(t)for(const d of u){const{type:f,target:p}=d;if(f==="childList"&&p instanceof HTMLElement&&p.contains(t)){s();break}}}}),c=dh({callback:s});return Lr(()=>{s(),t?(c==null||c.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),o==null||o.disconnect())},[t]),r}function QP(t){const e=qI(t);return MI(t,e)}const k0=[];function YP(t){const e=R.useRef(t),n=yc(r=>t?r&&r!==k0&&t&&e.current&&t.parentNode===e.current.parentNode?r:uh(t):k0,[t]);return R.useEffect(()=>{e.current=t},[t]),n}function JP(t){const[e,n]=R.useState(null),r=R.useRef(t),i=R.useCallback(s=>{const o=af(s.target);o&&n(c=>c?(c.set(o,Pp(o)),new Map(c)):null)},[]);return R.useEffect(()=>{const s=r.current;if(t!==s){o(s);const c=t.map(u=>{const d=af(u);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,Pp(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=t}return()=>{o(t),o(s)};function o(c){c.forEach(u=>{const d=af(u);d==null||d.removeEventListener("scroll",i)})}},[i,t]),R.useMemo(()=>t.length?e?Array.from(e.values()).reduce((s,o)=>Oo(s,o),xr):$I(t):xr,[t,e])}function j0(t,e){e===void 0&&(e=[]);const n=R.useRef(null);return R.useEffect(()=>{n.current=null},e),R.useEffect(()=>{const r=t!==xr;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?Gl(t,n.current):xr}function XP(t){R.useEffect(()=>{if(!ch)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n==null||n()}},t.map(e=>{let{sensor:n}=e;return n}))}function ZP(t,e){return R.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=o=>{s(o,e)},n},{}),[t,e])}function HI(t){return R.useMemo(()=>t?IP(t):null,[t])}const D0=[];function eO(t,e){e===void 0&&(e=ua);const[n]=t,r=HI(n?On(n):null),[i,s]=R.useState(D0);function o(){s(()=>t.length?t.map(u=>FI(u)?r:new Cg(e(u),u)):D0)}const c=dh({callback:o});return Lr(()=>{c==null||c.disconnect(),o(),t.forEach(u=>c==null?void 0:c.observe(u))},[t]),i}function tO(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return gc(e)?e:t}function nO(t){let{measure:e}=t;const[n,r]=R.useState(null),i=R.useCallback(d=>{for(const{target:f}of d)if(gc(f)){r(p=>{const g=e(f);return p?{...p,width:g.width,height:g.height}:g});break}},[e]),s=dh({callback:i}),o=R.useCallback(d=>{const f=tO(d);s==null||s.disconnect(),f&&(s==null||s.observe(f)),r(f?e(f):null)},[e,s]),[c,u]=xd(o);return R.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const rO=[{sensor:Rg,options:{}},{sensor:Ag,options:{}}],iO={current:{}},Su={draggable:{measure:b0},droppable:{measure:b0,strategy:Ql.WhileDragging,frequency:Lp.Optimized},dragOverlay:{measure:ua}};class pl extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const sO={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new pl,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:_d},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Su,measureDroppableContainers:_d,windowRect:null,measuringScheduled:!1},oO={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:_d,draggableNodes:new Map,over:null,measureDroppableContainers:_d},hh=R.createContext(oO),GI=R.createContext(sO);function aO(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new pl}}}function lO(t,e){switch(e.type){case Pt.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Pt.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Pt.DragEnd:case Pt.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Pt.RegisterDroppable:{const{element:n}=e,{id:r}=n,i=new pl(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Pt.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const o=new pl(t.droppable.containers);return o.set(n,{...s,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Pt.UnregisterDroppable:{const{id:n,key:r}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const s=new pl(t.droppable.containers);return s.delete(n),{...t,droppable:{...t.droppable,containers:s}}}default:return t}}function cO(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:i}=R.useContext(hh),s=Dp(r),o=Dp(n==null?void 0:n.id);return R.useEffect(()=>{if(!e&&!r&&s&&o!=null){if(!Sg(s)||document.activeElement===s.target)return;const c=i.get(o);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const f of[u.current,d.current]){if(!f)continue;const p=tP(f);if(p){p.focus();break}}})}},[r,e,i,o,s]),null}function uO(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((i,s)=>s({transform:i,...r}),n):n}function dO(t){return R.useMemo(()=>({draggable:{...Su.draggable,...t==null?void 0:t.draggable},droppable:{...Su.droppable,...t==null?void 0:t.droppable},dragOverlay:{...Su.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function hO(t){let{activeNode:e,measure:n,initialRect:r,config:i=!0}=t;const s=R.useRef(!1),{x:o,y:c}=typeof i=="boolean"?{x:i,y:i}:i;Lr(()=>{if(!o&&!c||!e){s.current=!1;return}if(s.current||!r)return;const d=e==null?void 0:e.node.current;if(!d||d.isConnected===!1)return;const f=n(d),p=MI(f,r);if(o||(p.x=0),c||(p.y=0),s.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const g=VI(d);g&&g.scrollBy({top:p.y,left:p.x})}},[e,o,c,r,n])}const KI=R.createContext({...xr,scaleX:1,scaleY:1});var _i;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(_i||(_i={}));const fO=R.memo(function(e){var n,r,i,s;let{id:o,accessibility:c,autoScroll:u=!0,children:d,sensors:f=rO,collisionDetection:p=gP,measuring:g,modifiers:x,...C}=e;const j=R.useReducer(lO,void 0,aO),[P,b]=j,[y,I]=aP(),[N,M]=R.useState(_i.Uninitialized),B=N===_i.Initialized,{draggable:{active:_,nodes:v,translate:S},droppable:{containers:A}}=P,k=_!=null?v.get(_):null,D=R.useRef({initial:null,translated:null}),T=R.useMemo(()=>{var ke;return _!=null?{id:_,data:(ke=k==null?void 0:k.data)!=null?ke:iO,rect:D}:null},[_,k]),fe=R.useRef(null),[Qe,He]=R.useState(null),[Ne,K]=R.useState(null),O=Hl(C,Object.values(C)),Q=vc("DndDescribedBy",o),xe=R.useMemo(()=>A.getEnabled(),[A]),ue=dO(g),{droppableRects:Ze,measureDroppableContainers:$e,measuringScheduled:kt}=qP(xe,{dragging:B,dependencies:[S.x,S.y],config:ue.droppable}),ze=$P(v,_),it=R.useMemo(()=>Ne?Np(Ne):null,[Ne]),Le=oi(),st=HP(ze,ue.draggable.measure);hO({activeNode:_!=null?v.get(_):null,config:Le.layoutShiftCompensation,initialRect:st,measure:ue.draggable.measure});const H=R0(ze,ue.draggable.measure,st),Ie=R0(ze?ze.parentElement:null),de=R.useRef({activatorEvent:null,active:null,activeNode:ze,collisionRect:null,collisions:null,droppableRects:Ze,draggableNodes:v,draggingNode:null,draggingNodeRect:null,droppableContainers:A,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),et=A.getNodeFor((n=de.current.over)==null?void 0:n.id),We=nO({measure:ue.dragOverlay.measure}),Ce=(r=We.nodeRef.current)!=null?r:ze,we=B?(i=We.rect)!=null?i:H:null,F=!!(We.nodeRef.current&&We.rect),re=QP(F?null:H),ge=HI(Ce?On(Ce):null),be=YP(B?et??ze:null),$=eO(be),le=uO(x,{transform:{x:S.x-re.x,y:S.y-re.y,scaleX:1,scaleY:1},activatorEvent:Ne,active:T,activeNodeRect:H,containerNodeRect:Ie,draggingNodeRect:we,over:de.current.over,overlayNodeRect:We.rect,scrollableAncestors:be,scrollableAncestorRects:$,windowRect:ge}),_e=it?Oo(it,S):null,W=JP(be),oe=j0(W),ce=j0(W,[H]),wt=Oo(le,oe),en=we?xP(we,le):null,mt=T&&en?p({active:T,collisionRect:en,droppableRects:Ze,droppableContainers:xe,pointerCoordinates:_e}):null,gt=LI(mt,"id"),[Ve,at]=R.useState(null),Ln=F?le:Oo(le,ce),ii=yP(Ln,(s=Ve==null?void 0:Ve.rect)!=null?s:null,H),Hn=R.useRef(null),Sn=R.useCallback((ke,Et)=>{let{sensor:yt,options:tn}=Et;if(fe.current==null)return;const nn=v.get(fe.current);if(!nn)return;const Wt=ke.nativeEvent,jt=new yt({active:fe.current,activeNode:nn,event:Wt,options:tn,context:de,onAbort(ht){if(!v.get(ht))return;const{onDragAbort:rn}=O.current,qt={id:ht};rn==null||rn(qt),y({type:"onDragAbort",event:qt})},onPending(ht,yn,rn,qt){if(!v.get(ht))return;const{onDragPending:vn}=O.current,Cn={id:ht,constraint:yn,initialCoordinates:rn,offset:qt};vn==null||vn(Cn),y({type:"onDragPending",event:Cn})},onStart(ht){const yn=fe.current;if(yn==null)return;const rn=v.get(yn);if(!rn)return;const{onDragStart:qt}=O.current,ir={activatorEvent:Wt,active:{id:yn,data:rn.data,rect:D}};vo.unstable_batchedUpdates(()=>{qt==null||qt(ir),M(_i.Initializing),b({type:Pt.DragStart,initialCoordinates:ht,active:yn}),y({type:"onDragStart",event:ir}),He(Hn.current),K(Wt)})},onMove(ht){b({type:Pt.DragMove,coordinates:ht})},onEnd:Mn(Pt.DragEnd),onCancel:Mn(Pt.DragCancel)});Hn.current=jt;function Mn(ht){return async function(){const{active:rn,collisions:qt,over:ir,scrollAdjustedTranslate:vn}=de.current;let Cn=null;if(rn&&vn){const{cancelDrop:sn}=O.current;Cn={activatorEvent:Wt,active:rn,collisions:qt,delta:vn,over:ir},ht===Pt.DragEnd&&typeof sn=="function"&&await Promise.resolve(sn(Cn))&&(ht=Pt.DragCancel)}fe.current=null,vo.unstable_batchedUpdates(()=>{b({type:ht}),M(_i.Uninitialized),at(null),He(null),K(null),Hn.current=null;const sn=ht===Pt.DragEnd?"onDragEnd":"onDragCancel";if(Cn){const ai=O.current[sn];ai==null||ai(Cn),y({type:sn,event:Cn})}})}}},[v]),si=R.useCallback((ke,Et)=>(yt,tn)=>{const nn=yt.nativeEvent,Wt=v.get(tn);if(fe.current!==null||!Wt||nn.dndKit||nn.defaultPrevented)return;const jt={active:Wt};ke(yt,Et.options,jt)===!0&&(nn.dndKit={capturedBy:Et.sensor},fe.current=tn,Sn(yt,Et))},[v,Sn]),_r=WP(f,si);XP(f),Lr(()=>{H&&N===_i.Initializing&&M(_i.Initialized)},[H,N]),R.useEffect(()=>{const{onDragMove:ke}=O.current,{active:Et,activatorEvent:yt,collisions:tn,over:nn}=de.current;if(!Et||!yt)return;const Wt={active:Et,activatorEvent:yt,collisions:tn,delta:{x:wt.x,y:wt.y},over:nn};vo.unstable_batchedUpdates(()=>{ke==null||ke(Wt),y({type:"onDragMove",event:Wt})})},[wt.x,wt.y]),R.useEffect(()=>{const{active:ke,activatorEvent:Et,collisions:yt,droppableContainers:tn,scrollAdjustedTranslate:nn}=de.current;if(!ke||fe.current==null||!Et||!nn)return;const{onDragOver:Wt}=O.current,jt=tn.get(gt),Mn=jt&&jt.rect.current?{id:jt.id,rect:jt.rect.current,data:jt.data,disabled:jt.disabled}:null,ht={active:ke,activatorEvent:Et,collisions:yt,delta:{x:nn.x,y:nn.y},over:Mn};vo.unstable_batchedUpdates(()=>{at(Mn),Wt==null||Wt(ht),y({type:"onDragOver",event:ht})})},[gt]),Lr(()=>{de.current={activatorEvent:Ne,active:T,activeNode:ze,collisionRect:en,collisions:mt,droppableRects:Ze,draggableNodes:v,draggingNode:Ce,draggingNodeRect:we,droppableContainers:A,over:Ve,scrollableAncestors:be,scrollAdjustedTranslate:wt},D.current={initial:we,translated:en}},[T,ze,mt,en,v,Ce,we,Ze,A,Ve,be,wt]),BP({...Le,delta:S,draggingRect:en,pointerCoordinates:_e,scrollableAncestors:be,scrollableAncestorRects:$});const qs=R.useMemo(()=>({active:T,activeNode:ze,activeNodeRect:H,activatorEvent:Ne,collisions:mt,containerNodeRect:Ie,dragOverlay:We,draggableNodes:v,droppableContainers:A,droppableRects:Ze,over:Ve,measureDroppableContainers:$e,scrollableAncestors:be,scrollableAncestorRects:$,measuringConfiguration:ue,measuringScheduled:kt,windowRect:ge}),[T,ze,H,Ne,mt,Ie,We,v,A,Ze,Ve,$e,be,$,ue,kt,ge]),rr=R.useMemo(()=>({activatorEvent:Ne,activators:_r,active:T,activeNodeRect:H,ariaDescribedById:{draggable:Q},dispatch:b,draggableNodes:v,over:Ve,measureDroppableContainers:$e}),[Ne,_r,T,H,b,Q,v,Ve,$e]);return Kt.createElement(NI.Provider,{value:I},Kt.createElement(hh.Provider,{value:rr},Kt.createElement(GI.Provider,{value:qs},Kt.createElement(KI.Provider,{value:ii},d)),Kt.createElement(cO,{disabled:(c==null?void 0:c.restoreFocus)===!1})),Kt.createElement(uP,{...c,hiddenTextDescribedById:Q}));function oi(){const ke=(Qe==null?void 0:Qe.autoScrollEnabled)===!1,Et=typeof u=="object"?u.enabled===!1:u===!1,yt=B&&!ke&&!Et;return typeof u=="object"?{...u,enabled:yt}:{enabled:yt}}}),pO=R.createContext(null),N0="button",mO="Draggable";function gO(t){let{id:e,data:n,disabled:r=!1,attributes:i}=t;const s=vc(mO),{activators:o,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:f,draggableNodes:p,over:g}=R.useContext(hh),{role:x=N0,roleDescription:C="draggable",tabIndex:j=0}=i??{},P=(u==null?void 0:u.id)===e,b=R.useContext(P?KI:pO),[y,I]=xd(),[N,M]=xd(),B=ZP(o,e),_=Hl(n);Lr(()=>(p.set(e,{id:e,key:s,node:y,activatorNode:N,data:_}),()=>{const S=p.get(e);S&&S.key===s&&p.delete(e)}),[p,e]);const v=R.useMemo(()=>({role:x,tabIndex:j,"aria-disabled":r,"aria-pressed":P&&x===N0?!0:void 0,"aria-roledescription":C,"aria-describedby":f.draggable}),[r,x,j,P,C,f.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:v,isDragging:P,listeners:r?void 0:B,node:y,over:g,setNodeRef:I,setActivatorNodeRef:M,transform:b}}function yO(){return R.useContext(GI)}const vO="Droppable",xO={timeout:25};function _O(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const s=vc(vO),{active:o,dispatch:c,over:u,measureDroppableContainers:d}=R.useContext(hh),f=R.useRef({disabled:n}),p=R.useRef(!1),g=R.useRef(null),x=R.useRef(null),{disabled:C,updateMeasurementsFor:j,timeout:P}={...xO,...i},b=Hl(j??r),y=R.useCallback(()=>{if(!p.current){p.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),x.current=null},P)},[P]),I=dh({callback:y,disabled:C||!o}),N=R.useCallback((v,S)=>{I&&(S&&(I.unobserve(S),p.current=!1),v&&I.observe(v))},[I]),[M,B]=xd(N),_=Hl(e);return R.useEffect(()=>{!I||!M.current||(I.disconnect(),p.current=!1,I.observe(M.current))},[M,I]),R.useEffect(()=>(c({type:Pt.RegisterDroppable,element:{id:r,key:s,disabled:n,node:M,rect:g,data:_}}),()=>c({type:Pt.UnregisterDroppable,key:s,id:r})),[r]),R.useEffect(()=>{n!==f.current.disabled&&(c({type:Pt.SetDroppableDisabled,id:r,key:s,disabled:n}),f.current.disabled=n)},[r,s,n,c]),{active:o,rect:g,isOver:(u==null?void 0:u.id)===r,node:M,over:u,setNodeRef:B}}function kg(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function wO(t,e){return t.reduce((n,r,i)=>{const s=e.get(r);return s&&(n[i]=s),n},Array(t.length))}function Zc(t){return t!==null&&t>=0}function EO(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function IO(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const QI=t=>{let{rects:e,activeIndex:n,overIndex:r,index:i}=t;const s=kg(e,r,n),o=e[i],c=s[i];return!c||!o?null:{x:c.left-o.left,y:c.top-o.top,scaleX:c.width/o.width,scaleY:c.height/o.height}},eu={scaleX:1,scaleY:1},bO=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:o}=t;const c=(e=s[n])!=null?e:r;if(!c)return null;if(i===n){const d=s[o];return d?{x:0,y:n<o?d.top+d.height-(c.top+c.height):d.top-c.top,...eu}:null}const u=SO(s,i,n);return i>n&&i<=o?{x:0,y:-c.height-u,...eu}:i<n&&i>=o?{x:0,y:c.height+u,...eu}:{x:0,y:0,...eu}};function SO(t,e,n){const r=t[e],i=t[e-1],s=t[e+1];return r?n<e?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const YI="Sortable",JI=Kt.createContext({activeIndex:-1,containerId:YI,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:QI,disabled:{draggable:!1,droppable:!1}});function CO(t){let{children:e,id:n,items:r,strategy:i=QI,disabled:s=!1}=t;const{active:o,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:f}=yO(),p=vc(YI,n),g=c.rect!==null,x=R.useMemo(()=>r.map(B=>typeof B=="object"&&"id"in B?B.id:B),[r]),C=o!=null,j=o?x.indexOf(o.id):-1,P=d?x.indexOf(d.id):-1,b=R.useRef(x),y=!EO(x,b.current),I=P!==-1&&j===-1||y,N=IO(s);Lr(()=>{y&&C&&f(x)},[y,x,C,f]),R.useEffect(()=>{b.current=x},[x]);const M=R.useMemo(()=>({activeIndex:j,containerId:p,disabled:N,disableTransforms:I,items:x,overIndex:P,useDragOverlay:g,sortedRects:wO(x,u),strategy:i}),[j,p,N.draggable,N.droppable,I,x,P,u,g,i]);return Kt.createElement(JI.Provider,{value:M},e)}const AO=t=>{let{id:e,items:n,activeIndex:r,overIndex:i}=t;return kg(n,r,i).indexOf(e)},TO=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:i,items:s,newIndex:o,previousItems:c,previousContainerId:u,transition:d}=t;return!d||!r||c!==s&&i===o?!1:n?!0:o!==i&&e===u},RO={duration:200,easing:"ease"},XI="transform",kO=Kl.Transition.toString({property:XI,duration:0,easing:"linear"}),jO={roleDescription:"sortable"};function DO(t){let{disabled:e,index:n,node:r,rect:i}=t;const[s,o]=R.useState(null),c=R.useRef(n);return Lr(()=>{if(!e&&n!==c.current&&r.current){const u=i.current;if(u){const d=ua(r.current,{ignoreTransform:!0}),f={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(f.x||f.y)&&o(f)}}n!==c.current&&(c.current=n)},[e,n,r,i]),R.useEffect(()=>{s&&o(null)},[s]),s}function NO(t){let{animateLayoutChanges:e=TO,attributes:n,disabled:r,data:i,getNewIndex:s=AO,id:o,strategy:c,resizeObserverConfig:u,transition:d=RO}=t;const{items:f,containerId:p,activeIndex:g,disabled:x,disableTransforms:C,sortedRects:j,overIndex:P,useDragOverlay:b,strategy:y}=R.useContext(JI),I=PO(r,x),N=f.indexOf(o),M=R.useMemo(()=>({sortable:{containerId:p,index:N,items:f},...i}),[p,i,N,f]),B=R.useMemo(()=>f.slice(f.indexOf(o)),[f,o]),{rect:_,node:v,isOver:S,setNodeRef:A}=_O({id:o,data:M,disabled:I.droppable,resizeObserverConfig:{updateMeasurementsFor:B,...u}}),{active:k,activatorEvent:D,activeNodeRect:T,attributes:fe,setNodeRef:Qe,listeners:He,isDragging:Ne,over:K,setActivatorNodeRef:O,transform:Q}=gO({id:o,data:M,attributes:{...jO,...n},disabled:I.draggable}),xe=JN(A,Qe),ue=!!k,Ze=ue&&!C&&Zc(g)&&Zc(P),$e=!b&&Ne,kt=$e&&Ze?Q:null,it=Ze?kt??(c??y)({rects:j,activeNodeRect:T,activeIndex:g,overIndex:P,index:N}):null,Le=Zc(g)&&Zc(P)?s({id:o,items:f,activeIndex:g,overIndex:P}):N,st=k==null?void 0:k.id,H=R.useRef({activeId:st,items:f,newIndex:Le,containerId:p}),Ie=f!==H.current.items,de=e({active:k,containerId:p,isDragging:Ne,isSorting:ue,id:o,index:N,items:f,newIndex:H.current.newIndex,previousItems:H.current.items,previousContainerId:H.current.containerId,transition:d,wasDragging:H.current.activeId!=null}),et=DO({disabled:!de,index:N,node:v,rect:_});return R.useEffect(()=>{ue&&H.current.newIndex!==Le&&(H.current.newIndex=Le),p!==H.current.containerId&&(H.current.containerId=p),f!==H.current.items&&(H.current.items=f)},[ue,Le,p,f]),R.useEffect(()=>{if(st===H.current.activeId)return;if(st!=null&&H.current.activeId==null){H.current.activeId=st;return}const Ce=setTimeout(()=>{H.current.activeId=st},50);return()=>clearTimeout(Ce)},[st]),{active:k,activeIndex:g,attributes:fe,data:M,rect:_,index:N,newIndex:Le,items:f,isOver:S,isSorting:ue,isDragging:Ne,listeners:He,node:v,overIndex:P,over:K,setNodeRef:xe,setActivatorNodeRef:O,setDroppableNodeRef:A,setDraggableNodeRef:Qe,transform:et??it,transition:We()};function We(){if(et||Ie&&H.current.newIndex===N)return kO;if(!($e&&!Sg(D)||!d)&&(ue||de))return Kl.Transition.toString({...d,property:XI})}}function PO(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t==null?void 0:t.draggable)!=null?n:e.draggable,droppable:(r=t==null?void 0:t.droppable)!=null?r:e.droppable}}function Ed(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const OO=[je.Down,je.Right,je.Up,je.Left],LO=(t,e)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:c}}=e;if(OO.includes(t.code)){if(t.preventDefault(),!n||!r)return;const u=[];s.getEnabled().forEach(p=>{if(!p||p!=null&&p.disabled)return;const g=i.get(p.id);if(g)switch(t.code){case je.Down:r.top<g.top&&u.push(p);break;case je.Up:r.top>g.top&&u.push(p);break;case je.Left:r.left>g.left&&u.push(p);break;case je.Right:r.left<g.left&&u.push(p);break}});const d=pP({collisionRect:r,droppableRects:i,droppableContainers:u});let f=LI(d,"id");if(f===(o==null?void 0:o.id)&&d.length>1&&(f=d[1].id),f!=null){const p=s.get(n.id),g=s.get(f),x=g?i.get(g.id):null,C=g==null?void 0:g.node.current;if(C&&x&&p&&g){const P=uh(C).some((B,_)=>c[_]!==B),b=ZI(p,g),y=MO(p,g),I=P||!b?{x:0,y:0}:{x:y?r.width-x.width:0,y:y?r.height-x.height:0},N={x:x.left,y:x.top};return I.x&&I.y?N:Gl(N,I)}}}};function ZI(t,e){return!Ed(t)||!Ed(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function MO(t,e){return!Ed(t)||!Ed(e)||!ZI(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}const VO=t=>{let{transform:e}=t;return{...e,x:0}},zO=()=>{var We,Ce,we;const[t,e]=R.useState([]),[n,r]=R.useState([]),[i,s]=R.useState([]),[o,c]=R.useState(null),[u,d]=R.useState(null),[f,p]=R.useState([]),[g,x]=R.useState("atributos"),[C,j]=R.useState([]),[P,b]=R.useState(!1),[y,I]=R.useState(!1),[N,M]=R.useState(!1),[B,_]=R.useState(null),[v,S]=R.useState(!1),[A,k]=R.useState(!1),[D,T]=R.useState(""),[fe,Qe]=R.useState({name:"",description:""}),[He,Ne]=R.useState({name:"",description:""});R.useEffect(()=>{K()},[]),R.useEffect(()=>{(async()=>{if(u){const re=await ar.getAttributesBySubcategory(u,o||void 0);p(re)}else if(o){const re=await ar.getAttributesByCategory(o);p(re)}else p([])})()},[u,o]);const K=async()=>{try{const[F,re,ge]=await Promise.all([ul.getAll(),Po.getAll(),ji.getAll()]);e(F),r(re),s(ge),F.length>0&&!o&&c(F[0].id)}catch(F){console.error("Error loading base data:",F)}},O=async F=>{const re=u||o,ge=u?"subcategory":"category";re&&(await ar.toggleMandatory(re,F,ge),await Le())},Q=async F=>{var oe;const re=f.find(ce=>ce.attributeId===F);if(!re)return;const ge=!!(u&&!re.subcategoryId),be=re.subcategoryId||re.categoryId,$=re.subcategoryId?"subcategory":"category",le=re.subcategoryId?"subcategora":"categora",_e=((oe=st(F))==null?void 0:oe.name)||"Atributo";let W=`Seguro que desea eliminar el atributo "${_e}" de esta ${le}?`;ge&&(W=`ATENCIN: El atributo "${_e}" es HEREDADO.
Si lo elimina, se borrar de la CATEGORA PADRE y afectar a TODAS sus subcategoras.

Desea proceder con la eliminacin global?`),window.confirm(W)&&be&&(await ar.removeMapping(be,F,$),await Le())},xe=async(F,re)=>{F.stopPropagation();const ge=i.find(be=>be.id===re);ge&&window.confirm(`Seguro que desea eliminar DEFINITIVAMENTE el atributo "${ge.name}" del catlogo maestro?`)&&window.confirm(`ESTA ACCIN ES IRREVERSIBLE.
Se eliminar de todas las categoras y subcategoras donde est vinculado.

Est totalmente seguro?`)&&(await ji.deleteLogic(re),await K(),await Le())},ue=async F=>{const re=u||o,ge=u?"subcategory":"category";re&&(await ar.addMapping(re,F,ge),await Le(),b(!1),T(""))},Ze=(F,re)=>{F.stopPropagation(),_(re),M(!0)},$e=async F=>{F.preventDefault(),B&&(await ji.update(B.id,B),M(!1),_(null),await K())},kt=dP(w0(Rg),w0(Ag,{coordinateGetter:LO})),ze=async F=>{const{active:re,over:ge}=F;if(!ge||re.id===ge.id)return;const be=f.findIndex(oe=>oe.attributeId===re.id),$=f.findIndex(oe=>oe.attributeId===ge.id),le=kg(f,be,$);p(le);const _e=u||o,W=u?"subcategory":"category";_e&&(await ar.reorderMappings(_e,le.map(oe=>oe.attributeId),W),g==="logs"&&await it())},it=async()=>{const F=u||o;if(F){const re=await ar.getLogs(F);j(re)}};R.useEffect(()=>{g==="logs"&&it()},[g,u,o]);const Le=async()=>{if(u){const F=await ar.getAttributesBySubcategory(u,o||void 0);p(F)}else if(o){const F=await ar.getAttributesByCategory(o);p(F)}g==="logs"&&await it()},st=F=>i.find(re=>re.id===F),H=async F=>{F.preventDefault(),await ul.create({...fe,createdBy:"admin"}),Qe({name:"",description:""}),S(!1),await K()},Ie=async F=>{F.preventDefault(),o&&(await Po.create({...He,categoryId:o,createdBy:"admin"}),Ne({name:"",description:""}),k(!1),await K())},de=async(F,re)=>{window.confirm(`Seguro que desea eliminar la categora "${re}"? Se desactivar del sistema.`)&&(await ul.deleteLogic(F),c(null),d(null),await K())},et=async(F,re)=>{window.confirm(`Seguro que desea eliminar la subcategora "${re}"?`)&&(await Po.deleteLogic(F),d(null),await K())};return a.jsxs("div",{className:"container",style:{paddingBottom:"60px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"32px"},children:[a.jsxs("div",{children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Configuracin de Clasificacin Dinmica"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Mapeo inteligente de metadatos y reglas por subcategora"})]}),a.jsxs("div",{style:{display:"flex",gap:"12px"},children:[a.jsxs("button",{className:"btn",style:{backgroundColor:"white",border:"1px solid #ddd"},onClick:()=>I(!0),children:[a.jsx(yv,{size:18})," Gestionar Dominios"]}),a.jsxs("button",{className:"btn btn-primary",children:[a.jsx(Ot,{size:18})," Nuevo Atributo Global"]})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:"12px 24px",marginBottom:"32px",display:"flex",gap:"12px",alignItems:"center",fontSize:"13px"},children:[a.jsx("span",{style:{color:"var(--text-muted)"},children:"Configuracin"}),a.jsx(Ua,{size:14,color:"#ccc"}),a.jsx("span",{style:{fontWeight:600},children:((We=t.find(F=>F.id===o))==null?void 0:We.name)||"Seleccione Categora"}),u&&a.jsxs(a.Fragment,{children:[a.jsx(Ua,{size:14,color:"#ccc"}),a.jsx("span",{style:{fontWeight:600,color:"var(--primary)"},children:(Ce=n.find(F=>F.id===u))==null?void 0:Ce.name})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"300px 300px 1fr",gap:"32px",alignItems:"start"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Categoras"}),a.jsx(Ot,{size:16,color:"var(--primary)",style:{cursor:"pointer"},onClick:()=>S(!0)})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:t.map(F=>a.jsxs("div",{onClick:()=>{c(F.id),d(null)},style:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:o===F.id?"var(--primary)":"transparent",color:o===F.id?"white":"var(--text-main)",transition:"all 0.2s"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx(_s,{size:16,opacity:.7}),a.jsx("span",{style:{fontWeight:600},children:F.name})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(Zn,{size:14,style:{cursor:"pointer",color:o===F.id?"white":"var(--error)",opacity:.6},onClick:re=>{re.stopPropagation(),de(F.id,F.name)}}),a.jsx(Ua,{size:16,opacity:.5})]})]},F.id))})]}),a.jsxs("div",{className:"glass-card",style:{padding:"24px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[a.jsx("h4",{style:{margin:0,textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px",color:"var(--text-muted)"},children:"Subcategoras"}),a.jsx(Ot,{size:16,color:o?"var(--primary)":"#ccc",style:{cursor:o?"pointer":"not-allowed"},onClick:()=>o&&k(!0)})]}),o?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:n.filter(F=>F.categoryId===o).map(F=>a.jsxs("div",{onClick:()=>d(F.id),style:{padding:"12px 16px",borderRadius:"8px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:u===F.id?"rgba(52, 152, 219, 0.1)":"transparent",border:u===F.id?"1px solid var(--primary)":"1px solid transparent",color:u===F.id?"var(--primary)":"var(--text-main)",transition:"all 0.2s"},children:[a.jsx("span",{style:{fontWeight:600},children:F.name}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.jsx(Zn,{size:14,style:{cursor:"pointer",color:"var(--error)",opacity:.6},onClick:re=>{re.stopPropagation(),et(F.id,F.name)}}),a.jsx(Ua,{size:16,opacity:.5})]})]},F.id))}):a.jsxs("div",{style:{textAlign:"center",color:"#ccc",padding:"20px"},children:[a.jsx(As,{size:32,style:{marginBottom:"10px"}}),a.jsx("p",{style:{fontSize:"12px"},children:"Seleccione categora"})]})]}),a.jsxs("div",{className:"glass-card",style:{padding:0,overflow:"hidden"},children:[a.jsx("div",{style:{borderBottom:"1px solid #f1f1f1",padding:"0 24px"},children:a.jsx("div",{style:{display:"flex",gap:"32px"},children:["Atributos","Permisos","Logs"].map(F=>a.jsx("button",{onClick:()=>x(F.toLowerCase()),style:{padding:"20px 0",background:"none",border:"none",borderBottom:g===F.toLowerCase()?"2px solid var(--primary)":"2px solid transparent",color:g===F.toLowerCase()?"var(--primary)":"var(--text-muted)",fontWeight:600,fontSize:"14px",cursor:"pointer",transition:"all 0.2s"},children:F},F))})}),a.jsx("div",{style:{padding:"32px"},children:o?a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:u?"Atributos de Subcategora":"Atributos de Categora"}),a.jsx("p",{style:{fontSize:"12px",color:"var(--text-muted)"},children:u?"Campos activos para esta subcategora (incluye heredados).":"Defina aqu los campos comunes a todas las subcategoras de esta categora."})]}),a.jsxs("span",{style:{backgroundColor:"#f4f4f4",padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:600},children:[f.length," definidos"]})]}),g==="atributos"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:a.jsx(fO,{sensors:kt,collisionDetection:fP,onDragEnd:ze,modifiers:[VO],children:a.jsx(CO,{items:f.map(F=>F.attributeId),strategy:bO,children:f.map(F=>a.jsx(BO,{mapping:F,attr:st(F.attributeId),isInherited:!!(u&&!F.subcategoryId),onToggleMandatory:O,onRemove:Q},F.attributeId))})})}),a.jsxs("div",{onClick:()=>b(!0),style:{marginTop:"24px",padding:"24px",border:"2px dashed #eee",borderRadius:"12px",display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",color:"var(--text-muted)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:F=>F.currentTarget.style.borderColor="var(--primary)",onMouseLeave:F=>F.currentTarget.style.borderColor="#eee",children:[a.jsx(Ot,{size:20}),a.jsx("span",{style:{fontWeight:600},children:u?"Vincular atributo especfico":"Aadir atributo comn a la categora"})]})]}),g==="permisos"&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[a.jsxs("div",{className:"glass-card",style:{padding:"20px",border:"1px solid var(--primary-light)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[a.jsx(As,{size:20,color:"var(--primary)"}),a.jsx("h4",{style:{margin:0},children:"Gobernanza de Datos"})]}),a.jsx("p",{style:{fontSize:"13px",lineHeight:"1.6"},children:"Esta seccin define quin puede modificar los metadatos de clasificacin. Los cambios afectan directamente a la validacin de activos en el inventario."})]}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{role:"Administrador",access:"Total",color:"#1abc9c"},{role:"Catalogador Senior",access:"Edicin Atributos",color:"#3498db"},{role:"Auditor",access:"Solo Lectura",color:"#95a5a6"}].map(F=>a.jsxs("div",{style:{padding:"12px 16px",borderRadius:"12px",border:"1px solid #f1f1f1",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontWeight:600},children:F.role}),a.jsx("span",{style:{fontSize:"11px",fontWeight:700,backgroundColor:`${F.color}15`,color:F.color,padding:"4px 8px",borderRadius:"4px"},children:F.access})]},F.role))})]}),g==="logs"&&a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:C.length>0?C.map(F=>a.jsxs("div",{style:{padding:"16px",borderRadius:"12px",border:"1px solid #f1f1f1",display:"flex",gap:"16px"},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)"},children:a.jsx(Dl,{size:20})}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[a.jsx("span",{style:{fontWeight:700,fontSize:"14px"},children:F.user}),a.jsx("span",{style:{fontSize:"11px",color:"var(--text-muted)"},children:F.timestamp.toLocaleString()})]}),a.jsx("p",{style:{margin:0,fontSize:"13px",color:"var(--text-main)"},children:F.details})]})]},F.id)):a.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#ccc"},children:[a.jsx(_s,{size:32,style:{marginBottom:"12px"}}),a.jsx("p",{children:"No hay registros de cambios para este elemento."})]})})]}):a.jsxs("div",{style:{textAlign:"center",padding:"60px 0",color:"#ccc"},children:[a.jsx(Dl,{size:48,style:{marginBottom:"20px"}}),a.jsx("h3",{children:"Gestin de Atributos"}),a.jsx("p",{children:"Seleccione una categora o subcategora para editar su configuracin dinmica."})]})})]})]}),P&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"500px",backgroundColor:"white"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[a.jsx("h2",{style:{margin:0},children:"Vincular Atributos"}),a.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Cerrar"})]}),a.jsxs("div",{style:{position:"relative",marginBottom:"20px"},children:[a.jsx(Yu,{size:16,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#ccc"}}),a.jsx("input",{type:"text",placeholder:"Buscar atributo global...",style:{width:"100%",paddingLeft:"36px",height:"40px",borderRadius:"8px",border:"1px solid #eee"},value:D,onChange:F=>T(F.target.value)})]}),a.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"8px"},children:i.filter(F=>!f.some(re=>re.attributeId===F.id)).filter(F=>F.name.toLowerCase().includes(D.toLowerCase())).map(F=>a.jsxs("div",{onClick:()=>ue(F.id),style:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #f1f1f1",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:re=>re.currentTarget.style.backgroundColor="#f9f9f9",onMouseLeave:re=>re.currentTarget.style.backgroundColor="transparent",children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontWeight:600},children:F.name}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:re=>Ze(re,F),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer",opacity:.6},title:"Editar definicin global",children:a.jsx(yv,{size:14})}),a.jsx("button",{onClick:re=>xe(re,F.id),style:{background:"none",border:"none",color:"var(--text-muted)",cursor:"pointer",opacity:.6},title:"Eliminar del catlogo maestro",children:a.jsx(Zn,{size:14})}),a.jsx("span",{style:{fontSize:"10px",fontWeight:800,color:"#999"},children:F.dataType})]})]}),a.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"var(--text-muted)"},children:F.description})]},F.id))})]})}),v&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1100,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"400px",backgroundColor:"white"},children:[a.jsx("h2",{style:{marginBottom:"24px"},children:"Nueva Categora"}),a.jsxs("form",{onSubmit:H,children:[a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Nombre"}),a.jsx("input",{required:!0,className:"form-control",value:fe.name,onChange:F=>Qe({...fe,name:F.target.value}),placeholder:"Ej: Anillos..."})]}),a.jsxs("div",{style:{marginBottom:"32px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Descripcin"}),a.jsx("textarea",{className:"form-control",value:fe.description,onChange:F=>Qe({...fe,description:F.target.value}),placeholder:"Breve descripcin...",rows:3})]}),a.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>S(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Crear"})]})]})]})}),A&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1100,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"400px",backgroundColor:"white"},children:[a.jsx("h2",{style:{marginBottom:"12px"},children:"Nueva Subcategora"}),a.jsxs("p",{style:{fontSize:"13px",color:"var(--text-muted)",marginBottom:"24px"},children:["Dentro de: ",a.jsx("span",{style:{fontWeight:700,color:"var(--primary)"},children:(we=t.find(F=>F.id===o))==null?void 0:we.name})]}),a.jsxs("form",{onSubmit:Ie,children:[a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Nombre"}),a.jsx("input",{required:!0,className:"form-control",value:He.name,onChange:F=>Ne({...He,name:F.target.value}),placeholder:"Ej: Solitario..."})]}),a.jsxs("div",{style:{marginBottom:"32px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Descripcin"}),a.jsx("textarea",{className:"form-control",value:He.description,onChange:F=>Ne({...He,description:F.target.value}),placeholder:"Breve descripcin...",rows:3})]}),a.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>k(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Crear"})]})]})]})}),N&&B&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"400px",backgroundColor:"white"},children:[a.jsx("h2",{style:{marginBottom:"24px"},children:"Editar Atributo Global"}),a.jsxs("form",{onSubmit:$e,children:[a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Nombre"}),a.jsx("input",{required:!0,className:"form-control",value:B.name,onChange:F=>_({...B,name:F.target.value})})]}),a.jsxs("div",{style:{marginBottom:"20px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:600},children:"Descripcin"}),a.jsx("textarea",{className:"form-control",value:B.description,onChange:F=>_({...B,description:F.target.value}),rows:2})]}),a.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"btn",onClick:()=>M(!1),children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})]})]})]})}),y&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"white",zIndex:2e3,overflowY:"auto",padding:"40px"},children:a.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[a.jsx("h2",{style:{margin:0},children:"Gestin Maestra de Dominios y Atributos"}),a.jsx("button",{className:"btn",onClick:()=>{I(!1),K()},children:"Volver a Torre de Control"})]}),a.jsx(SI,{})]})})]})},BO=({mapping:t,attr:e,isInherited:n,onToggleMandatory:r,onRemove:i})=>{const{attributes:s,listeners:o,setNodeRef:c,transform:u,transition:d,isDragging:f}=NO({id:t.attributeId,disabled:n}),p={transform:Kl.Transform.toString(u),transition:d,zIndex:f?10:1,position:"relative",padding:"16px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",border:n?"1px dashed #d4af37":"1px solid #f1f1f1",borderLeft:t.isMandatory?"4px solid var(--primary)":"4px solid #eee",backgroundColor:n?"rgba(212, 175, 55, 0.05)":f?"#f8f9fa":"#fff",opacity:n?.9:1,borderRadius:"12px",boxShadow:f?"0 10px 25px rgba(0,0,0,0.1)":"none"};return e?a.jsxs("div",{ref:c,style:p,children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[a.jsx("div",{...s,...o,style:{cursor:n?"default":"grab",color:n?"#eee":"#ccc",display:"flex",alignItems:"center"},children:a.jsx(QC,{size:20})}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[a.jsx("span",{style:{fontWeight:700},children:e.name}),a.jsx("span",{style:{fontSize:"10px",color:"var(--primary)",fontWeight:800,backgroundColor:"rgba(52, 152, 219, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:e.dataType}),n&&a.jsx("span",{style:{fontSize:"10px",color:"#d4af37",fontWeight:800,backgroundColor:"rgba(212, 175, 55, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:"HEREDADO"})]}),a.jsx("p",{style:{margin:0,fontSize:"12px",color:"var(--text-muted)"},children:e.description||"Sin descripcin."})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"32px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("span",{style:{fontSize:"11px",fontWeight:700,color:t.isMandatory?"var(--primary)":"#ccc"},children:"OBLIGATORIO"}),a.jsx("div",{onClick:()=>!n&&r(t.attributeId),style:{width:"36px",height:"20px",borderRadius:"10px",backgroundColor:t.isMandatory?"var(--primary)":"#ddd",position:"relative",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",opacity:n?.5:1},children:a.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"white",position:"absolute",top:"2px",left:t.isMandatory?"18px":"2px",transition:"all 0.2s"}})})]}),a.jsx("button",{onClick:()=>i(t.attributeId),style:{background:"none",border:"none",color:n?"#ccc":"#bbb",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:g=>g.currentTarget.style.color="var(--error)",onMouseLeave:g=>g.currentTarget.style.color=n?"#ccc":"#bbb",title:n?"Eliminar de la categora padre":"Eliminar de esta subcategora",children:a.jsx(Zn,{size:18})})]})]}):null},FO=()=>{const[t,e]=R.useState([]),[n,r]=R.useState(!0),[i,s]=R.useState(""),[o,c]=R.useState(!1),[u,d]=R.useState(null),[f,p]=R.useState({firstName:"",lastName:"",dni:"",phone:"",email:"",address:"",tags:[]});R.useEffect(()=>{g()},[]);const g=async()=>{r(!0);try{const y=await Ai.getAll();e(y)}catch(y){console.error("Error loading customers:",y)}finally{r(!1)}},x=async y=>{const I=y.target.value;if(s(I),I.trim()==="")g();else{const N=await Ai.search(I);e(N)}},C=async y=>{y.preventDefault();try{u?await Ai.update(u,f):await Ai.create({...f,createdBy:"admin"}),b(),g()}catch(I){console.error("Error saving customer:",I)}},j=y=>{p({firstName:y.firstName,lastName:y.lastName,dni:y.dni||"",phone:y.phone,email:y.email||"",address:y.address||"",tags:y.tags||[]}),d(y.id),c(!0)},P=async y=>{window.confirm("Desea desactivar este cliente?")&&(await Ai.deleteLogic(y),g())},b=()=>{p({firstName:"",lastName:"",dni:"",phone:"",email:"",address:"",tags:[]}),d(null),c(!1)};return a.jsxs("div",{className:"container",style:{paddingBottom:"60px"},children:[a.jsxs("header",{style:{marginBottom:"40px",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[a.jsxs("div",{children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Directorio de Clientes"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Gestin de identidades para ventas y apartados"})]}),!o&&a.jsxs("button",{className:"btn btn-primary",onClick:()=>c(!0),children:[a.jsx(Ot,{size:20})," Nuevo Cliente"]})]}),o?a.jsxs("div",{className:"glass-card",style:{padding:"40px",maxWidth:"800px",margin:"0 auto"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"32px"},children:[a.jsx("button",{className:"btn",onClick:b,style:{padding:"8px"},children:a.jsx(FC,{size:20})}),a.jsx("h2",{style:{margin:0},children:u?"Editar Perfil de Cliente":"Registrar Nuevo Cliente"})]}),a.jsxs("form",{onSubmit:C,style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px"},children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Nombre"}),a.jsx("input",{required:!0,className:"form-control",value:f.firstName,onChange:y=>p({...f,firstName:y.target.value}),placeholder:"Nombre..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Apellidos"}),a.jsx("input",{required:!0,className:"form-control",value:f.lastName,onChange:y=>p({...f,lastName:y.target.value}),placeholder:"Apellidos..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"DNI / Identificacin"}),a.jsx("input",{className:"form-control",value:f.dni,onChange:y=>p({...f,dni:y.target.value}),placeholder:"Ej. 12345678X"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Telfono"}),a.jsx("input",{required:!0,className:"form-control",value:f.phone,onChange:y=>p({...f,phone:y.target.value}),placeholder:"Ej. +34 600 000 000"})]}),a.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Correo Electrnico"}),a.jsx("input",{type:"email",className:"form-control",value:f.email,onChange:y=>p({...f,email:y.target.value}),placeholder:"correo@ejemplo.com"})]}),a.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Direccin"}),a.jsx("textarea",{className:"form-control",rows:3,value:f.address,onChange:y=>p({...f,address:y.target.value}),placeholder:"Direccin completa..."})]}),a.jsxs("div",{style:{gridColumn:"span 2",display:"flex",gap:"12px",marginTop:"12px"},children:[a.jsx("button",{type:"button",className:"btn",onClick:b,style:{flex:1},children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:2},children:u?"Guardar Cambios":"Crear Cliente"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"glass-card",style:{padding:"12px 20px",marginBottom:"32px",display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx(Yu,{size:18,color:"var(--text-muted)"}),a.jsx("input",{type:"text",placeholder:"Buscar por nombre, apellidos, DNI o telfono...",style:{border:"none",background:"transparent",width:"100%",padding:"8px 0",outline:"none",fontSize:"15px"},value:i,onChange:x})]}),n?a.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[a.jsx(Y1,{className:"animate-spin",size:40,color:"var(--primary)"}),a.jsx("p",{style:{marginTop:"16px",color:"var(--text-muted)"},children:"Cargando base de datos..."})]}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"24px"},children:t.length>0?t.map(y=>a.jsxs("div",{className:"glass-card customer-card",style:{padding:"24px",transition:"all 0.3s"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"20px"},children:[a.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"16px",backgroundColor:"var(--primary-light)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--primary)"},children:a.jsx(sp,{size:28})}),a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("button",{onClick:()=>j(y),className:"btn-icon",style:{background:"#f8f9fa",border:"none",padding:"8px",borderRadius:"8px",cursor:"pointer"},children:a.jsx(Pl,{size:16,color:"var(--text-muted)"})}),a.jsx("button",{onClick:()=>P(y.id),className:"btn-icon",style:{background:"#fff5f5",border:"none",padding:"8px",borderRadius:"8px",cursor:"pointer"},children:a.jsx(Zn,{size:16,color:"var(--error)"})})]})]}),a.jsxs("h3",{style:{marginBottom:"4px",fontSize:"1.2rem"},children:[y.firstName," ",y.lastName]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"var(--text-muted)",fontSize:"13px",marginBottom:"20px"},children:[a.jsx(GC,{size:14}),a.jsx("span",{children:y.dni||"Sin DNI"})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",borderTop:"1px solid #f1f1f1",paddingTop:"20px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",fontSize:"14px"},children:[a.jsx(ZC,{size:16,color:"var(--primary)"}),a.jsx("span",{children:y.phone})]}),y.email&&a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",fontSize:"14px"},children:[a.jsx(XC,{size:16,color:"var(--primary)"}),a.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.email})]}),y.address&&a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",fontSize:"14px"},children:[a.jsx(Ts,{size:16,color:"var(--primary)",style:{marginTop:"2px"}}),a.jsx("span",{style:{opacity:.8},children:y.address})]})]}),a.jsx("div",{style:{marginTop:"24px",display:"flex",justifyContent:"flex-end"},children:a.jsxs("button",{className:"btn",style:{background:"none",border:"1px solid var(--primary)",color:"var(--primary)",fontSize:"12px",fontWeight:700,padding:"8px 16px",display:"flex",alignItems:"center",gap:"8px"},children:["VER HISTORIAL ",a.jsx(Ua,{size:14})]})})]},y.id)):a.jsxs("div",{style:{gridColumn:"1/-1",textAlign:"center",padding:"80px 0",color:"var(--text-muted)"},children:[a.jsx(sp,{size:48,style:{marginBottom:"16px",opacity:.2}}),a.jsx("h3",{children:"No se encontraron clientes"}),a.jsx("p",{children:"Intenta con otro trmino de bsqueda o registra un nuevo cliente."})]})})]})]})},UO=()=>{const[t,e]=R.useState([]),[n,r]=R.useState({}),[i,s]=R.useState({}),[o,c]=R.useState(!0),[u,d]=R.useState("ALL"),[f,p]=R.useState(null),[g,x]=R.useState("");R.useEffect(()=>{C()},[]);const C=async()=>{c(!0);try{await bu.checkExpirations();const I=await bu.getAll();e(I.sort((A,k)=>k.createdAt.getTime()-A.createdAt.getTime()));const N=Array.from(new Set(I.map(A=>A.customerId))),M=Array.from(new Set(I.map(A=>A.itemId))),[B,_]=await Promise.all([Promise.all(N.map(A=>Ai.getById(A))),Promise.all(M.map(A=>fr.getById(A)))]),v={};B.forEach(A=>{A&&(v[A.id]=A)});const S={};_.forEach(A=>{A&&(S[A.id]=A)}),r(v),s(S)}catch(I){console.error("Error loading reservations:",I)}finally{c(!1)}},j=async(I,N)=>{try{await bu.resolveReservation(I,{status:N,note:g,user:"admin"}),p(null),x(""),C()}catch(M){console.error("Error resolving reservation:",M)}},P=I=>{switch(I){case"ACTIVE":return"#3498db";case"EXPIRED":return"var(--error)";case"RESOLVED":return"#27ae60";case"CANCELLED":return"#95a5a6";default:return"#f1f1f1"}},b=I=>{switch(I){case"ACTIVE":return"ACTIVA";case"EXPIRED":return"CADUCADA";case"RESOLVED":return"RESUELTA (VENTA)";case"CANCELLED":return"CANCELADA";default:return I}},y=t.filter(I=>u==="ALL"||I.status===u);return a.jsxs("div",{className:"container",style:{paddingBottom:"60px"},children:[a.jsxs("header",{style:{marginBottom:"40px",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[a.jsxs("div",{children:[a.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"8px"},children:"Bandeja de Apartados"}),a.jsx("p",{style:{color:"var(--text-muted)"},children:"Gestin de piezas reservadas y control de caducidades"})]}),a.jsx("div",{className:"glass-card",style:{display:"flex",padding:"4px",borderRadius:"12px"},children:["ALL","ACTIVE","EXPIRED","RESOLVED"].map(I=>a.jsx("button",{onClick:()=>d(I),style:{padding:"8px 16px",border:"none",borderRadius:"8px",fontSize:"12px",fontWeight:700,cursor:"pointer",backgroundColor:u===I?"var(--primary)":"transparent",color:u===I?"white":"var(--text-muted)",transition:"all 0.2s"},children:I==="ALL"?"TODOS":b(I)},I))})]}),o?a.jsxs("div",{style:{textAlign:"center",padding:"100px 0"},children:[a.jsx(Y1,{className:"animate-spin",size:40,color:"var(--primary)"}),a.jsx("p",{style:{marginTop:"16px",color:"var(--text-muted)"},children:"Cargando bandeja..."})]}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:y.length>0?y.map(I=>{var _;const N=n[I.customerId],M=i[I.itemId],B=I.status==="EXPIRED"||I.status==="ACTIVE"&&I.expiryDate<new Date;return a.jsxs("div",{className:"glass-card",style:{padding:"24px",borderLeft:`6px solid ${P(I.status)}`,display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",alignItems:"center",gap:"32px"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[a.jsx("span",{style:{fontSize:"10px",fontWeight:800,padding:"4px 8px",borderRadius:"4px",backgroundColor:`${P(I.status)}15`,color:P(I.status)},children:b(I.status)}),B&&I.status==="ACTIVE"&&a.jsxs("span",{style:{fontSize:"10px",fontWeight:800,color:"var(--error)",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(As,{size:12})," PENDIENTE DE CIERRE"]})]}),a.jsxs("h3",{style:{margin:0,fontSize:"1.1rem"},children:[N==null?void 0:N.firstName," ",N==null?void 0:N.lastName]}),a.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"13px",color:"var(--text-muted)"},children:N==null?void 0:N.phone})]}),a.jsx("div",{children:a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[a.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(Nl,{size:20,color:"var(--primary)"})}),a.jsxs("div",{children:[a.jsx("p",{style:{margin:0,fontWeight:700,fontSize:"14px"},children:(M==null?void 0:M.itemCode)||"Pieza desconocida"}),a.jsx("p",{style:{margin:0,fontSize:"12px",color:"var(--text-muted)"},children:M==null?void 0:M.name})]})]})}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",color:"var(--text-muted)",marginBottom:"4px"},children:[a.jsx(jm,{size:14}),a.jsxs("span",{children:["Inicio: ",I.startDate.toLocaleDateString()]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",fontWeight:600,color:B?"var(--error)":"var(--text-main)"},children:[a.jsx(Dm,{size:14}),a.jsxs("span",{children:["Vence: ",I.expiryDate.toLocaleDateString()]})]})]}),a.jsx("div",{children:I.status==="ACTIVE"||I.status==="EXPIRED"?a.jsx("button",{className:"btn btn-primary",onClick:()=>p(I.id),style:{padding:"10px 20px",fontSize:"13px"},children:"Gestionar"}):a.jsxs("div",{style:{textAlign:"right",fontSize:"12px",color:"var(--text-muted)"},children:[a.jsxs("p",{style:{margin:0},children:["Cerrado por: ",I.resolvedBy]}),a.jsx("p",{style:{margin:0},children:(_=I.resolvedAt)==null?void 0:_.toLocaleDateString()})]})})]},I.id)}):a.jsxs("div",{style:{textAlign:"center",padding:"80px 0",color:"var(--text-muted)"},children:[a.jsx(Q1,{size:48,style:{marginBottom:"16px",opacity:.2}}),a.jsx("h3",{children:"No hay apartados en esta seccin"})]})}),f&&a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(4px)"},children:a.jsxs("div",{className:"glass-card",style:{padding:"32px",width:"500px",backgroundColor:"white"},children:[a.jsx("h2",{style:{marginBottom:"24px"},children:"Resolver Apartado"}),a.jsxs("div",{style:{marginBottom:"24px"},children:[a.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:600,fontSize:"13px"},children:"Nota de resolucin"}),a.jsx("textarea",{className:"form-control",rows:3,value:g,onChange:I=>x(I.target.value),placeholder:"Indique el motivo (ej. venta finalizada, cliente desiste, caducidad no reclamada)..."})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[a.jsxs("button",{className:"btn",style:{backgroundColor:"#fff5f5",color:"var(--error)",border:"1px solid var(--error)"},onClick:()=>j(f,"CANCELLED"),children:[a.jsx(aA,{size:18})," Liberar Pieza"]}),a.jsxs("button",{className:"btn",style:{backgroundColor:"#f0fff4",color:"#27ae60",border:"1px solid #27ae60"},onClick:()=>j(f,"RESOLVED"),children:[a.jsx($C,{size:18})," Consolidar Venta"]})]}),a.jsx("button",{className:"btn",style:{width:"100%",marginTop:"16px"},onClick:()=>p(null),children:"Volver"})]})})]})};function $O(){const[t,e]=R.useState("inventory");return a.jsxs("div",{className:"app-shell",style:{minHeight:"100vh",backgroundColor:"#fdfdfd"},children:[a.jsx("nav",{style:{padding:"20px 0",borderBottom:"1px solid rgba(0,0,0,0.05)",background:"white",position:"sticky",top:0,zIndex:10},children:a.jsxs("div",{className:"container",style:{padding:"0 20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:{fontFamily:"Outfit",fontSize:"1.2rem",fontWeight:700,color:"var(--primary)",letterSpacing:"1px"},children:["LONDOR ",a.jsx("span",{style:{color:"var(--accent)"},children:"LES"})]}),a.jsxs("div",{style:{display:"flex",gap:"20px"},children:[a.jsx("button",{onClick:()=>e("inventory"),className:`nav-link ${t==="inventory"?"active":""}`,style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="inventory"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="inventory"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Inventario"}),a.jsx("button",{onClick:()=>e("customers"),style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="customers"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="customers"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Clientes"}),a.jsx("button",{onClick:()=>e("reservations"),style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="reservations"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="reservations"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Apartados"}),a.jsx("button",{onClick:()=>e("classification_config"),style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="classification_config"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="classification_config"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Config. Clasificacin"}),a.jsx("button",{onClick:()=>e("attributes"),style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="attributes"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="attributes"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Catlogo de Atributos"}),a.jsx("button",{onClick:()=>e("logistics"),style:{background:"none",border:"none",fontFamily:"Outfit",fontWeight:600,fontSize:"13px",color:t==="logistics"?"var(--accent)":"var(--text-muted)",cursor:"pointer",borderBottom:t==="logistics"?"2px solid var(--accent)":"2px solid transparent",padding:"4px 0",transition:"all 0.2s"},children:"Logstica"})]})]})}),a.jsxs("main",{style:{paddingTop:"40px"},children:[t==="inventory"&&a.jsx(YN,{}),t==="customers"&&a.jsx(FO,{}),t==="reservations"&&a.jsx(UO,{}),t==="classification_config"&&a.jsx(zO,{}),t==="attributes"&&a.jsx(SI,{}),t==="logistics"&&a.jsx(gN,{})]})]})}uf.createRoot(document.getElementById("root")).render(a.jsx(Kt.StrictMode,{children:a.jsx($O,{})}));
